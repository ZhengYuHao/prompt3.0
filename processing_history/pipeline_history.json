{
  "83592cd8": {
    "pipeline_id": "83592cd8",
    "timestamp": "2026-01-27 15:07:35",
    "raw_input": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
    "prompt10_id": "31ee2622",
    "prompt10_original": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
    "prompt10_processed": "请开发一个基于API封装的检索增强生成(RAG)应用，底层采用大型语言模型(LLM)，处理链需设计为较复杂结构，支持不少于三种检索模式。团队成员共五人，其中两名负责Java开发，三名负责Python开发。项目周期为八周，预算约为五十万元。技术栈包括LangChain、Milvus和FastAPI。系统需支持多轮对话，能够保存约二十轮历史上下文。部署环境为Kubernetes集群，采用微服务架构，服务数量约为十个。需集成监控和日志系统，使用Prometheus和ELK日志系统(Elasticsearch、Logstash、Kibana)。应用需支持中英文双语，响应时间控制在两秒以内。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
        "output_text": "，帮我开发一个检索增强生成(RAG)的基于API封装的应用应用。\n要用大型语言模型(LLM)做底座，处理链(Chain)的话复杂一点，大约要支持3种以上的检索模式。\n团队就5个人，其中2个是开发Java的，还有3个写Python的。\n项目周期，大概8周，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是Kubernetes集群，要开发成微服务架构，服务数量大约10来个。\n最后记得加上监控和日志，用Prometheus和ELK日志系统(Elasticsearch+Logstash+Kibana)那套。\n另外，要支持中英文双语，响应时间控制在2秒以内。",
        "changes": {
          "那个": "",
          "搞": "开发",
          "RAG": "检索增强生成(RAG)",
          "套壳": "基于API封装的应用",
          "吧": "",
          "大模型": "大型语言模型(LLM)",
          "chain": "处理链(Chain)",
          "差不多": "大约",
          "嘛": "",
          "K8s": "Kubernetes",
          "ELK": "ELK日志系统(Elasticsearch+Logstash+Kibana)",
          "对了": "另外"
        },
        "duration_ms": 0,
        "notes": [
          "替换 16 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
        "output_text": "，帮我开发一个检索增强生成(RAG)的基于API封装的应用应用。\n要用大型语言模型(LLM)做底座，处理链(Chain)的话复杂一点，大约要支持3种以上的检索模式。\n团队就5个人，其中2个是开发Java的，还有3个写Python的。\n项目周期，大概8周，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是Kubernetes集群，要开发成微服务架构，服务数量大约10来个。\n最后记得加上监控和日志，用Prometheus和ELK日志系统(Elasticsearch+Logstash+Kibana)那套。\n另外，要支持中英文双语，响应时间控制在2秒以内。",
        "changes": {
          "那个": "",
          "搞": "开发",
          "RAG": "检索增强生成(RAG)",
          "套壳": "基于API封装的应用",
          "吧": "",
          "大模型": "大型语言模型(LLM)",
          "chain": "处理链(Chain)",
          "差不多": "大约",
          "嘛": "",
          "K8s": "Kubernetes",
          "ELK": "ELK日志系统(Elasticsearch+Logstash+Kibana)",
          "对了": "另外"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "，帮我开发一个检索增强生成(RAG)的基于API封装的应用应用。\n要用大型语言模型(LLM)做底座，处理链(Chain)的话复杂一点，大约要支持3种以上的检索模式。\n团队就5个人，其中2个是开发Java的，还有3个写Python的。\n项目周期，大概8周，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是Kubernetes集群，要开发成微服务架构，服务数量大约10来个。\n最后记得加上监控和日志，用Prometheus和ELK日志系统(Elasticsearch+Logstash+Kibana)那套。\n另外，要支持中英文双语，响应时间控制在2秒以内。",
        "output_text": "请开发一个基于API封装的检索增强生成(RAG)应用，底层采用大型语言模型(LLM)，处理链需设计为较复杂结构，支持不少于三种检索模式。团队成员共五人，其中两名负责Java开发，三名负责Python开发。项目周期为八周，预算约为五十万元。技术栈包括LangChain、Milvus和FastAPI。系统需支持多轮对话，能够保存约二十轮历史上下文。部署环境为Kubernetes集群，采用微服务架构，服务数量约为十个。需集成监控和日志系统，使用Prometheus和ELK日志系统(Elasticsearch、Logstash、Kibana)。应用需支持中英文双语，响应时间控制在两秒以内。",
        "changes": {
          "标准化": "335字 → 294字"
        },
        "duration_ms": 5799,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "那个": "",
      "搞": "开发",
      "RAG": "检索增强生成(RAG)",
      "套壳": "基于API封装的应用",
      "吧": "",
      "大模型": "大型语言模型(LLM)",
      "chain": "处理链(Chain)",
      "差不多": "大约",
      "嘛": "",
      "K8s": "Kubernetes",
      "ELK": "ELK日志系统(Elasticsearch+Logstash+Kibana)",
      "对了": "另外"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 5800,
    "prompt20_id": "01749679",
    "prompt20_template": "请开发一个基于API封装的检索增强生成(RAG)应用，底层采用大型语言模型(LLM)，处理链需设计为较复杂结构，{{retrieval_modes}}。{{team_members}}，其中{{java_developers}}，{{python_developers}}。{{project_duration_weeks}}，{{budget}}。{{tech_stack}}。{{multi_turn_dialogue}}，{{history_context_rounds}}。{{deployment_environment}}，{{architecture}}，{{service_count}}。需{{monitoring_system}}。{{bilingual_support}}，{{response_time_limit}}。",
    "prompt20_variables": [
      {
        "variable": "retrieval_modes",
        "original_text": "支持不少于三种检索模式",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "team_members",
        "original_text": "团队成员共五人",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "java_developers",
        "original_text": "两名负责Java开发",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "python_developers",
        "original_text": "三名负责Python开发",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "project_duration_weeks",
        "original_text": "项目周期为八周",
        "value": 8,
        "type": "Integer"
      },
      {
        "variable": "budget",
        "original_text": "预算约为五十万元",
        "value": 500000,
        "type": "Integer"
      },
      {
        "variable": "tech_stack",
        "original_text": "技术栈包括LangChain、Milvus和FastAPI",
        "value": [
          "LangChain",
          "Milvus",
          "FastAPI"
        ],
        "type": "List"
      },
      {
        "variable": "multi_turn_dialogue",
        "original_text": "系统需支持多轮对话",
        "value": true,
        "type": "Boolean"
      },
      {
        "variable": "history_context_rounds",
        "original_text": "能够保存约二十轮历史上下文",
        "value": 20,
        "type": "Integer"
      },
      {
        "variable": "deployment_environment",
        "original_text": "部署环境为Kubernetes集群",
        "value": "Kubernetes集群",
        "type": "String"
      },
      {
        "variable": "architecture",
        "original_text": "采用微服务架构",
        "value": "微服务架构",
        "type": "String"
      },
      {
        "variable": "service_count",
        "original_text": "服务数量约为十个",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "monitoring_system",
        "original_text": "集成监控和日志系统，使用Prometheus和ELK日志系统(Elasticsearch、Logstash、Kibana)",
        "value": [
          "Prometheus",
          "Elasticsearch",
          "Logstash",
          "Kibana"
        ],
        "type": "List"
      },
      {
        "variable": "bilingual_support",
        "original_text": "应用需支持中英文双语",
        "value": true,
        "type": "Boolean"
      },
      {
        "variable": "response_time_limit",
        "original_text": "响应时间控制在两秒以内",
        "value": 2,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 15,
    "prompt20_type_stats": {
      "Integer": 9,
      "List": 2,
      "Boolean": 2,
      "String": 2
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "6e3da1d6",
    "prompt30_dsl_code": "DEFINE {{retrieval_modes}}: Integer = 3\nDEFINE {{team_members}}: Integer = 5\nDEFINE {{java_developers}}: Integer = 2\nDEFINE {{python_developers}}: Integer = 3\nDEFINE {{project_duration_weeks}}: Integer = 8\nDEFINE {{budget}}: Integer = 500000\nDEFINE {{tech_stack}}: List = ['LangChain', 'Milvus', 'FastAPI']\nDEFINE {{multi_turn_dialogue}}: Boolean = True\nDEFINE {{history_context_rounds}}: Integer = 20\nDEFINE {{deployment_environment}}: String = Kubernetes集群\nDEFINE {{architecture}}: String = 微服务架构\nDEFINE {{service_count}}: Integer = 10\nDEFINE {{monitoring_system}}: List = ['Prometheus', 'Elasticsearch', 'Logstash', 'Kibana']\nDEFINE {{bilingual_support}}: Boolean = True\nDEFINE {{response_time_limit}}: Integer = 2\nDEFINE {{rag_app}}: Any\nDEFINE {{team_structure}}: Any\nDEFINE {{project_plan}}: Any\nDEFINE {{tech_stack_config}}: Any\nDEFINE {{dialogue_system}}: Any\nDEFINE {{deployment_plan}}: Any\nDEFINE {{monitoring_setup}}: Any\nDEFINE {{language_support}}: Any\nDEFINE {{performance_constraints}}: Any\n{{rag_app}} = CALL design_rag_application(\n    retrieval_modes={{retrieval_modes}},\n    llm_backend=True,\n    complex_chain=True\n)\n{{team_structure}} = CALL define_team_structure(\n    total_members={{team_members}},\n    java={{java_developers}},\n    python={{python_developers}}\n)\n{{project_plan}} = CALL create_project_plan(\n    duration_weeks={{project_duration_weeks}},\n    budget={{budget}}\n)\n{{tech_stack_config}} = CALL configure_tech_stack(\n    stack={{tech_stack}}\n)\n{{dialogue_system}} = CALL setup_dialogue_system(\n    multi_turn={{multi_turn_dialogue}},\n    history_rounds={{history_context_rounds}}\n)\n{{deployment_plan}} = CALL plan_deployment(\n    environment={{deployment_environment}},\n    architecture={{architecture}},\n    service_count={{service_count}}\n)\n{{monitoring_setup}} = CALL integrate_monitoring_and_logging(\n    systems={{monitoring_system}}\n)\n{{language_support}} = CALL enable_bilingual_support(\n    bilingual={{bilingual_support}}\n)\n{{performance_constraints}} = CALL set_performance_constraints(\n    response_time={{response_time_limit}}\n)\nRETURN {{rag_app}}",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [],
      "defined_variables": {
        "retrieval_modes": {
          "name": "retrieval_modes",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 1
        },
        "team_members": {
          "name": "team_members",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 2
        },
        "java_developers": {
          "name": "java_developers",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 3
        },
        "python_developers": {
          "name": "python_developers",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 4
        },
        "project_duration_weeks": {
          "name": "project_duration_weeks",
          "var_type": "Integer",
          "initial_value": "8",
          "line_number": 5
        },
        "budget": {
          "name": "budget",
          "var_type": "Integer",
          "initial_value": "500000",
          "line_number": 6
        },
        "tech_stack": {
          "name": "tech_stack",
          "var_type": "List",
          "initial_value": "['LangChain', 'Milvus', 'FastAPI']",
          "line_number": 7
        },
        "multi_turn_dialogue": {
          "name": "multi_turn_dialogue",
          "var_type": "Boolean",
          "initial_value": "True",
          "line_number": 8
        },
        "history_context_rounds": {
          "name": "history_context_rounds",
          "var_type": "Integer",
          "initial_value": "20",
          "line_number": 9
        },
        "deployment_environment": {
          "name": "deployment_environment",
          "var_type": "String",
          "initial_value": "Kubernetes集群",
          "line_number": 10
        },
        "architecture": {
          "name": "architecture",
          "var_type": "String",
          "initial_value": "微服务架构",
          "line_number": 11
        },
        "service_count": {
          "name": "service_count",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "monitoring_system": {
          "name": "monitoring_system",
          "var_type": "List",
          "initial_value": "['Prometheus', 'Elasticsearch', 'Logstash', 'Kibana']",
          "line_number": 13
        },
        "bilingual_support": {
          "name": "bilingual_support",
          "var_type": "Boolean",
          "initial_value": "True",
          "line_number": 14
        },
        "response_time_limit": {
          "name": "response_time_limit",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "rag_app": {
          "name": "rag_app",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 16
        },
        "team_structure": {
          "name": "team_structure",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 17
        },
        "project_plan": {
          "name": "project_plan",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 18
        },
        "tech_stack_config": {
          "name": "tech_stack_config",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 19
        },
        "dialogue_system": {
          "name": "dialogue_system",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 20
        },
        "deployment_plan": {
          "name": "deployment_plan",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 21
        },
        "monitoring_setup": {
          "name": "monitoring_setup",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 22
        },
        "language_support": {
          "name": "language_support",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 23
        },
        "performance_constraints": {
          "name": "performance_constraints",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 24
        }
      },
      "function_calls": [],
      "control_blocks": [],
      "max_nesting_depth": 0
    },
    "prompt30_time_ms": 8517,
    "prompt40_id": "31b9a429",
    "prompt40_modules": [
      {
        "name": "step_1_design_rag_application",
        "inputs": [
          "retrieval_modes"
        ],
        "outputs": [
          "rag_app"
        ],
        "is_async": true
      },
      {
        "name": "step_2_define_team_structure",
        "inputs": [
          "java_developers",
          "python_developers",
          "team_members"
        ],
        "outputs": [
          "team_structure"
        ],
        "is_async": true
      },
      {
        "name": "step_3_create_project_plan",
        "inputs": [
          "budget",
          "project_duration_weeks"
        ],
        "outputs": [
          "project_plan"
        ],
        "is_async": true
      },
      {
        "name": "step_4_configure_tech_stack",
        "inputs": [
          "tech_stack"
        ],
        "outputs": [
          "tech_stack_config"
        ],
        "is_async": true
      },
      {
        "name": "step_5_setup_dialogue_system",
        "inputs": [
          "history_context_rounds",
          "multi_turn_dialogue"
        ],
        "outputs": [
          "dialogue_system"
        ],
        "is_async": true
      },
      {
        "name": "step_6_plan_deployment",
        "inputs": [
          "architecture",
          "deployment_environment",
          "service_count"
        ],
        "outputs": [
          "deployment_plan"
        ],
        "is_async": true
      },
      {
        "name": "step_7_integrate_monitoring_and_logging",
        "inputs": [
          "monitoring_system"
        ],
        "outputs": [
          "monitoring_setup"
        ],
        "is_async": true
      },
      {
        "name": "step_8_enable_bilingual_support",
        "inputs": [
          "bilingual_support"
        ],
        "outputs": [
          "language_support"
        ],
        "is_async": true
      },
      {
        "name": "step_9_set_performance_constraints",
        "inputs": [
          "response_time_limit"
        ],
        "outputs": [
          "performance_constraints"
        ],
        "is_async": true
      }
    ],
    "prompt40_module_count": 9,
    "prompt40_main_code": "async def main_workflow(input_params: dict):\n    \"\"\"\n    主工作流 - 自动生成\n    \n    Args:\n        input_params: 包含 ['architecture', 'bilingual_support', 'budget', 'deployment_environment', 'history_context_rounds', 'java_developers', 'monitoring_system', 'multi_turn_dialogue', 'project_duration_weeks', 'python_developers', 'response_time_limit', 'retrieval_modes', 'service_count', 'team_members', 'tech_stack'] 的字典\n    \n    Returns:\n        执行结果上下文\n    \"\"\"\n    # 初始化上下文\n    ctx = input_params.copy()\n\n    # Module 1: step_1_design_rag_application\n    ctx[\"rag_app\"] = await step_1_design_rag_application(ctx.get(\"retrieval_modes\"))\n\n    # Module 2: step_2_define_team_structure\n    ctx[\"team_structure\"] = await step_2_define_team_structure(ctx.get(\"java_developers\"), ctx.get(\"python_developers\"), ctx.get(\"team_members\"))\n\n    # Module 3: step_3_create_project_plan\n    ctx[\"project_plan\"] = await step_3_create_project_plan(ctx.get(\"budget\"), ctx.get(\"project_duration_weeks\"))\n\n    # Module 4: step_4_configure_tech_stack\n    ctx[\"tech_stack_config\"] = await step_4_configure_tech_stack(ctx.get(\"tech_stack\"))\n\n    # Module 5: step_5_setup_dialogue_system\n    ctx[\"dialogue_system\"] = await step_5_setup_dialogue_system(ctx.get(\"history_context_rounds\"), ctx.get(\"multi_turn_dialogue\"))\n\n    # Module 6: step_6_plan_deployment\n    ctx[\"deployment_plan\"] = await step_6_plan_deployment(ctx.get(\"architecture\"), ctx.get(\"deployment_environment\"), ctx.get(\"service_count\"))\n\n    # Module 7: step_7_integrate_monitoring_and_logging\n    ctx[\"monitoring_setup\"] = await step_7_integrate_monitoring_and_logging(ctx.get(\"monitoring_system\"))\n\n    # Module 8: step_8_enable_bilingual_support\n    ctx[\"language_support\"] = await step_8_enable_bilingual_support(ctx.get(\"bilingual_support\"))\n\n    # Module 9: step_9_set_performance_constraints\n    ctx[\"performance_constraints\"] = await step_9_set_performance_constraints(ctx.get(\"response_time_limit\"))\n\n    return ctx",
    "prompt40_time_ms": 2,
    "overall_status": "success",
    "total_time_ms": 14319,
    "error_message": null
  },
  "ff507874": {
    "pipeline_id": "ff507874",
    "timestamp": "2026-01-27 20:10:16",
    "raw_input": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
    "prompt10_id": "9b586885",
    "prompt10_original": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
    "prompt10_processed": "请开发一个基于API封装的检索增强生成(RAG)应用，底层采用大型语言模型(LLM)，处理链需支持三种以上的检索模式。团队成员包括两名Java开发和三名Python开发，项目周期约为八周，预算为五十万元。技术栈选用LangChain、Milvus和FastAPI。系统需支持多轮对话，能够保存约二十轮历史上下文。部署环境为Kubernetes集群，采用微服务架构，服务数量约为十个。需集成Prometheus监控和ELK日志系统(Elasticsearch、Logstash、Kibana)。应用需支持中英文双语，响应时间控制在两秒以内。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
        "output_text": "，帮我开发一个检索增强生成(RAG)的基于API封装的应用应用。\n要用大型语言模型(LLM)做底座，处理链(Chain)的话复杂一点，大约要支持3种以上的检索模式。\n团队就5个人，其中2个是开发Java的，还有3个写Python的。\n项目周期，大概8周，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是Kubernetes集群，要开发成微服务架构，服务数量大约10来个。\n最后记得加上监控和日志，用Prometheus和ELK日志系统(Elasticsearch+Logstash+Kibana)那套。\n另外，要支持中英文双语，响应时间控制在2秒以内。",
        "changes": {
          "那个": "",
          "搞": "开发",
          "RAG": "检索增强生成(RAG)",
          "套壳": "基于API封装的应用",
          "吧": "",
          "大模型": "大型语言模型(LLM)",
          "chain": "处理链(Chain)",
          "差不多": "大约",
          "嘛": "",
          "K8s": "Kubernetes",
          "ELK": "ELK日志系统(Elasticsearch+Logstash+Kibana)",
          "对了": "另外"
        },
        "duration_ms": 0,
        "notes": [
          "替换 16 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
        "output_text": "，帮我开发一个检索增强生成(RAG)的基于API封装的应用应用。\n要用大型语言模型(LLM)做底座，处理链(Chain)的话复杂一点，大约要支持3种以上的检索模式。\n团队就5个人，其中2个是开发Java的，还有3个写Python的。\n项目周期，大概8周，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是Kubernetes集群，要开发成微服务架构，服务数量大约10来个。\n最后记得加上监控和日志，用Prometheus和ELK日志系统(Elasticsearch+Logstash+Kibana)那套。\n另外，要支持中英文双语，响应时间控制在2秒以内。",
        "changes": {
          "那个": "",
          "搞": "开发",
          "RAG": "检索增强生成(RAG)",
          "套壳": "基于API封装的应用",
          "吧": "",
          "大模型": "大型语言模型(LLM)",
          "chain": "处理链(Chain)",
          "差不多": "大约",
          "嘛": "",
          "K8s": "Kubernetes",
          "ELK": "ELK日志系统(Elasticsearch+Logstash+Kibana)",
          "对了": "另外"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "，帮我开发一个检索增强生成(RAG)的基于API封装的应用应用。\n要用大型语言模型(LLM)做底座，处理链(Chain)的话复杂一点，大约要支持3种以上的检索模式。\n团队就5个人，其中2个是开发Java的，还有3个写Python的。\n项目周期，大概8周，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是Kubernetes集群，要开发成微服务架构，服务数量大约10来个。\n最后记得加上监控和日志，用Prometheus和ELK日志系统(Elasticsearch+Logstash+Kibana)那套。\n另外，要支持中英文双语，响应时间控制在2秒以内。",
        "output_text": "请开发一个基于API封装的检索增强生成(RAG)应用，底层采用大型语言模型(LLM)，处理链需支持三种以上的检索模式。团队成员包括两名Java开发和三名Python开发，项目周期约为八周，预算为五十万元。技术栈选用LangChain、Milvus和FastAPI。系统需支持多轮对话，能够保存约二十轮历史上下文。部署环境为Kubernetes集群，采用微服务架构，服务数量约为十个。需集成Prometheus监控和ELK日志系统(Elasticsearch、Logstash、Kibana)。应用需支持中英文双语，响应时间控制在两秒以内。",
        "changes": {
          "标准化": "335字 → 269字"
        },
        "duration_ms": 5982,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "那个": "",
      "搞": "开发",
      "RAG": "检索增强生成(RAG)",
      "套壳": "基于API封装的应用",
      "吧": "",
      "大模型": "大型语言模型(LLM)",
      "chain": "处理链(Chain)",
      "差不多": "大约",
      "嘛": "",
      "K8s": "Kubernetes",
      "ELK": "ELK日志系统(Elasticsearch+Logstash+Kibana)",
      "对了": "另外"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 5983,
    "prompt20_id": "b0a42af4",
    "prompt20_template": "请开发一个基于API封装的检索增强生成(RAG)应用，底层采用大型语言模型(LLM)，处理链需支持{{retrieval_modes_count}}。团队成员包括{{java_developers_count}}和{{python_developers_count}}，{{project_duration_weeks}}，{{project_budget_rmb}}。技术栈选用{{tech_stack}}。系统需支持多轮对话，能够保存{{conversation_history_rounds}}。部署环境为{{deployment_environment}}，采用{{architecture_type}}，{{service_count}}。需集成{{monitoring_system}}和{{logging_system}}。应用需支持{{supported_languages}}，{{response_time_limit_seconds}}。",
    "prompt20_variables": [
      {
        "variable": "retrieval_modes_count",
        "original_text": "三种以上的检索模式",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "java_developers_count",
        "original_text": "两名Java开发",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "python_developers_count",
        "original_text": "三名Python开发",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "project_duration_weeks",
        "original_text": "项目周期约为八周",
        "value": 8,
        "type": "Integer"
      },
      {
        "variable": "project_budget_rmb",
        "original_text": "预算为五十万元",
        "value": 500000,
        "type": "Integer"
      },
      {
        "variable": "tech_stack",
        "original_text": "LangChain、Milvus和FastAPI",
        "value": [
          "LangChain",
          "Milvus",
          "FastAPI"
        ],
        "type": "List"
      },
      {
        "variable": "conversation_history_rounds",
        "original_text": "约二十轮历史上下文",
        "value": 20,
        "type": "Integer"
      },
      {
        "variable": "deployment_environment",
        "original_text": "Kubernetes集群",
        "value": "Kubernetes集群",
        "type": "String"
      },
      {
        "variable": "architecture_type",
        "original_text": "微服务架构",
        "value": "微服务架构",
        "type": "Enum"
      },
      {
        "variable": "service_count",
        "original_text": "服务数量约为十个",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "monitoring_system",
        "original_text": "Prometheus监控",
        "value": "Prometheus监控",
        "type": "String"
      },
      {
        "variable": "logging_system",
        "original_text": "ELK日志系统(Elasticsearch、Logstash、Kibana)",
        "value": [
          "Elasticsearch",
          "Logstash",
          "Kibana"
        ],
        "type": "List"
      },
      {
        "variable": "supported_languages",
        "original_text": "中英文双语",
        "value": [
          "中文",
          "英文"
        ],
        "type": "List"
      },
      {
        "variable": "response_time_limit_seconds",
        "original_text": "响应时间控制在两秒以内",
        "value": 2,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 14,
    "prompt20_type_stats": {
      "Integer": 8,
      "List": 3,
      "String": 2,
      "Enum": 1
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "8f54916a",
    "prompt30_dsl_code": "DEFINE {{retrieval_modes_count}}: Integer = 3\nDEFINE {{java_developers_count}}: Integer = 2\nDEFINE {{python_developers_count}}: Integer = 3\nDEFINE {{project_duration_weeks}}: Integer = 8\nDEFINE {{project_budget_rmb}}: Integer = 500000\nDEFINE {{tech_stack}}: List = ['LangChain', 'Milvus', 'FastAPI']\nDEFINE {{conversation_history_rounds}}: Integer = 20\nDEFINE {{deployment_environment}}: String = \"Kubernetes集群\"\nDEFINE {{architecture_type}}: String = \"微服务架构\"\nDEFINE {{service_count}}: Integer = 10\nDEFINE {{monitoring_system}}: String = \"Prometheus监控\"\nDEFINE {{logging_system}}: List = ['Elasticsearch', 'Logstash', 'Kibana']\nDEFINE {{supported_languages}}: List = ['中文', '英文']\nDEFINE {{response_time_limit_seconds}}: Integer = 2\nDEFINE {{rag_app}}: Any\nDEFINE {{team}}: Dict\nDEFINE {{project_plan}}: Dict\nDEFINE {{deployment}}: Dict\nDEFINE {{monitoring}}: Dict\nDEFINE {{logging}}: Dict\n{{rag_app}} = CALL develop_rag_app(\n    retrieval_modes_count={{retrieval_modes_count}},\n    tech_stack={{tech_stack}},\n    conversation_history_rounds={{conversation_history_rounds}},\n    supported_languages={{supported_languages}},\n    response_time_limit_seconds={{response_time_limit_seconds}}\n)\n{{team}} = CALL configure_team(\n    java_developers_count={{java_developers_count}},\n    python_developers_count={{python_developers_count}}\n)\n{{project_plan}} = CALL create_project_plan(\n    duration_weeks={{project_duration_weeks}},\n    budget_rmb={{project_budget_rmb}}\n)\n{{deployment}} = CALL setup_deployment(\n    environment={{deployment_environment}},\n    architecture_type={{architecture_type}},\n    service_count={{service_count}}\n)\n{{monitoring}} = CALL integrate_monitoring(\n    system={{monitoring_system}}\n)\n{{logging}} = CALL integrate_logging(\n    logging_system={{logging_system}}\n)\nRETURN {{rag_app}}",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [],
      "defined_variables": {
        "retrieval_modes_count": {
          "name": "retrieval_modes_count",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 1
        },
        "java_developers_count": {
          "name": "java_developers_count",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 2
        },
        "python_developers_count": {
          "name": "python_developers_count",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 3
        },
        "project_duration_weeks": {
          "name": "project_duration_weeks",
          "var_type": "Integer",
          "initial_value": "8",
          "line_number": 4
        },
        "project_budget_rmb": {
          "name": "project_budget_rmb",
          "var_type": "Integer",
          "initial_value": "500000",
          "line_number": 5
        },
        "tech_stack": {
          "name": "tech_stack",
          "var_type": "List",
          "initial_value": "['LangChain', 'Milvus', 'FastAPI']",
          "line_number": 6
        },
        "conversation_history_rounds": {
          "name": "conversation_history_rounds",
          "var_type": "Integer",
          "initial_value": "20",
          "line_number": 7
        },
        "deployment_environment": {
          "name": "deployment_environment",
          "var_type": "String",
          "initial_value": "\"Kubernetes集群\"",
          "line_number": 8
        },
        "architecture_type": {
          "name": "architecture_type",
          "var_type": "String",
          "initial_value": "\"微服务架构\"",
          "line_number": 9
        },
        "service_count": {
          "name": "service_count",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 10
        },
        "monitoring_system": {
          "name": "monitoring_system",
          "var_type": "String",
          "initial_value": "\"Prometheus监控\"",
          "line_number": 11
        },
        "logging_system": {
          "name": "logging_system",
          "var_type": "List",
          "initial_value": "['Elasticsearch', 'Logstash', 'Kibana']",
          "line_number": 12
        },
        "supported_languages": {
          "name": "supported_languages",
          "var_type": "List",
          "initial_value": "['中文', '英文']",
          "line_number": 13
        },
        "response_time_limit_seconds": {
          "name": "response_time_limit_seconds",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 14
        },
        "rag_app": {
          "name": "rag_app",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 15
        },
        "team": {
          "name": "team",
          "var_type": "Dict",
          "initial_value": null,
          "line_number": 16
        },
        "project_plan": {
          "name": "project_plan",
          "var_type": "Dict",
          "initial_value": null,
          "line_number": 17
        },
        "deployment": {
          "name": "deployment",
          "var_type": "Dict",
          "initial_value": null,
          "line_number": 18
        },
        "monitoring": {
          "name": "monitoring",
          "var_type": "Dict",
          "initial_value": null,
          "line_number": 19
        },
        "logging": {
          "name": "logging",
          "var_type": "Dict",
          "initial_value": null,
          "line_number": 20
        }
      },
      "function_calls": [],
      "control_blocks": [],
      "max_nesting_depth": 0
    },
    "prompt30_time_ms": 11704,
    "prompt40_id": "01886a53",
    "prompt40_modules": [
      {
        "name": "step_1_develop_rag_app",
        "inputs": [
          "conversation_history_rounds",
          "response_time_limit_seconds",
          "retrieval_modes_count",
          "supported_languages",
          "tech_stack"
        ],
        "outputs": [
          "rag_app"
        ],
        "is_async": true
      },
      {
        "name": "step_2_configure_team",
        "inputs": [
          "java_developers_count",
          "python_developers_count"
        ],
        "outputs": [
          "team"
        ],
        "is_async": true
      },
      {
        "name": "step_3_create_project_plan",
        "inputs": [
          "project_budget_rmb",
          "project_duration_weeks"
        ],
        "outputs": [
          "project_plan"
        ],
        "is_async": true
      },
      {
        "name": "step_4_setup_deployment",
        "inputs": [
          "architecture_type",
          "deployment_environment",
          "service_count"
        ],
        "outputs": [
          "deployment"
        ],
        "is_async": true
      },
      {
        "name": "step_5_integrate_monitoring",
        "inputs": [
          "monitoring_system"
        ],
        "outputs": [
          "monitoring"
        ],
        "is_async": true
      },
      {
        "name": "step_6_integrate_logging",
        "inputs": [
          "logging_system"
        ],
        "outputs": [
          "logging"
        ],
        "is_async": true
      }
    ],
    "prompt40_module_count": 6,
    "prompt40_main_code": "async def main_workflow(input_params: dict):\n    \"\"\"\n    主工作流 - 自动生成\n    \n    Args:\n        input_params: 包含 ['architecture_type', 'conversation_history_rounds', 'deployment_environment', 'java_developers_count', 'logging_system', 'monitoring_system', 'project_budget_rmb', 'project_duration_weeks', 'python_developers_count', 'response_time_limit_seconds', 'retrieval_modes_count', 'service_count', 'supported_languages', 'tech_stack'] 的字典\n    \n    Returns:\n        执行结果上下文\n    \"\"\"\n    # 初始化上下文\n    ctx = input_params.copy()\n\n    # Module 1: step_1_develop_rag_app\n    ctx[\"rag_app\"] = await step_1_develop_rag_app(ctx.get(\"conversation_history_rounds\"), ctx.get(\"response_time_limit_seconds\"), ctx.get(\"retrieval_modes_count\"), ctx.get(\"supported_languages\"), ctx.get(\"tech_stack\"))\n\n    # Module 2: step_2_configure_team\n    ctx[\"team\"] = await step_2_configure_team(ctx.get(\"java_developers_count\"), ctx.get(\"python_developers_count\"))\n\n    # Module 3: step_3_create_project_plan\n    ctx[\"project_plan\"] = await step_3_create_project_plan(ctx.get(\"project_budget_rmb\"), ctx.get(\"project_duration_weeks\"))\n\n    # Module 4: step_4_setup_deployment\n    ctx[\"deployment\"] = await step_4_setup_deployment(ctx.get(\"architecture_type\"), ctx.get(\"deployment_environment\"), ctx.get(\"service_count\"))\n\n    # Module 5: step_5_integrate_monitoring\n    ctx[\"monitoring\"] = await step_5_integrate_monitoring(ctx.get(\"monitoring_system\"))\n\n    # Module 6: step_6_integrate_logging\n    ctx[\"logging\"] = await step_6_integrate_logging(ctx.get(\"logging_system\"))\n\n    return ctx",
    "prompt40_time_ms": 5,
    "overall_status": "success",
    "total_time_ms": 17692,
    "error_message": null
  },
  "19613ea2": {
    "pipeline_id": "19613ea2",
    "timestamp": "2026-01-28 11:01:09",
    "raw_input": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
    "prompt10_id": "1c5497f5",
    "prompt10_original": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
    "prompt10_processed": "请开发一个基于API封装的检索增强生成(RAG)应用。该应用将以大型语言模型(LLM)为基础，处理链(Chain)的复杂度较高，需支持三种以上的检索模式。团队由五人组成，其中两名开发人员使用Java，三名使用Python。项目周期约为八周，预算大约为五十万元。技术栈包括LangChain、Milvus和FastAPI。应用需支持多轮对话，能够存储约20轮的历史上下文。部署环境为Kubernetes集群，需开发成微服务架构，服务数量约为十个。此外，请添加监控和日志功能，使用Prometheus和ELK日志系统（Elasticsearch、Logstash和Kibana）。最后，应用需支持中英文双语，响应时间控制在两秒以内。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
        "output_text": "，帮我开发一个检索增强生成(RAG)的基于API封装的应用应用。\n要用大型语言模型(LLM)做底座，处理链(Chain)的话复杂一点，大约要支持3种以上的检索模式。\n团队就5个人，其中2个是开发Java的，还有3个写Python的。\n项目周期，大概8周，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是Kubernetes集群，要开发成微服务架构，服务数量大约10来个。\n最后记得加上监控和日志，用Prometheus和ELK日志系统(Elasticsearch+Logstash+Kibana)那套。\n另外，要支持中英文双语，响应时间控制在2秒以内。",
        "changes": {
          "那个": "",
          "搞": "开发",
          "RAG": "检索增强生成(RAG)",
          "套壳": "基于API封装的应用",
          "吧": "",
          "大模型": "大型语言模型(LLM)",
          "chain": "处理链(Chain)",
          "差不多": "大约",
          "嘛": "",
          "K8s": "Kubernetes",
          "ELK": "ELK日志系统(Elasticsearch+Logstash+Kibana)",
          "对了": "另外"
        },
        "duration_ms": 0,
        "notes": [
          "替换 16 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
        "output_text": "，帮我开发一个检索增强生成(RAG)的基于API封装的应用应用。\n要用大型语言模型(LLM)做底座，处理链(Chain)的话复杂一点，大约要支持3种以上的检索模式。\n团队就5个人，其中2个是开发Java的，还有3个写Python的。\n项目周期，大概8周，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是Kubernetes集群，要开发成微服务架构，服务数量大约10来个。\n最后记得加上监控和日志，用Prometheus和ELK日志系统(Elasticsearch+Logstash+Kibana)那套。\n另外，要支持中英文双语，响应时间控制在2秒以内。",
        "changes": {
          "那个": "",
          "搞": "开发",
          "RAG": "检索增强生成(RAG)",
          "套壳": "基于API封装的应用",
          "吧": "",
          "大模型": "大型语言模型(LLM)",
          "chain": "处理链(Chain)",
          "差不多": "大约",
          "嘛": "",
          "K8s": "Kubernetes",
          "ELK": "ELK日志系统(Elasticsearch+Logstash+Kibana)",
          "对了": "另外"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "，帮我开发一个检索增强生成(RAG)的基于API封装的应用应用。\n要用大型语言模型(LLM)做底座，处理链(Chain)的话复杂一点，大约要支持3种以上的检索模式。\n团队就5个人，其中2个是开发Java的，还有3个写Python的。\n项目周期，大概8周，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是Kubernetes集群，要开发成微服务架构，服务数量大约10来个。\n最后记得加上监控和日志，用Prometheus和ELK日志系统(Elasticsearch+Logstash+Kibana)那套。\n另外，要支持中英文双语，响应时间控制在2秒以内。",
        "output_text": "请开发一个基于API封装的检索增强生成(RAG)应用。该应用将以大型语言模型(LLM)为基础，处理链(Chain)的复杂度较高，需支持三种以上的检索模式。团队由五人组成，其中两名开发人员使用Java，三名使用Python。项目周期约为八周，预算大约为五十万元。技术栈包括LangChain、Milvus和FastAPI。应用需支持多轮对话，能够存储约20轮的历史上下文。部署环境为Kubernetes集群，需开发成微服务架构，服务数量约为十个。此外，请添加监控和日志功能，使用Prometheus和ELK日志系统（Elasticsearch、Logstash和Kibana）。最后，应用需支持中英文双语，响应时间控制在两秒以内。",
        "changes": {
          "标准化": "335字 → 314字"
        },
        "duration_ms": 8008,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "那个": "",
      "搞": "开发",
      "RAG": "检索增强生成(RAG)",
      "套壳": "基于API封装的应用",
      "吧": "",
      "大模型": "大型语言模型(LLM)",
      "chain": "处理链(Chain)",
      "差不多": "大约",
      "嘛": "",
      "K8s": "Kubernetes",
      "ELK": "ELK日志系统(Elasticsearch+Logstash+Kibana)",
      "对了": "另外"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 8009,
    "prompt20_id": "5afca598",
    "prompt20_template": "请开发一个基于API封装的检索增强生成(RAG)应用。该应用将以大型语言模型(LLM)为基础，处理链(Chain)的复杂度较高，需支持三种以上的检索模式。团队由{{team_size}}组成，其中{{java_developers}}，{{python_developers}}。项目周期约为{{project_duration_weeks}}，预算大约为{{budget}}。技术栈包括LangChain、Milvus和FastAPI。应用需支持多轮对话，能够存储约{{context_history_rounds}}的历史上下文。部署环境为Kubernetes集群，需开发成微服务架构，服务数量约为{{service_count}}。此外，请添加监控和日志功能，使用Prometheus和ELK日志系统（Elasticsearch、Logstash和Kibana）。最后，应用需支持中英文双语，响应时间控制在{{response_time_seconds}}以内。",
    "prompt20_variables": [
      {
        "variable": "team_size",
        "original_text": "五人",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "java_developers",
        "original_text": "两名开发人员使用Java",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "python_developers",
        "original_text": "三名使用Python",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "project_duration_weeks",
        "original_text": "八周",
        "value": 8,
        "type": "Integer"
      },
      {
        "variable": "budget",
        "original_text": "五十万元",
        "value": 500000,
        "type": "Integer"
      },
      {
        "variable": "context_history_rounds",
        "original_text": "20轮",
        "value": 20,
        "type": "Integer"
      },
      {
        "variable": "service_count",
        "original_text": "十个",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_seconds",
        "original_text": "两秒",
        "value": 2,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 8,
    "prompt20_type_stats": {
      "Integer": 8
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "58662654",
    "prompt30_dsl_code": "DEFINE {{team_size}}: Integer = 5\nDEFINE {{java_developers}}: Integer = 2\nDEFINE {{python_developers}}: Integer = 3\nDEFINE {{project_duration_weeks}}: Integer = 8\nDEFINE {{budget}}: Integer = 500000\nDEFINE {{context_history_rounds}}: Integer = 20\nDEFINE {{service_count}}: Integer = 10\nDEFINE {{response_time_seconds}}: Integer = 2\nDEFINE {{result}}: Any\n{{result}} = CALL develop_RAG_application({{team_size}}, {{java_developers}}, {{python_developers}}, {{project_duration_weeks}}, {{budget}}, {{context_history_rounds}}, {{service_count}}, {{response_time_seconds}})",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [],
      "defined_variables": {
        "team_size": {
          "name": "team_size",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 1
        },
        "java_developers": {
          "name": "java_developers",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 2
        },
        "python_developers": {
          "name": "python_developers",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 3
        },
        "project_duration_weeks": {
          "name": "project_duration_weeks",
          "var_type": "Integer",
          "initial_value": "8",
          "line_number": 4
        },
        "budget": {
          "name": "budget",
          "var_type": "Integer",
          "initial_value": "500000",
          "line_number": 5
        },
        "context_history_rounds": {
          "name": "context_history_rounds",
          "var_type": "Integer",
          "initial_value": "20",
          "line_number": 6
        },
        "service_count": {
          "name": "service_count",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 7
        },
        "response_time_seconds": {
          "name": "response_time_seconds",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 8
        },
        "result": {
          "name": "result",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 9
        }
      },
      "function_calls": [
        {
          "function_name": "develop_RAG_application",
          "arguments": [
            "{{team_size}}",
            "{{java_developers}}",
            "{{python_developers}}",
            "{{project_duration_weeks}}",
            "{{budget}}",
            "{{context_history_rounds}}",
            "{{service_count}}",
            "{{response_time_seconds}}"
          ],
          "result_var": "result",
          "line_number": 10
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 0
    },
    "prompt30_time_ms": 12555,
    "prompt40_id": "8e5cbdc8",
    "prompt40_modules": [
      {
        "name": "step_1_develop_RAG_application",
        "inputs": [
          "budget",
          "context_history_rounds",
          "java_developers",
          "project_duration_weeks",
          "python_developers",
          "response_time_seconds",
          "service_count",
          "team_size"
        ],
        "outputs": [
          "result"
        ],
        "is_async": true
      }
    ],
    "prompt40_module_count": 1,
    "prompt40_main_code": "async def main_workflow(input_params: dict):\n    \"\"\"\n    主工作流 - 自动生成\n    \n    Args:\n        input_params: 包含 ['budget', 'context_history_rounds', 'java_developers', 'project_duration_weeks', 'python_developers', 'response_time_seconds', 'service_count', 'team_size'] 的字典\n    \n    Returns:\n        执行结果上下文\n    \"\"\"\n    # 初始化上下文\n    ctx = input_params.copy()\n\n    # Module 1: step_1_develop_RAG_application\n    ctx[\"result\"] = await step_1_develop_RAG_application(ctx.get(\"budget\"), ctx.get(\"context_history_rounds\"), ctx.get(\"java_developers\"), ctx.get(\"project_duration_weeks\"), ctx.get(\"python_developers\"), ctx.get(\"response_time_seconds\"), ctx.get(\"service_count\"), ctx.get(\"team_size\"))\n\n    return ctx",
    "prompt40_time_ms": 3,
    "prompt40_step1_parsing": {
      "total_blocks": 1,
      "block_types": {
        "CALL": 1
      },
      "blocks": [
        {
          "id": "OP_0",
          "type": "CALL",
          "line_number": 10,
          "is_async": true,
          "inputs": [
            "context_history_rounds",
            "java_developers",
            "project_duration_weeks",
            "team_size",
            "service_count",
            "budget",
            "python_developers",
            "response_time_seconds"
          ],
          "outputs": [
            "result"
          ],
          "code_lines": [
            "{{result}} = CALL develop_RAG_application({{team_size}}, {{java_developers}}, {{python_developers}}, {{project_duration_weeks}}, {{budget}}, {{context_history_rounds}}, {{service_count}}, {{response_time_seconds}})"
          ]
        }
      ]
    },
    "prompt40_step2_dependency": {
      "has_cycles": false,
      "dead_code_count": 1,
      "dead_code_blocks": [
        "OP_0"
      ],
      "topological_order": [
        "OP_0"
      ],
      "edge_count": 0,
      "node_count": 1
    },
    "prompt40_step3_clustering": {
      "strategy": "hybrid",
      "total_clusters": 1,
      "clusters": [
        {
          "cluster_id": 1,
          "block_count": 1,
          "blocks": [
            "OP_0"
          ]
        }
      ]
    },
    "prompt40_step4_generation": {
      "total_modules": 1,
      "async_modules": 1,
      "sync_modules": 0,
      "modules": [
        {
          "name": "step_1_develop_RAG_application",
          "inputs": [
            "budget",
            "context_history_rounds",
            "java_developers",
            "project_duration_weeks",
            "python_developers",
            "response_time_seconds",
            "service_count",
            "team_size"
          ],
          "outputs": [
            "result"
          ],
          "is_async": true,
          "body_code": "async def step_1_develop_RAG_application(budget, context_history_rounds, java_developers, project_duration_weeks, python_developers, response_time_seconds, service_count, team_size):\n    \"\"\"Auto-generated module\"\"\"\n    result = await invoke_function('develop_RAG_application', team_size=team_size, java_developers=java_developers, python_developers=python_developers, project_duration_weeks=project_duration_weeks, budget=budget, context_history_rounds=context_history_rounds, service_count=service_count, response_time_seconds=response_time_seconds)\n    return result",
          "original_block_count": 1
        }
      ]
    },
    "prompt40_step5_orchestration": {
      "main_inputs": [
        "budget",
        "context_history_rounds",
        "java_developers",
        "project_duration_weeks",
        "python_developers",
        "response_time_seconds",
        "service_count",
        "team_size"
      ],
      "input_count": 8,
      "main_code": "async def main_workflow(input_params: dict):\n    \"\"\"\n    主工作流 - 自动生成\n    \n    Args:\n        input_params: 包含 ['budget', 'context_history_rounds', 'java_developers', 'project_duration_weeks', 'python_developers', 'response_time_seconds', 'service_count', 'team_size'] 的字典\n    \n    Returns:\n        执行结果上下文\n    \"\"\"\n    # 初始化上下文\n    ctx = input_params.copy()\n\n    # Module 1: step_1_develop_RAG_application\n    ctx[\"result\"] = await step_1_develop_RAG_application(ctx.get(\"budget\"), ctx.get(\"context_history_rounds\"), ctx.get(\"java_developers\"), ctx.get(\"project_duration_weeks\"), ctx.get(\"python_developers\"), ctx.get(\"response_time_seconds\"), ctx.get(\"service_count\"), ctx.get(\"team_size\"))\n\n    return ctx"
    },
    "overall_status": "success",
    "total_time_ms": 20567,
    "error_message": null
  },
  "97715e32": {
    "pipeline_id": "97715e32",
    "timestamp": "2026-01-28 14:48:36",
    "raw_input": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
    "prompt10_id": "9dc0ed38",
    "prompt10_original": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
    "prompt10_processed": "请开发一个基于API封装的检索增强生成(RAG)应用。该应用应以大型语言模型(LLM)为基础，处理链(Chain)设计较为复杂，需支持三种以上的检索模式。团队由五人组成，其中两名开发Java，三名开发Python。项目周期约为八周，预算大约为五十万元。技术栈使用LangChain、Milvus和FastAPI。应用需支持多轮对话，能够存储约20轮的历史上下文。部署环境为Kubernetes集群，需开发成微服务架构，服务数量约为十个。最后，请确保添加监控和日志功能，使用Prometheus和ELK日志系统（Elasticsearch、Logstash、Kibana）。此外，应用需支持中英文双语，响应时间控制在两秒以内。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
        "output_text": "，帮我开发一个检索增强生成(RAG)的基于API封装的应用应用。\n要用大型语言模型(LLM)做底座，处理链(Chain)的话复杂一点，大约要支持3种以上的检索模式。\n团队就5个人，其中2个是开发Java的，还有3个写Python的。\n项目周期，大概8周，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是Kubernetes集群，要开发成微服务架构，服务数量大约10来个。\n最后记得加上监控和日志，用Prometheus和ELK日志系统(Elasticsearch+Logstash+Kibana)那套。\n另外，要支持中英文双语，响应时间控制在2秒以内。",
        "changes": {
          "那个": "",
          "搞": "开发",
          "RAG": "检索增强生成(RAG)",
          "套壳": "基于API封装的应用",
          "吧": "",
          "大模型": "大型语言模型(LLM)",
          "chain": "处理链(Chain)",
          "差不多": "大约",
          "嘛": "",
          "K8s": "Kubernetes",
          "ELK": "ELK日志系统(Elasticsearch+Logstash+Kibana)",
          "对了": "另外"
        },
        "duration_ms": 0,
        "notes": [
          "替换 16 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "那个，帮我搞一个RAG的套壳应用吧。\n要用大模型做底座，chain的话复杂一点，差不多要支持3种以上的检索模式。\n团队就5个人，其中2个是搞Java的，还有3个写Python的。\n项目周期嘛，大概8周吧，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是K8s集群，要搞成微服务架构，服务数量差不多10来个。\n最后记得加上监控和日志，用Prometheus和ELK那套。\n对了，要支持中英文双语，响应时间控制在2秒以内。",
        "output_text": "，帮我开发一个检索增强生成(RAG)的基于API封装的应用应用。\n要用大型语言模型(LLM)做底座，处理链(Chain)的话复杂一点，大约要支持3种以上的检索模式。\n团队就5个人，其中2个是开发Java的，还有3个写Python的。\n项目周期，大概8周，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是Kubernetes集群，要开发成微服务架构，服务数量大约10来个。\n最后记得加上监控和日志，用Prometheus和ELK日志系统(Elasticsearch+Logstash+Kibana)那套。\n另外，要支持中英文双语，响应时间控制在2秒以内。",
        "changes": {
          "那个": "",
          "搞": "开发",
          "RAG": "检索增强生成(RAG)",
          "套壳": "基于API封装的应用",
          "吧": "",
          "大模型": "大型语言模型(LLM)",
          "chain": "处理链(Chain)",
          "差不多": "大约",
          "嘛": "",
          "K8s": "Kubernetes",
          "ELK": "ELK日志系统(Elasticsearch+Logstash+Kibana)",
          "对了": "另外"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "，帮我开发一个检索增强生成(RAG)的基于API封装的应用应用。\n要用大型语言模型(LLM)做底座，处理链(Chain)的话复杂一点，大约要支持3种以上的检索模式。\n团队就5个人，其中2个是开发Java的，还有3个写Python的。\n项目周期，大概8周，预算的话50万左右应该够了。\n技术栈就用LangChain、Milvus、还有FastAPI这些。\n需要支持多轮对话，上下文窗口要能存个20轮左右的历史。\n部署环境是Kubernetes集群，要开发成微服务架构，服务数量大约10来个。\n最后记得加上监控和日志，用Prometheus和ELK日志系统(Elasticsearch+Logstash+Kibana)那套。\n另外，要支持中英文双语，响应时间控制在2秒以内。",
        "output_text": "请开发一个基于API封装的检索增强生成(RAG)应用。该应用应以大型语言模型(LLM)为基础，处理链(Chain)设计较为复杂，需支持三种以上的检索模式。团队由五人组成，其中两名开发Java，三名开发Python。项目周期约为八周，预算大约为五十万元。技术栈使用LangChain、Milvus和FastAPI。应用需支持多轮对话，能够存储约20轮的历史上下文。部署环境为Kubernetes集群，需开发成微服务架构，服务数量约为十个。最后，请确保添加监控和日志功能，使用Prometheus和ELK日志系统（Elasticsearch、Logstash、Kibana）。此外，应用需支持中英文双语，响应时间控制在两秒以内。",
        "changes": {
          "标准化": "335字 → 312字"
        },
        "duration_ms": 6353,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "那个": "",
      "搞": "开发",
      "RAG": "检索增强生成(RAG)",
      "套壳": "基于API封装的应用",
      "吧": "",
      "大模型": "大型语言模型(LLM)",
      "chain": "处理链(Chain)",
      "差不多": "大约",
      "嘛": "",
      "K8s": "Kubernetes",
      "ELK": "ELK日志系统(Elasticsearch+Logstash+Kibana)",
      "对了": "另外"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 6354,
    "prompt20_id": "d8b4e945",
    "prompt20_template": "请开发一个基于API封装的检索增强生成(RAG)应用。该应用应以大型语言模型(LLM)为基础，处理链(Chain)设计较为复杂，需支持三种以上的检索模式。{{team_size}}，{{java_developers}}，{{python_developers}}。{{project_duration_weeks}}，{{budget}}。技术栈使用LangChain、Milvus和FastAPI。应用需支持多轮对话，{{history_context_rounds}}。部署环境为Kubernetes集群，需开发成微服务架构，{{service_count}}。最后，请确保添加监控和日志功能，使用Prometheus和ELK日志系统（Elasticsearch、Logstash、Kibana）。此外，{{supported_languages}}，{{response_time_seconds}}。",
    "prompt20_variables": [
      {
        "variable": "team_size",
        "original_text": "团队由五人组成",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "java_developers",
        "original_text": "其中两名开发Java",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "python_developers",
        "original_text": "三名开发Python",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "project_duration_weeks",
        "original_text": "项目周期约为八周",
        "value": 8,
        "type": "Integer"
      },
      {
        "variable": "budget",
        "original_text": "预算大约为五十万元",
        "value": 500000,
        "type": "Integer"
      },
      {
        "variable": "history_context_rounds",
        "original_text": "能够存储约20轮的历史上下文",
        "value": 20,
        "type": "Integer"
      },
      {
        "variable": "service_count",
        "original_text": "服务数量约为十个",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "supported_languages",
        "original_text": "应用需支持中英文双语",
        "value": [
          "[\"中文\"",
          "\"英文\"]"
        ],
        "type": "List"
      },
      {
        "variable": "response_time_seconds",
        "original_text": "响应时间控制在两秒以内",
        "value": 2,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 9,
    "prompt20_type_stats": {
      "Integer": 8,
      "List": 1
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "d5f22fba",
    "prompt30_dsl_code": "DEFINE {{team_size}}: Integer = 5\nDEFINE {{java_developers}}: Integer = 2\nDEFINE {{python_developers}}: Integer = 3\nDEFINE {{project_duration_weeks}}: Integer = 8\nDEFINE {{budget}}: Integer = 500000\nDEFINE {{history_context_rounds}}: Integer = 20\nDEFINE {{service_count}}: Integer = 10\nDEFINE {{supported_languages}}: List = ['[\"中文\"', '\"英文\"]']\nDEFINE {{response_time_seconds}}: Integer = 2\nDEFINE {{application}}: Any\nDEFINE {{chain_design}}: Any\nDEFINE {{retrieval_modes}}: Any\nDEFINE {{tech_stack}}: Any\nDEFINE {{dialogue_support}}: Any\nDEFINE {{deployment}}: Any\nDEFINE {{microservices}}: Any\nDEFINE {{monitoring_logging}}: Any\nDEFINE {{bilingual_support}}: Any\nDEFINE {{response_time_control}}: Any\n{{application}} = CALL create_application()\n{{chain_design}} = CALL design_chain()\n{{retrieval_modes}} = CALL define_retrieval_modes()\n{{tech_stack}} = CALL setup_tech_stack({{java_developers}}, {{python_developers}})\n{{dialogue_support}} = CALL enable_dialogue_support({{history_context_rounds}})\n{{deployment}} = CALL deploy_to_kubernetes({{service_count}})\n{{microservices}} = CALL create_microservices()\n{{monitoring_logging}} = CALL setup_monitoring_logging()\n{{bilingual_support}} = CALL enable_bilingual_support({{supported_languages}})\n{{response_time_control}} = CALL set_response_time_control({{response_time_seconds}})",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [],
      "defined_variables": {
        "team_size": {
          "name": "team_size",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 1
        },
        "java_developers": {
          "name": "java_developers",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 2
        },
        "python_developers": {
          "name": "python_developers",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 3
        },
        "project_duration_weeks": {
          "name": "project_duration_weeks",
          "var_type": "Integer",
          "initial_value": "8",
          "line_number": 4
        },
        "budget": {
          "name": "budget",
          "var_type": "Integer",
          "initial_value": "500000",
          "line_number": 5
        },
        "history_context_rounds": {
          "name": "history_context_rounds",
          "var_type": "Integer",
          "initial_value": "20",
          "line_number": 6
        },
        "service_count": {
          "name": "service_count",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 7
        },
        "supported_languages": {
          "name": "supported_languages",
          "var_type": "List",
          "initial_value": "['[\"中文\"', '\"英文\"]']",
          "line_number": 8
        },
        "response_time_seconds": {
          "name": "response_time_seconds",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 9
        },
        "application": {
          "name": "application",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 10
        },
        "chain_design": {
          "name": "chain_design",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 11
        },
        "retrieval_modes": {
          "name": "retrieval_modes",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 12
        },
        "tech_stack": {
          "name": "tech_stack",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 13
        },
        "dialogue_support": {
          "name": "dialogue_support",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 14
        },
        "deployment": {
          "name": "deployment",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 15
        },
        "microservices": {
          "name": "microservices",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 16
        },
        "monitoring_logging": {
          "name": "monitoring_logging",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 17
        },
        "bilingual_support": {
          "name": "bilingual_support",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 18
        },
        "response_time_control": {
          "name": "response_time_control",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 19
        }
      },
      "function_calls": [
        {
          "function_name": "create_application",
          "arguments": [],
          "result_var": "application",
          "line_number": 20
        },
        {
          "function_name": "design_chain",
          "arguments": [],
          "result_var": "chain_design",
          "line_number": 21
        },
        {
          "function_name": "define_retrieval_modes",
          "arguments": [],
          "result_var": "retrieval_modes",
          "line_number": 22
        },
        {
          "function_name": "setup_tech_stack",
          "arguments": [
            "{{java_developers}}",
            "{{python_developers}}"
          ],
          "result_var": "tech_stack",
          "line_number": 23
        },
        {
          "function_name": "enable_dialogue_support",
          "arguments": [
            "{{history_context_rounds}}"
          ],
          "result_var": "dialogue_support",
          "line_number": 24
        },
        {
          "function_name": "deploy_to_kubernetes",
          "arguments": [
            "{{service_count}}"
          ],
          "result_var": "deployment",
          "line_number": 25
        },
        {
          "function_name": "create_microservices",
          "arguments": [],
          "result_var": "microservices",
          "line_number": 26
        },
        {
          "function_name": "setup_monitoring_logging",
          "arguments": [],
          "result_var": "monitoring_logging",
          "line_number": 27
        },
        {
          "function_name": "enable_bilingual_support",
          "arguments": [
            "{{supported_languages}}"
          ],
          "result_var": "bilingual_support",
          "line_number": 28
        },
        {
          "function_name": "set_response_time_control",
          "arguments": [
            "{{response_time_seconds}}"
          ],
          "result_var": "response_time_control",
          "line_number": 29
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 0
    },
    "prompt30_time_ms": 12317,
    "prompt40_id": "e0e4d66a",
    "prompt40_modules": [
      {
        "name": "step_1_create_application",
        "inputs": [],
        "outputs": [
          "application"
        ],
        "is_async": true
      },
      {
        "name": "step_2_design_chain",
        "inputs": [],
        "outputs": [
          "chain_design"
        ],
        "is_async": true
      },
      {
        "name": "step_3_define_retrieval_modes",
        "inputs": [],
        "outputs": [
          "retrieval_modes"
        ],
        "is_async": true
      },
      {
        "name": "step_4_setup_tech_stack",
        "inputs": [
          "java_developers",
          "python_developers"
        ],
        "outputs": [
          "tech_stack"
        ],
        "is_async": true
      },
      {
        "name": "step_5_enable_dialogue_support",
        "inputs": [
          "history_context_rounds"
        ],
        "outputs": [
          "dialogue_support"
        ],
        "is_async": true
      },
      {
        "name": "step_6_deploy_to_kubernetes",
        "inputs": [
          "service_count"
        ],
        "outputs": [
          "deployment"
        ],
        "is_async": true
      },
      {
        "name": "step_7_create_microservices",
        "inputs": [],
        "outputs": [
          "microservices"
        ],
        "is_async": true
      },
      {
        "name": "step_8_setup_monitoring_logging",
        "inputs": [],
        "outputs": [
          "monitoring_logging"
        ],
        "is_async": true
      },
      {
        "name": "step_9_enable_bilingual_support",
        "inputs": [
          "supported_languages"
        ],
        "outputs": [
          "bilingual_support"
        ],
        "is_async": true
      },
      {
        "name": "step_10_set_response_time_control",
        "inputs": [
          "response_time_seconds"
        ],
        "outputs": [
          "response_time_control"
        ],
        "is_async": true
      }
    ],
    "prompt40_module_count": 10,
    "prompt40_main_code": "async def main_workflow(input_params: dict):\n    \"\"\"\n    主工作流 - 自动生成\n    \n    Args:\n        input_params: 包含 ['history_context_rounds', 'java_developers', 'python_developers', 'response_time_seconds', 'service_count', 'supported_languages'] 的字典\n    \n    Returns:\n        执行结果上下文\n    \"\"\"\n    # 初始化上下文\n    ctx = input_params.copy()\n\n    # Module 1: step_1_create_application\n    ctx[\"application\"] = await step_1_create_application()\n\n    # Module 2: step_2_design_chain\n    ctx[\"chain_design\"] = await step_2_design_chain()\n\n    # Module 3: step_3_define_retrieval_modes\n    ctx[\"retrieval_modes\"] = await step_3_define_retrieval_modes()\n\n    # Module 4: step_4_setup_tech_stack\n    ctx[\"tech_stack\"] = await step_4_setup_tech_stack(ctx.get(\"java_developers\"), ctx.get(\"python_developers\"))\n\n    # Module 5: step_5_enable_dialogue_support\n    ctx[\"dialogue_support\"] = await step_5_enable_dialogue_support(ctx.get(\"history_context_rounds\"))\n\n    # Module 6: step_6_deploy_to_kubernetes\n    ctx[\"deployment\"] = await step_6_deploy_to_kubernetes(ctx.get(\"service_count\"))\n\n    # Module 7: step_7_create_microservices\n    ctx[\"microservices\"] = await step_7_create_microservices()\n\n    # Module 8: step_8_setup_monitoring_logging\n    ctx[\"monitoring_logging\"] = await step_8_setup_monitoring_logging()\n\n    # Module 9: step_9_enable_bilingual_support\n    ctx[\"bilingual_support\"] = await step_9_enable_bilingual_support(ctx.get(\"supported_languages\"))\n\n    # Module 10: step_10_set_response_time_control\n    ctx[\"response_time_control\"] = await step_10_set_response_time_control(ctx.get(\"response_time_seconds\"))\n\n    return ctx",
    "prompt40_time_ms": 5,
    "prompt40_step1_parsing": {
      "total_blocks": 10,
      "block_types": {
        "CALL": 10
      },
      "blocks": [
        {
          "id": "OP_0",
          "type": "CALL",
          "line_number": 20,
          "is_async": true,
          "inputs": [],
          "outputs": [
            "application"
          ],
          "code_lines": [
            "{{application}} = CALL create_application()"
          ]
        },
        {
          "id": "OP_1",
          "type": "CALL",
          "line_number": 21,
          "is_async": true,
          "inputs": [],
          "outputs": [
            "chain_design"
          ],
          "code_lines": [
            "{{chain_design}} = CALL design_chain()"
          ]
        },
        {
          "id": "OP_2",
          "type": "CALL",
          "line_number": 22,
          "is_async": true,
          "inputs": [],
          "outputs": [
            "retrieval_modes"
          ],
          "code_lines": [
            "{{retrieval_modes}} = CALL define_retrieval_modes()"
          ]
        },
        {
          "id": "OP_3",
          "type": "CALL",
          "line_number": 23,
          "is_async": true,
          "inputs": [
            "python_developers",
            "java_developers"
          ],
          "outputs": [
            "tech_stack"
          ],
          "code_lines": [
            "{{tech_stack}} = CALL setup_tech_stack({{java_developers}}, {{python_developers}})"
          ]
        },
        {
          "id": "OP_4",
          "type": "CALL",
          "line_number": 24,
          "is_async": true,
          "inputs": [
            "history_context_rounds"
          ],
          "outputs": [
            "dialogue_support"
          ],
          "code_lines": [
            "{{dialogue_support}} = CALL enable_dialogue_support({{history_context_rounds}})"
          ]
        },
        {
          "id": "OP_5",
          "type": "CALL",
          "line_number": 25,
          "is_async": true,
          "inputs": [
            "service_count"
          ],
          "outputs": [
            "deployment"
          ],
          "code_lines": [
            "{{deployment}} = CALL deploy_to_kubernetes({{service_count}})"
          ]
        },
        {
          "id": "OP_6",
          "type": "CALL",
          "line_number": 26,
          "is_async": true,
          "inputs": [],
          "outputs": [
            "microservices"
          ],
          "code_lines": [
            "{{microservices}} = CALL create_microservices()"
          ]
        },
        {
          "id": "OP_7",
          "type": "CALL",
          "line_number": 27,
          "is_async": true,
          "inputs": [],
          "outputs": [
            "monitoring_logging"
          ],
          "code_lines": [
            "{{monitoring_logging}} = CALL setup_monitoring_logging()"
          ]
        },
        {
          "id": "OP_8",
          "type": "CALL",
          "line_number": 28,
          "is_async": true,
          "inputs": [
            "supported_languages"
          ],
          "outputs": [
            "bilingual_support"
          ],
          "code_lines": [
            "{{bilingual_support}} = CALL enable_bilingual_support({{supported_languages}})"
          ]
        },
        {
          "id": "OP_9",
          "type": "CALL",
          "line_number": 29,
          "is_async": true,
          "inputs": [
            "response_time_seconds"
          ],
          "outputs": [
            "response_time_control"
          ],
          "code_lines": [
            "{{response_time_control}} = CALL set_response_time_control({{response_time_seconds}})"
          ]
        }
      ]
    },
    "prompt40_step2_dependency": {
      "has_cycles": false,
      "dead_code_count": 10,
      "dead_code_blocks": [
        "OP_0",
        "OP_1",
        "OP_2",
        "OP_3",
        "OP_4",
        "OP_5",
        "OP_6",
        "OP_7",
        "OP_8",
        "OP_9"
      ],
      "topological_order": [
        "OP_0",
        "OP_1",
        "OP_2",
        "OP_3",
        "OP_4",
        "OP_5",
        "OP_6",
        "OP_7",
        "OP_8",
        "OP_9"
      ],
      "edge_count": 0,
      "node_count": 10
    },
    "prompt40_step3_clustering": {
      "strategy": "hybrid",
      "total_clusters": 10,
      "clusters": [
        {
          "cluster_id": 1,
          "block_count": 1,
          "blocks": [
            "OP_0"
          ]
        },
        {
          "cluster_id": 2,
          "block_count": 1,
          "blocks": [
            "OP_1"
          ]
        },
        {
          "cluster_id": 3,
          "block_count": 1,
          "blocks": [
            "OP_2"
          ]
        },
        {
          "cluster_id": 4,
          "block_count": 1,
          "blocks": [
            "OP_3"
          ]
        },
        {
          "cluster_id": 5,
          "block_count": 1,
          "blocks": [
            "OP_4"
          ]
        },
        {
          "cluster_id": 6,
          "block_count": 1,
          "blocks": [
            "OP_5"
          ]
        },
        {
          "cluster_id": 7,
          "block_count": 1,
          "blocks": [
            "OP_6"
          ]
        },
        {
          "cluster_id": 8,
          "block_count": 1,
          "blocks": [
            "OP_7"
          ]
        },
        {
          "cluster_id": 9,
          "block_count": 1,
          "blocks": [
            "OP_8"
          ]
        },
        {
          "cluster_id": 10,
          "block_count": 1,
          "blocks": [
            "OP_9"
          ]
        }
      ]
    },
    "prompt40_step4_generation": {
      "total_modules": 10,
      "async_modules": 10,
      "sync_modules": 0,
      "modules": [
        {
          "name": "step_1_create_application",
          "inputs": [],
          "outputs": [
            "application"
          ],
          "is_async": true,
          "body_code": "async def step_1_create_application():\n    \"\"\"Auto-generated module\"\"\"\n    application = await invoke_function('create_application')\n    return application",
          "original_block_count": 1
        },
        {
          "name": "step_2_design_chain",
          "inputs": [],
          "outputs": [
            "chain_design"
          ],
          "is_async": true,
          "body_code": "async def step_2_design_chain():\n    \"\"\"Auto-generated module\"\"\"\n    chain_design = await invoke_function('design_chain')\n    return chain_design",
          "original_block_count": 1
        },
        {
          "name": "step_3_define_retrieval_modes",
          "inputs": [],
          "outputs": [
            "retrieval_modes"
          ],
          "is_async": true,
          "body_code": "async def step_3_define_retrieval_modes():\n    \"\"\"Auto-generated module\"\"\"\n    retrieval_modes = await invoke_function('define_retrieval_modes')\n    return retrieval_modes",
          "original_block_count": 1
        },
        {
          "name": "step_4_setup_tech_stack",
          "inputs": [
            "java_developers",
            "python_developers"
          ],
          "outputs": [
            "tech_stack"
          ],
          "is_async": true,
          "body_code": "async def step_4_setup_tech_stack(java_developers, python_developers):\n    \"\"\"Auto-generated module\"\"\"\n    tech_stack = await invoke_function('setup_tech_stack', java_developers=java_developers, python_developers=python_developers)\n    return tech_stack",
          "original_block_count": 1
        },
        {
          "name": "step_5_enable_dialogue_support",
          "inputs": [
            "history_context_rounds"
          ],
          "outputs": [
            "dialogue_support"
          ],
          "is_async": true,
          "body_code": "async def step_5_enable_dialogue_support(history_context_rounds):\n    \"\"\"Auto-generated module\"\"\"\n    dialogue_support = await invoke_function('enable_dialogue_support', history_context_rounds=history_context_rounds)\n    return dialogue_support",
          "original_block_count": 1
        },
        {
          "name": "step_6_deploy_to_kubernetes",
          "inputs": [
            "service_count"
          ],
          "outputs": [
            "deployment"
          ],
          "is_async": true,
          "body_code": "async def step_6_deploy_to_kubernetes(service_count):\n    \"\"\"Auto-generated module\"\"\"\n    deployment = await invoke_function('deploy_to_kubernetes', service_count=service_count)\n    return deployment",
          "original_block_count": 1
        },
        {
          "name": "step_7_create_microservices",
          "inputs": [],
          "outputs": [
            "microservices"
          ],
          "is_async": true,
          "body_code": "async def step_7_create_microservices():\n    \"\"\"Auto-generated module\"\"\"\n    microservices = await invoke_function('create_microservices')\n    return microservices",
          "original_block_count": 1
        },
        {
          "name": "step_8_setup_monitoring_logging",
          "inputs": [],
          "outputs": [
            "monitoring_logging"
          ],
          "is_async": true,
          "body_code": "async def step_8_setup_monitoring_logging():\n    \"\"\"Auto-generated module\"\"\"\n    monitoring_logging = await invoke_function('setup_monitoring_logging')\n    return monitoring_logging",
          "original_block_count": 1
        },
        {
          "name": "step_9_enable_bilingual_support",
          "inputs": [
            "supported_languages"
          ],
          "outputs": [
            "bilingual_support"
          ],
          "is_async": true,
          "body_code": "async def step_9_enable_bilingual_support(supported_languages):\n    \"\"\"Auto-generated module\"\"\"\n    bilingual_support = await invoke_function('enable_bilingual_support', supported_languages=supported_languages)\n    return bilingual_support",
          "original_block_count": 1
        },
        {
          "name": "step_10_set_response_time_control",
          "inputs": [
            "response_time_seconds"
          ],
          "outputs": [
            "response_time_control"
          ],
          "is_async": true,
          "body_code": "async def step_10_set_response_time_control(response_time_seconds):\n    \"\"\"Auto-generated module\"\"\"\n    response_time_control = await invoke_function('set_response_time_control', response_time_seconds=response_time_seconds)\n    return response_time_control",
          "original_block_count": 1
        }
      ]
    },
    "prompt40_step5_orchestration": {
      "main_inputs": [
        "history_context_rounds",
        "java_developers",
        "python_developers",
        "response_time_seconds",
        "service_count",
        "supported_languages"
      ],
      "input_count": 6,
      "main_code": "async def main_workflow(input_params: dict):\n    \"\"\"\n    主工作流 - 自动生成\n    \n    Args:\n        input_params: 包含 ['history_context_rounds', 'java_developers', 'python_developers', 'response_time_seconds', 'service_count', 'supported_languages'] 的字典\n    \n    Returns:\n        执行结果上下文\n    \"\"\"\n    # 初始化上下文\n    ctx = input_params.copy()\n\n    # Module 1: step_1_create_application\n    ctx[\"application\"] = await step_1_create_application()\n\n    # Module 2: step_2_design_chain\n    ctx[\"chain_design\"] = await step_2_design_chain()\n\n    # Module 3: step_3_define_retrieval_modes\n    ctx[\"retrieval_modes\"] = await step_3_define_retrieval_modes()\n\n    # Module 4: step_4_setup_tech_stack\n    ctx[\"tech_stack\"] = await step_4_setup_tech_stack(ctx.get(\"java_developers\"), ctx.get(\"python_developers\"))\n\n    # Module 5: step_5_enable_dialogue_support\n    ctx[\"dialogue_support\"] = await step_5_enable_dialogue_support(ctx.get(\"history_context_rounds\"))\n\n    # Module 6: step_6_deploy_to_kubernetes\n    ctx[\"deployment\"] = await step_6_deploy_to_kubernetes(ctx.get(\"service_count\"))\n\n    # Module 7: step_7_create_microservices\n    ctx[\"microservices\"] = await step_7_create_microservices()\n\n    # Module 8: step_8_setup_monitoring_logging\n    ctx[\"monitoring_logging\"] = await step_8_setup_monitoring_logging()\n\n    # Module 9: step_9_enable_bilingual_support\n    ctx[\"bilingual_support\"] = await step_9_enable_bilingual_support(ctx.get(\"supported_languages\"))\n\n    # Module 10: step_10_set_response_time_control\n    ctx[\"response_time_control\"] = await step_10_set_response_time_control(ctx.get(\"response_time_seconds\"))\n\n    return ctx"
    },
    "overall_status": "success",
    "total_time_ms": 18676,
    "error_message": null
  },
  "a9b880b1": {
    "pipeline_id": "a9b880b1",
    "timestamp": "2026-01-28 16:06:04",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "120e47e6",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 819字"
        },
        "duration_ms": 11751,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 11752,
    "prompt20_id": "ff71290f",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{alert_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{alert_duration_for_response_time_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_for_response_time_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "2b219603",
    "prompt30_dsl_code": "",
    "prompt30_validation_result": {},
    "prompt30_time_ms": 36319,
    "prompt40_id": "105be1a1",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 0,
    "prompt40_step1_parsing": {},
    "prompt40_step2_dependency": {},
    "prompt40_step3_clustering": {},
    "prompt40_step4_generation": {},
    "prompt40_step5_orchestration": {},
    "overall_status": "partial",
    "total_time_ms": 48071,
    "error_message": null
  },
  "efe44e07": {
    "pipeline_id": "efe44e07",
    "timestamp": "2026-01-28 17:13:41",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "ac78e3b5",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 814字"
        },
        "duration_ms": 11698,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 11699,
    "prompt20_id": "d882f2b7",
    "prompt20_template": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{vector_similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{alert_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{alert_duration_response_time_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "vector_similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_response_time_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "861507b8",
    "prompt30_dsl_code": "",
    "prompt30_validation_result": {},
    "prompt30_time_ms": 26472,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "total_errors": 31,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 31,
            "total": 31
          }
        },
        {
          "attempt": 2,
          "total_errors": 34,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 34,
            "total": 34
          }
        },
        {
          "attempt": 3,
          "total_errors": 35,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 35,
            "total": 35
          }
        }
      ],
      "final_decision": "failed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 0,
        "p2_count": 35,
        "total": 35
      }
    },
    "prompt30_success": false,
    "prompt40_id": "c442fb99",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 0,
    "prompt40_step1_parsing": {},
    "prompt40_step2_dependency": {},
    "prompt40_step3_clustering": {},
    "prompt40_step4_generation": {},
    "prompt40_step5_orchestration": {},
    "overall_status": "partial",
    "total_time_ms": 38171,
    "error_message": null
  },
  "2df6aae3": {
    "pipeline_id": "2df6aae3",
    "timestamp": "2026-01-28 17:30:33",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "47fc4486",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 818字"
        },
        "duration_ms": 12213,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 12214,
    "prompt20_id": "3e1d8180",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{vector_similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{query_rate_threshold}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{response_time_vector_retrieval}}内完成，图数据库检索在{{response_time_graph_retrieval}}内完成，代码分析在{{response_time_code_analysis}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{alert_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{alert_duration_response_time_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "vector_similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "query_rate_threshold",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_vector_retrieval",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "response_time_graph_retrieval",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "response_time_code_analysis",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_response_time_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "38c0ddff",
    "prompt30_dsl_code": "DEFINE {{vector_similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{query_rate_threshold}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL intent_decomposition({{user_query}})\n    {{results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{user_code}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"unsatisfied\"\n    {{retry}} = CALL enable_stronger_model()\n    IF {{retry_count}} >= 3\n        {{results}} = CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{query_source}} == \"financial\"\n    {{confirmation}} = CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    {{results}} = CALL degrade_service()\nENDIF\n{{log}} = CALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < {{query_rate_threshold}} AND {{duration}} >= 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > {{total_response_time_limit}} AND {{duration}} >= 5\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 22,
          "error_type": "未定义变量",
          "message": "变量 {{query_type}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{query_type}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 23,
          "error_type": "未定义变量",
          "message": "变量 {{user_query}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_query}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 23,
          "error_type": "未定义变量",
          "message": "变量 {{similarity}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{similarity}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 23,
          "error_type": "未定义变量",
          "message": "变量 {{user_query}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_query}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 24,
          "error_type": "未定义变量",
          "message": "变量 {{similarity}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{similarity}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 24,
          "error_type": "类型错误",
          "message": "比较运算 >= 仅支持数字类型，当前为 Any 与 String",
          "suggestion": "将变量类型改为 Integer/Float，或改用 == / !=",
          "severity": "P2"
        },
        {
          "line_number": 25,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 27,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 30,
          "error_type": "未定义变量",
          "message": "变量 {{user_query}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_query}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 30,
          "error_type": "未定义变量",
          "message": "变量 {{intent}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{intent}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 30,
          "error_type": "未定义变量",
          "message": "变量 {{user_query}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_query}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 31,
          "error_type": "未定义变量",
          "message": "变量 {{intent}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{intent}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 31,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 31,
          "error_type": "未定义变量",
          "message": "变量 {{intent}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{intent}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 32,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 33,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 36,
          "error_type": "未定义变量",
          "message": "变量 {{code_lines}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{code_lines}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 37,
          "error_type": "未定义变量",
          "message": "变量 {{user_code}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_code}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 37,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 37,
          "error_type": "未定义变量",
          "message": "变量 {{user_code}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_code}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 39,
          "error_type": "未定义变量",
          "message": "变量 {{user_code}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_code}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 39,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 39,
          "error_type": "未定义变量",
          "message": "变量 {{user_code}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_code}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 42,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 42,
          "error_type": "未定义变量",
          "message": "变量 {{cache}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{cache}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 42,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 43,
          "error_type": "未定义变量",
          "message": "变量 {{user_feedback}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_feedback}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 44,
          "error_type": "未定义变量",
          "message": "变量 {{retry}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{retry}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 45,
          "error_type": "未定义变量",
          "message": "变量 {{retry_count}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{retry_count}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 46,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 49,
          "error_type": "未定义变量",
          "message": "变量 {{query_source}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{query_source}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 50,
          "error_type": "未定义变量",
          "message": "变量 {{confirmation}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{confirmation}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 52,
          "error_type": "未定义变量",
          "message": "变量 {{response_time}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{response_time}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 53,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 55,
          "error_type": "未定义变量",
          "message": "变量 {{log}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{log}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 56,
          "error_type": "未定义变量",
          "message": "变量 {{query_rate}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{query_rate}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 56,
          "error_type": "未定义变量",
          "message": "变量 {{duration}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{duration}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 59,
          "error_type": "未定义变量",
          "message": "变量 {{95th_percentile_response_time}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{95th_percentile_response_time}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 59,
          "error_type": "未定义变量",
          "message": "变量 {{duration}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{duration}}: Type",
          "severity": "P2"
        }
      ],
      "warnings": [],
      "defined_variables": {
        "vector_similarity_threshold": {
          "name": "vector_similarity_threshold",
          "var_type": "String",
          "initial_value": "\"0.85\"",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "graph_exploration_steps": {
          "name": "graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_documents": {
          "name": "knowledge_base_A_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_documents": {
          "name": "knowledge_base_B_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_documents": {
          "name": "knowledge_base_C_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "query_rate_threshold": {
          "name": "query_rate_threshold",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "response_time_vector_retrieval": {
          "name": "response_time_vector_retrieval",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "response_time_graph_retrieval": {
          "name": "response_time_graph_retrieval",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "response_time_code_analysis": {
          "name": "response_time_code_analysis",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "alert_duration_minutes": {
          "name": "alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "alert_duration_response_time_minutes": {
          "name": "alert_duration_response_time_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        }
      },
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "similarity",
          "line_number": 23
        },
        {
          "function_name": "return_top_n_results",
          "arguments": [
            "{{top_n_vector_results}}"
          ],
          "result_var": "results",
          "line_number": 25
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{reordered_top_n_results}}"
          ],
          "result_var": "results",
          "line_number": 27
        },
        {
          "function_name": "intent_decomposition",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "intent",
          "line_number": 30
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{intent}}",
            "{{graph_exploration_steps}}"
          ],
          "result_var": "results",
          "line_number": 31
        },
        {
          "function_name": "full_search",
          "arguments": [],
          "result_var": "results",
          "line_number": 33
        },
        {
          "function_name": "static_analysis",
          "arguments": [
            "{{user_code}}"
          ],
          "result_var": "results",
          "line_number": 37
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{user_code}}"
          ],
          "result_var": "results",
          "line_number": 39
        },
        {
          "function_name": "cache_results",
          "arguments": [
            "{{results}}",
            "{{cache_expiration_time}}"
          ],
          "result_var": "cache",
          "line_number": 42
        },
        {
          "function_name": "enable_stronger_model",
          "arguments": [],
          "result_var": "retry",
          "line_number": 44
        },
        {
          "function_name": "escalate_to_human_review",
          "arguments": [],
          "result_var": "results",
          "line_number": 46
        },
        {
          "function_name": "confirm_user_identity",
          "arguments": [],
          "result_var": "confirmation",
          "line_number": 50
        },
        {
          "function_name": "degrade_service",
          "arguments": [],
          "result_var": "results",
          "line_number": 53
        },
        {
          "function_name": "upload_logs",
          "arguments": [
            "{{error_log_retention_days}}",
            "{{access_log_retention_days}}",
            "{{debug_log_retention_days}}"
          ],
          "result_var": "log",
          "line_number": 55
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 39143,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{query_rate_threshold}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} > {{vector_similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_and_return_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{user_code}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"unsatisfied\"\n    {{retry}} = CALL enable_stronger_reasoning_model()\n    IF {{retry_count}} >= 3\n        {{queue}} = CALL escalate_to_human_review()\n    ENDIF\nENDIF\n{{data_sources}} = CALL configure_data_sources({{knowledge_base_A_documents}}, {{knowledge_base_B_documents}}, {{knowledge_base_C_documents}}, {{vector_dimension}})\nIF {{current_requests}} > {{max_concurrent_requests}}\n    {{queue}} = CALL queue_requests()\nENDIF\n{{filtered_query}} = CALL filter_sensitive_content({{user_query}})\nIF {{filtered_query}} == \"contains_sensitive_content\"\n    CALL reject_service()\n    CALL log_violation()\nENDIF\nIF {{financial_query}} == true\n    {{confirmation}} = CALL confirm_user_identity()\nENDIF\nIF {{response_time_vector_retrieval}} > {{response_time_vector_retrieval}} OR {{response_time_graph_retrieval}} > {{response_time_graph_retrieval}} OR {{response_time_code_analysis}} > {{response_time_code_analysis}} OR {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < {{query_rate_threshold}} AND {{duration}} >= 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > {{total_response_time_limit}} AND {{duration}} >= 5\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 45,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 45,
            "total": 45
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{query_rate_threshold}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} > {{vector_similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = CALL get_code_lines({{user_query}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_result}} = CALL static_analysis({{user_query}})\n    ELSE\n        {{analysis_result}} = CALL semantic_analysis({{user_query}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{new_results}} = CALL stronger_reasoning_model({{user_query}})\n    IF {{user_feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\n{{knowledge_base_A}} = {{knowledge_base_A_documents}}\n{{knowledge_base_B}} = {{knowledge_base_B_documents}}\n{{knowledge_base_C}} = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_query}})\n    CALL reject_service()\n    CALL log_violation()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < {{query_rate_threshold}} AND {{duration}} >= 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > {{total_response_time_limit}} AND {{duration}} >= 5\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 44,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 44,
            "total": 44
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{query_rate_threshold}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL intent_decomposition({{user_query}})\n    {{results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{user_code}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"unsatisfied\"\n    {{retry}} = CALL enable_stronger_model()\n    IF {{retry_count}} >= 3\n        {{results}} = CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{query_source}} == \"financial\"\n    {{confirmation}} = CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    {{results}} = CALL degrade_service()\nENDIF\n{{log}} = CALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < {{query_rate_threshold}} AND {{duration}} >= 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > {{total_response_time_limit}} AND {{duration}} >= 5\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 39,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 39,
            "total": 39
          }
        }
      ],
      "final_decision": "failed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 0,
        "p2_count": 39,
        "total": 39
      },
      "auto_fix_applied": true
    },
    "prompt30_success": false,
    "prompt40_id": "3539c2ba",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 0,
    "prompt40_step1_parsing": {},
    "prompt40_step2_dependency": {},
    "prompt40_step3_clustering": {},
    "prompt40_step4_generation": {},
    "prompt40_step5_orchestration": {},
    "overall_status": "partial",
    "total_time_ms": 51357,
    "error_message": null
  },
  "a1815b98": {
    "pipeline_id": "a1815b98",
    "timestamp": "2026-01-28 19:08:25",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "5a53cc3f",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 839字"
        },
        "duration_ms": 11774,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 11775,
    "prompt20_id": "0830cff6",
    "prompt20_template": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_search}}；否则结合重排序模型重新评分，再返回{{top_n_reordered_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行{{knowledge_graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引(VI)，向量维度统一为{{vector_index_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{qps_threshold_alert}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{response_time_vector_search}}内完成，图数据库检索在{{response_time_graph_database}}内完成，代码分析在{{response_time_code_analysis}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续{{alert_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{alert_duration_response_time_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_search",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "top_n_reordered_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "knowledge_graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_index_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "qps_threshold_alert",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_vector_search",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "response_time_graph_database",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "response_time_code_analysis",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_response_time_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "3ca3f55b",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_index_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{qps_threshold_alert}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_database}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{user_query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_search({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{user_code}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{results}} = CALL stronger_reasoning_model({{user_query}})\n    IF {{user_feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\n{{knowledge_base_A}} = {{knowledge_base_A_documents}}\n{{knowledge_base_B}} = {{knowledge_base_B_documents}}\n{{knowledge_base_C}} = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_requests()\nENDIF\nIF {{contains_sensitive_words}} == TRUE\n    CALL reject_service()\n    CALL log_violation()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time_vector_search}} > {{response_time_vector_search}} OR \n   {{response_time_graph_database}} > {{response_time_graph_database}} OR \n   {{response_time_code_analysis}} > {{response_time_code_analysis}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < {{qps_threshold_alert}} AND {{duration}} >= {{alert_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > {{total_response_time_limit}} AND {{duration}} >= {{alert_duration_response_time_minutes}}\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 22,
          "error_type": "未定义变量",
          "message": "变量 {{query_type}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{query_type}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 23,
          "error_type": "未定义变量",
          "message": "变量 {{user_query}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_query}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 23,
          "error_type": "未定义变量",
          "message": "变量 {{similarity}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{similarity}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 23,
          "error_type": "未定义变量",
          "message": "变量 {{user_query}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_query}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 24,
          "error_type": "未定义变量",
          "message": "变量 {{similarity}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{similarity}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 24,
          "error_type": "类型错误",
          "message": "比较运算 >= 仅支持数字类型，当前为 Any 与 String",
          "suggestion": "将变量类型改为 Integer/Float，或改用 == / !=",
          "severity": "P2"
        },
        {
          "line_number": 25,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 27,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 30,
          "error_type": "未定义变量",
          "message": "变量 {{user_query}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_query}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 30,
          "error_type": "未定义变量",
          "message": "变量 {{intent}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{intent}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 30,
          "error_type": "未定义变量",
          "message": "变量 {{user_query}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_query}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 31,
          "error_type": "未定义变量",
          "message": "变量 {{intent}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{intent}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 31,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 31,
          "error_type": "未定义变量",
          "message": "变量 {{intent}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{intent}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 32,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 33,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 36,
          "error_type": "未定义变量",
          "message": "变量 {{code_lines}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{code_lines}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 37,
          "error_type": "未定义变量",
          "message": "变量 {{user_code}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_code}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 37,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 37,
          "error_type": "未定义变量",
          "message": "变量 {{user_code}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_code}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 39,
          "error_type": "未定义变量",
          "message": "变量 {{user_code}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_code}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 39,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 39,
          "error_type": "未定义变量",
          "message": "变量 {{user_code}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_code}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 42,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 42,
          "error_type": "未定义变量",
          "message": "变量 {{cache}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{cache}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 42,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 43,
          "error_type": "未定义变量",
          "message": "变量 {{user_feedback}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_feedback}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 44,
          "error_type": "未定义变量",
          "message": "变量 {{user_query}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_query}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 44,
          "error_type": "未定义变量",
          "message": "变量 {{results}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{results}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 44,
          "error_type": "未定义变量",
          "message": "变量 {{user_query}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_query}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 45,
          "error_type": "未定义变量",
          "message": "变量 {{user_feedback_count}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{user_feedback_count}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 49,
          "error_type": "未定义变量",
          "message": "变量 {{knowledge_base_A}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{knowledge_base_A}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 50,
          "error_type": "未定义变量",
          "message": "变量 {{knowledge_base_B}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{knowledge_base_B}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 51,
          "error_type": "未定义变量",
          "message": "变量 {{knowledge_base_C}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{knowledge_base_C}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 52,
          "error_type": "未定义变量",
          "message": "变量 {{current_requests}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{current_requests}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 55,
          "error_type": "未定义变量",
          "message": "变量 {{contains_sensitive_words}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{contains_sensitive_words}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 59,
          "error_type": "未定义变量",
          "message": "变量 {{query_type}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{query_type}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 69,
          "error_type": "未定义变量",
          "message": "变量 {{qps}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{qps}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 69,
          "error_type": "未定义变量",
          "message": "变量 {{duration}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{duration}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 69,
          "error_type": "类型错误",
          "message": "比较运算 < 仅支持数字类型，当前为 Any 与 Dict",
          "suggestion": "将变量类型改为 Integer/Float，或改用 == / !=",
          "severity": "P2"
        },
        {
          "line_number": 72,
          "error_type": "未定义变量",
          "message": "变量 {{95th_percentile_response_time}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{95th_percentile_response_time}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 72,
          "error_type": "未定义变量",
          "message": "变量 {{duration}} 在使用前未定义",
          "suggestion": "在代码开头添加: DEFINE {{duration}}: Type",
          "severity": "P2"
        },
        {
          "line_number": 72,
          "error_type": "类型错误",
          "message": "比较运算 > 仅支持数字类型，当前为 Any 与 Dict",
          "suggestion": "将变量类型改为 Integer/Float，或改用 == / !=",
          "severity": "P2"
        }
      ],
      "warnings": [],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "\"0.85\"",
          "line_number": 1
        },
        "top_n_vector_search": {
          "name": "top_n_vector_search",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "top_n_reordered_results": {
          "name": "top_n_reordered_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "knowledge_graph_exploration_steps": {
          "name": "knowledge_graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_documents": {
          "name": "knowledge_base_A_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_documents": {
          "name": "knowledge_base_B_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_documents": {
          "name": "knowledge_base_C_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_index_dimension": {
          "name": "vector_index_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "qps_threshold_alert": {
          "name": "qps_threshold_alert",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "response_time_vector_search": {
          "name": "response_time_vector_search",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "response_time_graph_database": {
          "name": "response_time_graph_database",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "response_time_code_analysis": {
          "name": "response_time_code_analysis",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "alert_duration_minutes": {
          "name": "alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "alert_duration_response_time_minutes": {
          "name": "alert_duration_response_time_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        }
      },
      "function_calls": [
        {
          "function_name": "vector_search",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "similarity",
          "line_number": 23
        },
        {
          "function_name": "return_top_n_results",
          "arguments": [
            "{{top_n_vector_search}}"
          ],
          "result_var": "results",
          "line_number": 25
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{top_n_reordered_results}}"
          ],
          "result_var": "results",
          "line_number": 27
        },
        {
          "function_name": "decompose_intent",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "intent",
          "line_number": 30
        },
        {
          "function_name": "graph_database_search",
          "arguments": [
            "{{intent}}",
            "{{knowledge_graph_exploration_steps}}"
          ],
          "result_var": "results",
          "line_number": 31
        },
        {
          "function_name": "full_search",
          "arguments": [],
          "result_var": "results",
          "line_number": 33
        },
        {
          "function_name": "static_analysis",
          "arguments": [
            "{{user_code}}"
          ],
          "result_var": "results",
          "line_number": 37
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{user_code}}"
          ],
          "result_var": "results",
          "line_number": 39
        },
        {
          "function_name": "cache_results",
          "arguments": [
            "{{results}}",
            "{{cache_expiration_time}}"
          ],
          "result_var": "cache",
          "line_number": 42
        },
        {
          "function_name": "stronger_reasoning_model",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "results",
          "line_number": 44
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 35971,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_index_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{qps_threshold_alert}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_database}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nIF {{query_type}} == \"简单事实查询\"\n    {{similarity}} = CALL vector_search({{user_query}})\n    IF {{similarity}} > {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"复杂推理查询\"\n    {{intent}} = CALL intent_decomposition({{user_query}})\n    {{results}} = CALL graph_database_search({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} == \"无匹配\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"代码相关问题\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{user_code}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"不满意\"\n    {{regenerate}} = CALL enable_stronger_model()\n    IF {{regenerate_count}} >= 3\n        {{queue}} = CALL escalate_to_human_review()\n    ENDIF\nENDIF\n{{data_sources}} = CALL configure_data_sources({{knowledge_base_A_documents}}, {{knowledge_base_B_documents}}, {{knowledge_base_C_documents}}, {{vector_index_dimension}})\nIF {{current_requests}} > {{max_concurrent_requests}}\n    {{queue}} = CALL queue_requests()\nENDIF\n{{filtered_query}} = CALL filter_sensitive_words({{user_query}})\nIF {{filtered_query}} == \"违规内容\"\n    CALL reject_service()\n    CALL log_error()\nENDIF\nIF {{query_type}} == \"金融类查询\"\n    {{identity_confirmation}} = CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < {{qps_threshold_alert}} AND {{duration}} >= {{alert_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > {{total_response_time_limit}} AND {{duration}} >= {{alert_duration_response_time_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 46,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 46,
            "total": 46
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_index_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{qps_threshold_alert}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_database}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{user_query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_search({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{user_code}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{results}} = CALL stronger_reasoning_model({{user_query}})\n    IF {{user_feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\n{{knowledge_base_A}} = {{knowledge_base_A_documents}}\n{{knowledge_base_B}} = {{knowledge_base_B_documents}}\n{{knowledge_base_C}} = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{contains_sensitive_words}} == TRUE\n    CALL reject_service()\n    CALL log_violation()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < {{qps_threshold_alert}} AND {{duration}} >= 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > {{total_response_time_limit}} AND {{duration}} >= 5\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 42,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 42,
            "total": 42
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_index_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{qps_threshold_alert}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_database}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{user_query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_search({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{user_code}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{results}} = CALL stronger_reasoning_model({{user_query}})\n    IF {{user_feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\n{{knowledge_base_A}} = {{knowledge_base_A_documents}}\n{{knowledge_base_B}} = {{knowledge_base_B_documents}}\n{{knowledge_base_C}} = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_requests()\nENDIF\nIF {{contains_sensitive_words}} == TRUE\n    CALL reject_service()\n    CALL log_violation()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time_vector_search}} > {{response_time_vector_search}} OR \n   {{response_time_graph_database}} > {{response_time_graph_database}} OR \n   {{response_time_code_analysis}} > {{response_time_code_analysis}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < {{qps_threshold_alert}} AND {{duration}} >= {{alert_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > {{total_response_time_limit}} AND {{duration}} >= {{alert_duration_response_time_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 43,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 43,
            "total": 43
          }
        }
      ],
      "final_decision": "failed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 0,
        "p2_count": 43,
        "total": 43
      },
      "auto_fix_applied": true
    },
    "prompt30_success": false,
    "prompt40_id": "5aa4b4d5",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 0,
    "prompt40_step1_parsing": {},
    "prompt40_step2_dependency": {},
    "prompt40_step3_clustering": {},
    "prompt40_step4_generation": {},
    "prompt40_step5_orchestration": {},
    "overall_status": "partial",
    "total_time_ms": 47746,
    "error_message": null
  },
  "761dbd36": {
    "pipeline_id": "761dbd36",
    "timestamp": "2026-01-29 12:57:21",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "6cf800ec",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 818字"
        },
        "duration_ms": 14321,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 14322,
    "prompt20_id": "0da4b416",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{vector_similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{query_rate_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{response_time_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "vector_similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "query_rate_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "cc20b81a",
    "prompt30_dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nIF {{query_type}} == \"简单事实查询\"\n    {{similarity}} = CALL vector_retrieval({{query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        RETURN CALL reorder_and_return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"复杂推理查询\"\n    CALL intent_decomposition({{query}})\n    {{results}} = CALL graph_database_retrieval({{graph_exploration_steps}})\n    IF {{results}} IS NOT EMPTY\n        RETURN {{results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"代码相关问题\"\n    DEFINE {{code_lines}} = CALL count_code_lines({{code}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{code}})\n    ELSE\n        RETURN CALL semantic_analysis_and_generate_document({{code}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"不满意\"\n    CALL enable_stronger_reasoning_model()\n    IF {{consecutive_unsatisfied_feedback}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_documents}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_documents}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{query}})\n    CALL reject_service_and_log()\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 AND {{duration}} >= {{query_rate_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > {{total_response_time_limit}} AND {{duration}} >= {{response_time_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 39,
          "error_type": "语法错误",
          "message": "DEFINE 语句格式错误",
          "suggestion": "正确格式: DEFINE {{var_name}}: Type [= value]",
          "severity": "P2"
        },
        {
          "line_number": 41,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 43,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        }
      ],
      "warnings": [
        "运行时变量 'query_type' 未预定义（将在运行时动态创建）",
        "运行时变量 'query' 未预定义（将在运行时动态创建）",
        "运行时变量 'similarity' 首次赋值（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback' 未预定义（将在运行时动态创建）",
        "运行时变量 'consecutive_unsatisfied_feedback' 未预定义（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'current_requests' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'query_rate' 未预定义（将在运行时动态创建）",
        "运行时变量 'duration' 未预定义（将在运行时动态创建）",
        "比较运算 < 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 '95th_percentile_response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确"
      ],
      "defined_variables": {
        "vector_similarity_threshold": {
          "name": "vector_similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "graph_exploration_steps": {
          "name": "graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_documents": {
          "name": "knowledge_base_A_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_documents": {
          "name": "knowledge_base_B_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_documents": {
          "name": "knowledge_base_C_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time": {
          "name": "vector_retrieval_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "query_rate_duration_minutes": {
          "name": "query_rate_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "response_time_duration_minutes": {
          "name": "response_time_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "code_lines": {
          "name": "code_lines",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 22
        },
        "knowledge_base_A": {
          "name": "knowledge_base_A",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_A_documents}}",
          "line_number": 52
        },
        "knowledge_base_B": {
          "name": "knowledge_base_B",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_B_documents}}",
          "line_number": 53
        },
        "knowledge_base_C": {
          "name": "knowledge_base_C",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_C_documents}}",
          "line_number": 54
        }
      },
      "runtime_variables": [
        "95th_percentile_response_time",
        "results",
        "query_rate",
        "user_feedback",
        "query",
        "consecutive_unsatisfied_feedback",
        "duration",
        "query_type",
        "similarity",
        "current_requests"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "similarity",
          "line_number": 24
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{graph_exploration_steps}}"
          ],
          "result_var": "results",
          "line_number": 32
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 28023,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{user_code}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"not_satisfied\"\n    {{retry_results}} = CALL stronger_reasoning_model()\n    IF {{retry_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\n{{knowledge_base_A}} = {{knowledge_base_A_documents}}\n{{knowledge_base_B}} = {{knowledge_base_B_documents}}\n{{knowledge_base_C}} = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL detect_sensitive_content({{user_query}})\n    CALL reject_service()\n    CALL log_violation()\nENDIF\nIF {{vector_retrieval_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 AND {{duration}} >= {{query_rate_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{response_time_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 4,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 4,
            "p2_count": 0,
            "total": 4
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nDEFINE {{user_query_type}}: String\nDEFINE {{user_feedback}}: String\nDEFINE {{user_identity_verified}}: Boolean\nDEFINE {{query_rate}}: Integer\nDEFINE {{response_time}}: Integer\nIF {{user_query_type}} == \"简单事实查询\"\n    {{similarity}} = CALL vector_retrieval()\n    IF {{similarity}} > {{vector_similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{user_query_type}} == \"复杂推理查询\"\n    CALL intent_decomposition()\n    {{results}} = CALL graph_database_retrieval({{graph_exploration_steps}})\n    IF {{results}} == \"无匹配\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{user_query_type}} == \"代码相关问题\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis()\n    ELSE\n        {{results}} = CALL semantic_analysis()\n    ENDIF\nENDIF\nCALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"不满意\"\n    CALL regenerate_response()\n    IF {{feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs()",
          "total_errors": 1,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 1,
            "p2_count": 0,
            "total": 1
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nIF {{query_type}} == \"简单事实查询\"\n    {{similarity}} = CALL vector_retrieval({{query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        RETURN CALL reorder_and_return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"复杂推理查询\"\n    CALL intent_decomposition({{query}})\n    {{results}} = CALL graph_database_retrieval({{graph_exploration_steps}})\n    IF {{results}} IS NOT EMPTY\n        RETURN {{results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"代码相关问题\"\n    DEFINE {{code_lines}} = CALL count_code_lines({{code}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{code}})\n    ELSE\n        RETURN CALL semantic_analysis_and_generate_document({{code}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"不满意\"\n    CALL enable_stronger_reasoning_model()\n    IF {{consecutive_unsatisfied_feedback}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_documents}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_documents}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{query}})\n    CALL reject_service_and_log()\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 AND {{duration}} >= {{query_rate_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > {{total_response_time_limit}} AND {{duration}} >= {{response_time_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 3,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 1,
            "total": 3
          }
        }
      ],
      "final_decision": "partial_auto_fixed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 2,
        "p2_count": 1,
        "total": 3
      },
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "9f3e0006",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 10,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 11 个错误：\n  ❌ step_2_process: 语法错误 - invalid syntax (行 3)\n  ❌ step_3_graph_database_retrieval: 语法错误 - invalid syntax (行 3)\n  ❌ step_4_process: 语法错误 - invalid syntax (行 3)\n  ❌ step_5_compute_query_type: 语法错误 - invalid syntax (行 3)\n  ❌ step_7_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_9_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_10_process: 语法错误 - invalid syntax (行 3)\n  ❌ step_11_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_12_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_13_process: 语法错误 - invalid decimal literal (行 1)\n  ❌ step_14_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "partial",
    "total_time_ms": 42355,
    "error_message": null
  },
  "248fb470": {
    "pipeline_id": "248fb470",
    "timestamp": "2026-01-29 13:24:09",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "093527d4",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 840字"
        },
        "duration_ms": 12034,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 12035,
    "prompt20_id": "7b0c958a",
    "prompt20_template": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_search}}；否则结合重排序模型重新评分，再返回{{top_n_reordered_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行{{knowledge_graph_hops}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为{{cache_expiration}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_a_documents}}，知识库B包含{{knowledge_base_b_documents}}，知识库C包含{{knowledge_base_c_documents}}。每个知识库都有独立的向量索引(VI)，向量维度统一为{{vector_index_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_search_timeout}}内完成，图数据库检索在{{graph_search_timeout}}内完成，代码分析在{{code_analysis_timeout}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续{{low_qps_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{high_response_time_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_search",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "top_n_reordered_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "knowledge_graph_hops",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_a_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_b_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_c_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_index_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_search_timeout",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_search_timeout",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_timeout",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "low_qps_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "high_response_time_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "abb2b0b5",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_hops}}: Integer = 2\nDEFINE {{cache_expiration}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_a_documents}}: Integer = 2000\nDEFINE {{knowledge_base_b_documents}}: Integer = 3000\nDEFINE {{knowledge_base_c_documents}}: Integer = 1500\nDEFINE {{vector_index_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_search_timeout}}: Integer = 500\nDEFINE {{graph_search_timeout}}: Integer = 1\nDEFINE {{code_analysis_timeout}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_qps_duration_minutes}}: Integer = 10\nDEFINE {{high_response_time_duration_minutes}}: Integer = 5\nDEFINE {{query_type}}: String\nDEFINE {{code_lines}}: Integer\nDEFINE {{code_snippet}}: String\nDEFINE {{user_feedback}}: String\nDEFINE {{user_priority}}: Integer\nDEFINE {{response_time}}: Integer\nDEFINE {{result}}: Any\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{query}})\n    IF {{similarity}} > {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{query}})\n    {{graph_results}} = CALL graph_database_search({{knowledge_graph_hops}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{code_snippet}})\n    ELSE\n        RETURN CALL semantic_analysis({{code_snippet}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL stronger_reasoning_model()\nENDIF\nIF {{user_feedback}} == \"not_satisfied\"\n    {{satisfaction_count}} = {{satisfaction_count}} + 1\n    IF {{satisfaction_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_base_a}}: Integer = {{knowledge_base_a_documents}}\nDEFINE {{knowledge_base_b}}: Integer = {{knowledge_base_b_documents}}\nDEFINE {{knowledge_base_c}}: Integer = {{knowledge_base_c_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL check_sensitive_words({{query}})\n    RETURN CALL reject_service()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [
        "运行时变量 'query' 未预定义（将在运行时动态创建）",
        "运行时变量 'similarity' 首次赋值（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'reordered_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'graph_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'satisfaction_count' 首次赋值（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'current_requests' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'qps' 未预定义（将在运行时动态创建）",
        "比较运算 < 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 '95th_percentile_response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确"
      ],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "\"0.85\"",
          "line_number": 1
        },
        "top_n_vector_search": {
          "name": "top_n_vector_search",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "top_n_reordered_results": {
          "name": "top_n_reordered_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "knowledge_graph_hops": {
          "name": "knowledge_graph_hops",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration": {
          "name": "cache_expiration",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_a_documents": {
          "name": "knowledge_base_a_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_b_documents": {
          "name": "knowledge_base_b_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_c_documents": {
          "name": "knowledge_base_c_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_index_dimension": {
          "name": "vector_index_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_search_timeout": {
          "name": "vector_search_timeout",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_search_timeout": {
          "name": "graph_search_timeout",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_timeout": {
          "name": "code_analysis_timeout",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "low_qps_duration_minutes": {
          "name": "low_qps_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "high_response_time_duration_minutes": {
          "name": "high_response_time_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "query_type": {
          "name": "query_type",
          "var_type": "String",
          "initial_value": null,
          "line_number": 22
        },
        "code_lines": {
          "name": "code_lines",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 23
        },
        "code_snippet": {
          "name": "code_snippet",
          "var_type": "String",
          "initial_value": null,
          "line_number": 24
        },
        "user_feedback": {
          "name": "user_feedback",
          "var_type": "String",
          "initial_value": null,
          "line_number": 25
        },
        "user_priority": {
          "name": "user_priority",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 26
        },
        "response_time": {
          "name": "response_time",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 27
        },
        "result": {
          "name": "result",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 28
        },
        "knowledge_base_a": {
          "name": "knowledge_base_a",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_a_documents}}",
          "line_number": 61
        },
        "knowledge_base_b": {
          "name": "knowledge_base_b",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_b_documents}}",
          "line_number": 62
        },
        "knowledge_base_c": {
          "name": "knowledge_base_c",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_c_documents}}",
          "line_number": 63
        }
      },
      "runtime_variables": [
        "satisfaction_count",
        "qps",
        "current_requests",
        "query",
        "95th_percentile_response_time",
        "graph_results",
        "similarity",
        "reordered_results"
      ],
      "function_calls": [
        {
          "function_name": "vector_search",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "similarity",
          "line_number": 30
        },
        {
          "function_name": "reorder_results",
          "arguments": [],
          "result_var": "reordered_results",
          "line_number": 34
        },
        {
          "function_name": "graph_database_search",
          "arguments": [
            "{{knowledge_graph_hops}}"
          ],
          "result_var": "graph_results",
          "line_number": 39
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 28321,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_hops}}: Integer = 2\nDEFINE {{cache_expiration}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_a_documents}}: Integer = 2000\nDEFINE {{knowledge_base_b_documents}}: Integer = 3000\nDEFINE {{knowledge_base_c_documents}}: Integer = 1500\nDEFINE {{vector_index_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_search_timeout}}: Integer = 500\nDEFINE {{graph_search_timeout}}: Integer = 1\nDEFINE {{code_analysis_timeout}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_qps_duration_minutes}}: Integer = 10\nDEFINE {{high_response_time_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{results}} = CALL vector_search({{user_query}})\n    IF {{results.similarity}} > {{similarity_threshold}}\n        RETURN {{results.top_n}} = {{top_n_vector_search}}\n    ELSE\n        {{results}} = CALL reorder_results({{results}})\n        RETURN {{results.top_n}} = {{top_n_reordered_results}}\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_search({{intent}}, {{knowledge_graph_hops}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search({{user_query}})\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{code_snippet}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{code_snippet}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration}})\nIF {{user_feedback}} == \"regenerate\"\n    {{results}} = CALL stronger_reasoning_model({{user_query}})\n    IF {{user_feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_base_a}}: Integer = {{knowledge_base_a_documents}}\nDEFINE {{knowledge_base_b}}: Integer = {{knowledge_base_b_documents}}\nDEFINE {{knowledge_base_c}}: Integer = {{knowledge_base_c_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_query}})\nENDIF\nIF CALL check_sensitive_words({{user_query}}) == \"detected\"\n    CALL reject_service()\n    CALL log_violation({{user_query}})\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 AND {{duration}} >= {{low_qps_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{high_response_time_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 6,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 6,
            "p2_count": 0,
            "total": 6
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_hops}}: Integer = 2\nDEFINE {{cache_expiration}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_a_documents}}: Integer = 2000\nDEFINE {{knowledge_base_b_documents}}: Integer = 3000\nDEFINE {{knowledge_base_c_documents}}: Integer = 1500\nDEFINE {{vector_index_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_search_timeout}}: Integer = 500\nDEFINE {{graph_search_timeout}}: Integer = 1\nDEFINE {{code_analysis_timeout}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_qps_duration_minutes}}: Integer = 10\nDEFINE {{high_response_time_duration_minutes}}: Integer = 5\nDEFINE {{query_type}}: String\nDEFINE {{code_lines}}: Integer\nDEFINE {{code_snippet}}: String\nDEFINE {{user_feedback}}: String\nDEFINE {{user_priority}}: Integer\nDEFINE {{response_time}}: Integer\nDEFINE {{result}}: Any\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{query}})\n    IF {{similarity}} > {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{query}})\n    {{graph_results}} = CALL graph_database_search({{knowledge_graph_hops}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{code_snippet}})\n    ELSE\n        RETURN CALL semantic_analysis({{code_snippet}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL stronger_reasoning_model()\nENDIF\nIF {{user_feedback}} == \"not_satisfied\"\n    {{satisfaction_count}} = {{satisfaction_count}} + 1\n    IF {{satisfaction_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_base_a}}: Integer = {{knowledge_base_a_documents}}\nDEFINE {{knowledge_base_b}}: Integer = {{knowledge_base_b_documents}}\nDEFINE {{knowledge_base_c}}: Integer = {{knowledge_base_c_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL check_sensitive_words({{query}})\n    RETURN CALL reject_service()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 0,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 0,
            "total": 0
          }
        }
      ],
      "final_decision": "success",
      "error_summary": {},
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "a142152e",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 9,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 11 个错误：\n  ❌ step_2_reorder_results: 语法错误 - invalid syntax (行 3)\n  ❌ step_4_graph_database_search: 语法错误 - invalid syntax (行 3)\n  ❌ step_5_process: 语法错误 - invalid syntax (行 3)\n  ❌ step_6_compute_query_type: 语法错误 - invalid syntax (行 3)\n  ❌ step_8_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_11_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_12_process: 语法错误 - invalid syntax (行 3)\n  ❌ step_14_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_15_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_16_process: 语法错误 - invalid decimal literal (行 1)\n  ❌ step_17_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "success",
    "total_time_ms": 40365,
    "error_message": null
  },
  "e2079492": {
    "pipeline_id": "e2079492",
    "timestamp": "2026-01-29 13:43:37",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "baa092bf",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 819字"
        },
        "duration_ms": 8520,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 8521,
    "prompt20_id": "359dc17b",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_search}}；否则结合重排序模型重新评分，再返回{{top_n_reordered_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{knowledge_graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_a_documents}}，知识库B包含{{knowledge_base_b_documents}}，知识库C包含{{knowledge_base_c_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_search_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{alert_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{alert_duration_response_time_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_search",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "top_n_reordered_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "knowledge_graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_a_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_b_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_c_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_search_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_response_time_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "9bb546ac",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_a_documents}}: Integer = 2000\nDEFINE {{knowledge_base_b_documents}}: Integer = 3000\nDEFINE {{knowledge_base_c_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_search_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{user_query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_search({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = CALL get_code_lines({{user_query}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_result}} = CALL static_analysis({{user_query}})\n    ELSE\n        {{analysis_result}} = CALL semantic_analysis({{user_query}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"unsatisfied\"\n    {{regenerate}} = CALL enable_stronger_model()\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{query_content}} == \"sensitive\"\n    CALL reject_service()\n    CALL log_error()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_search_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs()",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [
        "运行时变量 'query_type' 未预定义（将在运行时动态创建）",
        "运行时变量 'user_query' 未预定义（将在运行时动态创建）",
        "运行时变量 'similarity' 首次赋值（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'intent' 首次赋值（将在运行时动态创建）",
        "运行时变量 'analysis_result' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback' 未预定义（将在运行时动态创建）",
        "运行时变量 'regenerate' 首次赋值（将在运行时动态创建）",
        "运行时变量 'unsatisfied_count' 未预定义（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'cache' 首次赋值（将在运行时动态创建）",
        "运行时变量 'current_requests' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'query_content' 未预定义（将在运行时动态创建）"
      ],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_search": {
          "name": "top_n_vector_search",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "top_n_reordered_results": {
          "name": "top_n_reordered_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "knowledge_graph_exploration_steps": {
          "name": "knowledge_graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_a_documents": {
          "name": "knowledge_base_a_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_b_documents": {
          "name": "knowledge_base_b_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_c_documents": {
          "name": "knowledge_base_c_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_search_response_time": {
          "name": "vector_search_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "alert_duration_minutes": {
          "name": "alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "alert_duration_response_time_minutes": {
          "name": "alert_duration_response_time_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "code_lines": {
          "name": "code_lines",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 22
        }
      },
      "runtime_variables": [
        "user_query",
        "user_feedback",
        "results",
        "current_requests",
        "unsatisfied_count",
        "intent",
        "query_content",
        "query_type",
        "cache",
        "analysis_result",
        "regenerate",
        "similarity"
      ],
      "function_calls": [
        {
          "function_name": "vector_search",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "similarity",
          "line_number": 24
        },
        {
          "function_name": "return_top_n_results",
          "arguments": [
            "{{top_n_vector_search}}"
          ],
          "result_var": "results",
          "line_number": 26
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{top_n_reordered_results}}"
          ],
          "result_var": "results",
          "line_number": 28
        },
        {
          "function_name": "decompose_intent",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "intent",
          "line_number": 31
        },
        {
          "function_name": "graph_database_search",
          "arguments": [
            "{{intent}}",
            "{{knowledge_graph_exploration_steps}}"
          ],
          "result_var": "results",
          "line_number": 32
        },
        {
          "function_name": "full_search",
          "arguments": [],
          "result_var": "results",
          "line_number": 34
        },
        {
          "function_name": "get_code_lines",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "code_lines",
          "line_number": 37
        },
        {
          "function_name": "static_analysis",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "analysis_result",
          "line_number": 39
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "analysis_result",
          "line_number": 41
        },
        {
          "function_name": "enable_stronger_model",
          "arguments": [],
          "result_var": "regenerate",
          "line_number": 45
        },
        {
          "function_name": "cache_results",
          "arguments": [
            "{{results}}",
            "{{cache_expiration_time}}"
          ],
          "result_var": "cache",
          "line_number": 50
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 17601,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_a_documents}}: Integer = 2000\nDEFINE {{knowledge_base_b_documents}}: Integer = 3000\nDEFINE {{knowledge_base_c_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_search_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{user_query}})\n    IF {{similarity}} > {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_and_return_top_n_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_search({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{user_code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"unsatisfied\"\n    {{regenerate_results}} = CALL stronger_reasoning_model()\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 1,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 1,
            "p2_count": 0,
            "total": 1
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_a_documents}}: Integer = 2000\nDEFINE {{knowledge_base_b_documents}}: Integer = 3000\nDEFINE {{knowledge_base_c_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_search_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{user_query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_search({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = CALL get_code_lines({{user_query}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_result}} = CALL static_analysis({{user_query}})\n    ELSE\n        {{analysis_result}} = CALL semantic_analysis({{user_query}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"unsatisfied\"\n    {{regenerate}} = CALL enable_stronger_model()\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{query_content}} == \"sensitive\"\n    CALL reject_service()\n    CALL log_error()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_search_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs()",
          "total_errors": 0,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 0,
            "total": 0
          }
        }
      ],
      "final_decision": "success",
      "error_summary": {},
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "767d23a1",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 7,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 9 个错误：\n  ❌ step_3_reorder_results: 语法错误 - invalid syntax (行 3)\n  ❌ step_5_decompose_intent: 语法错误 - invalid syntax (行 3)\n  ❌ step_8_get_code_lines: 语法错误 - invalid syntax (行 3)\n  ❌ step_10_semantic_analysis: 语法错误 - invalid syntax (行 3)\n  ❌ step_13_enable_stronger_model: 语法错误 - expected an indented block after 'if' statement on line 5 (行 6)\n  ❌ step_15_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_16_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_18_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_19_graph_database_search: 语法错误 - expected an indented block after 'if' statement on line 7 (行 8)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "success",
    "total_time_ms": 26129,
    "error_message": null
  },
  "68571725": {
    "pipeline_id": "68571725",
    "timestamp": "2026-01-29 13:44:48",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "a100d639",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 819字"
        },
        "duration_ms": 8713,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 8714,
    "prompt20_id": "4aea3504",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{alert_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{alert_duration_response_time_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_response_time_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "60657803",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nDEFINE {{knowledge_base_A}}: Dict\nDEFINE {{knowledge_base_B}}: Dict\nDEFINE {{knowledge_base_C}}: Dict\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{query}})\n    IF {{vector_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_results.top_n}}[0:{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results}}[0:{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposed}} = CALL decompose_intent({{query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposed}}, {{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{code}})\n        {{explanation}} = CALL generate_explanation({{analysis_results}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{query}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{query}})\nENDIF\n{{knowledge_base_A}} = CALL configure_knowledge_base(\"A\", {{knowledge_base_A_documents}}, {{vector_dimension}})\n{{knowledge_base_B}} = CALL configure_knowledge_base(\"B\", {{knowledge_base_B_documents}}, {{vector_dimension}})\n{{knowledge_base_C}} = CALL configure_knowledge_base(\"C\", {{knowledge_base_C_documents}}, {{vector_dimension}})\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{query}})\nENDIF\n{{filtered_query}} = CALL filter_sensitive_words({{query}})\nIF {{filtered_query}} IS NOT VALID\n    CALL log_error(\"Sensitive content detected\")\n    RETURN \"Service denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{user_identity_confirmed}} = CALL confirm_user_identity({{user_id}})\n    IF NOT {{user_identity_confirmed}}\n        RETURN \"Identity confirmation required\"\n    ENDIF\nENDIF\nIF {{vector_retrieval_time}} > {{vector_retrieval_response_time}} OR {{graph_database_time}} > {{graph_database_response_time}} OR {{code_analysis_time}} > {{code_analysis_response_time}}\n    CALL downgrade_service()\nENDIF\nCALL upload_logs(\"error\", {{error_log_retention_days}})\nCALL upload_logs(\"access\", {{access_log_retention_days}})\nCALL upload_logs(\"debug\", {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR 10 MINUTES\n    CALL trigger_alert(\"Low query rate\")\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR 5 MINUTES\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 27,
          "error_type": "类型错误",
          "message": "比较运算 > 仅支持数字类型，当前为 Dict 与 String",
          "suggestion": "将变量类型改为 Integer/Float，或改用 == / !=",
          "severity": "P1"
        },
        {
          "line_number": 43,
          "error_type": "未定义变量",
          "message": "配置参数 {{code_lines}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code_lines}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 44,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 44,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 46,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 46,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 47,
          "error_type": "未定义变量",
          "message": "配置参数 {{explanation}} 在使用前未定义",
          "suggestion": "在DSL开头添加: DEFINE {{explanation}}: Type",
          "severity": "P1"
        }
      ],
      "warnings": [
        "运行时变量 'query_type' 未预定义（将在运行时动态创建）",
        "运行时变量 'query' 未预定义（将在运行时动态创建）",
        "运行时变量 'vector_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'reordered_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'intent_decomposed' 首次赋值（将在运行时动态创建）",
        "运行时变量 'graph_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'full_search_results' 首次赋值（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'analysis_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback' 未预定义（将在运行时动态创建）",
        "运行时变量 'stronger_model_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback_count' 未预定义（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'current_requests' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'filtered_query' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_id' 未预定义（将在运行时动态创建）",
        "运行时变量 'user_identity_confirmed' 首次赋值（将在运行时动态创建）",
        "运行时变量 'vector_retrieval_time' 未预定义（将在运行时动态创建）",
        "运行时变量 'graph_database_time' 未预定义（将在运行时动态创建）",
        "运行时变量 'code_analysis_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'query_rate' 未预定义（将在运行时动态创建）",
        "比较运算 < 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 '95th_percentile_response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确"
      ],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "\"0.85\"",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "graph_exploration_steps": {
          "name": "graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_documents": {
          "name": "knowledge_base_A_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_documents": {
          "name": "knowledge_base_B_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_documents": {
          "name": "knowledge_base_C_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time": {
          "name": "vector_retrieval_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "alert_duration_minutes": {
          "name": "alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "alert_duration_response_time_minutes": {
          "name": "alert_duration_response_time_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "knowledge_base_A": {
          "name": "knowledge_base_A",
          "var_type": "Dict",
          "initial_value": null,
          "line_number": 22
        },
        "knowledge_base_B": {
          "name": "knowledge_base_B",
          "var_type": "Dict",
          "initial_value": null,
          "line_number": 23
        },
        "knowledge_base_C": {
          "name": "knowledge_base_C",
          "var_type": "Dict",
          "initial_value": null,
          "line_number": 24
        }
      },
      "runtime_variables": [
        "user_feedback",
        "graph_database_time",
        "filtered_query",
        "vector_retrieval_time",
        "reordered_results",
        "query",
        "user_identity_confirmed",
        "query_type",
        "full_search_results",
        "stronger_model_results",
        "user_id",
        "code_analysis_time",
        "current_requests",
        "graph_results",
        "user_feedback_count",
        "intent_decomposed",
        "95th_percentile_response_time",
        "query_rate",
        "vector_results",
        "analysis_results"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "vector_results",
          "line_number": 26
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{vector_results}}"
          ],
          "result_var": "reordered_results",
          "line_number": 30
        },
        {
          "function_name": "decompose_intent",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "intent_decomposed",
          "line_number": 34
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{intent_decomposed}}",
            "{{graph_exploration_steps}}"
          ],
          "result_var": "graph_results",
          "line_number": 35
        },
        {
          "function_name": "full_search",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "full_search_results",
          "line_number": 39
        },
        {
          "function_name": "static_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 44
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 46
        },
        {
          "function_name": "generate_explanation",
          "arguments": [
            "{{analysis_results}}"
          ],
          "result_var": "explanation",
          "line_number": 47
        },
        {
          "function_name": "stronger_reasoning_model",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "stronger_model_results",
          "line_number": 51
        },
        {
          "function_name": "configure_knowledge_base",
          "arguments": [
            "\"A\"",
            "{{knowledge_base_A_documents}}",
            "{{vector_dimension}}"
          ],
          "result_var": "knowledge_base_A",
          "line_number": 57
        },
        {
          "function_name": "configure_knowledge_base",
          "arguments": [
            "\"B\"",
            "{{knowledge_base_B_documents}}",
            "{{vector_dimension}}"
          ],
          "result_var": "knowledge_base_B",
          "line_number": 58
        },
        {
          "function_name": "configure_knowledge_base",
          "arguments": [
            "\"C\"",
            "{{knowledge_base_C_documents}}",
            "{{vector_dimension}}"
          ],
          "result_var": "knowledge_base_C",
          "line_number": 59
        },
        {
          "function_name": "filter_sensitive_words",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "filtered_query",
          "line_number": 63
        },
        {
          "function_name": "confirm_user_identity",
          "arguments": [
            "{{user_id}}"
          ],
          "result_var": "user_identity_confirmed",
          "line_number": 69
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 36937,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{query}})\n    IF {{similarity}} > {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{query}})\n    {{results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{code}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"unsatisfied\"\n    {{new_results}} = CALL stronger_reasoning_model()\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{query_content}} == \"sensitive\"\n    CALL reject_service_and_log()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs()",
          "total_errors": 5,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 5,
            "p2_count": 0,
            "total": 5
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nDEFINE {{code}}: String\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{query}})\n    IF {{vector_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_results.top_n}}[0:{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results.top_n}}[0:{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposition}} = CALL decompose_intent({{query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposition}}, {{graph_exploration_steps}})\n    IF {{graph_results.has_matches}}\n        RETURN {{graph_results.entities}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    DEFINE {{code_lines}} = CALL count_code_lines({{code}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{code}})\n    ENDIF\n    RETURN {{analysis_results}}\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{query}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{query}})\nENDIF\n{{knowledge_base_A}} = {{knowledge_base_A_documents}}\n{{knowledge_base_B}} = {{knowledge_base_B_documents}}\n{{knowledge_base_C}} = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{query}})\nENDIF\nIF CALL contains_sensitive_words({{query}})\n    CALL log_violation({{query}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity({{user_id}})\nENDIF\nIF {{vector_retrieval_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 5,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 4,
            "p2_count": 1,
            "total": 5
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nDEFINE {{knowledge_base_A}}: Dict\nDEFINE {{knowledge_base_B}}: Dict\nDEFINE {{knowledge_base_C}}: Dict\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{query}})\n    IF {{vector_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_results.top_n}}[0:{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results}}[0:{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposed}} = CALL decompose_intent({{query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposed}}, {{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{code}})\n        {{explanation}} = CALL generate_explanation({{analysis_results}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{query}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{query}})\nENDIF\n{{knowledge_base_A}} = CALL configure_knowledge_base(\"A\", {{knowledge_base_A_documents}}, {{vector_dimension}})\n{{knowledge_base_B}} = CALL configure_knowledge_base(\"B\", {{knowledge_base_B_documents}}, {{vector_dimension}})\n{{knowledge_base_C}} = CALL configure_knowledge_base(\"C\", {{knowledge_base_C_documents}}, {{vector_dimension}})\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{query}})\nENDIF\n{{filtered_query}} = CALL filter_sensitive_words({{query}})\nIF {{filtered_query}} IS NOT VALID\n    CALL log_error(\"Sensitive content detected\")\n    RETURN \"Service denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{user_identity_confirmed}} = CALL confirm_user_identity({{user_id}})\n    IF NOT {{user_identity_confirmed}}\n        RETURN \"Identity confirmation required\"\n    ENDIF\nENDIF\nIF {{vector_retrieval_time}} > {{vector_retrieval_response_time}} OR {{graph_database_time}} > {{graph_database_response_time}} OR {{code_analysis_time}} > {{code_analysis_response_time}}\n    CALL downgrade_service()\nENDIF\nCALL upload_logs(\"error\", {{error_log_retention_days}})\nCALL upload_logs(\"access\", {{access_log_retention_days}})\nCALL upload_logs(\"debug\", {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR 10 MINUTES\n    CALL trigger_alert(\"Low query rate\")\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR 5 MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 7,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 7,
            "p2_count": 0,
            "total": 7
          }
        }
      ],
      "final_decision": "failed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 7,
        "p2_count": 0,
        "total": 7
      },
      "auto_fix_applied": true
    },
    "prompt30_success": false,
    "prompt40_id": "2665a3bf",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 0,
    "prompt40_step1_parsing": {},
    "prompt40_step2_dependency": {},
    "prompt40_step3_clustering": {},
    "prompt40_step4_generation": {},
    "prompt40_step5_orchestration": {},
    "overall_status": "partial",
    "total_time_ms": 45651,
    "error_message": null
  },
  "f35df56e": {
    "pipeline_id": "f35df56e",
    "timestamp": "2026-01-29 13:47:08",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "2da0e9d0",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 819字"
        },
        "duration_ms": 8726,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 8726,
    "prompt20_id": "bbcd0c55",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{vector_similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{low_query_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{high_response_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "vector_similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "low_query_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "high_response_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "2a21fb4f",
    "prompt30_dsl_code": "DEFINE {{vector_similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration_minutes}}: Integer = 10\nDEFINE {{high_response_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{user_code}})\n        RETURN CALL generate_explanation_document({{analysis_results}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{new_results}} = CALL stronger_reasoning_model()\n    RETURN {{new_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_documents}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_documents}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL check_sensitive_words({{user_query}})\n    RETURN CALL reject_service()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR {{low_query_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{high_response_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 39,
          "error_type": "未定义变量",
          "message": "配置参数 {{code_lines}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code_lines}}: Type",
          "severity": "P1"
        }
      ],
      "warnings": [
        "运行时变量 'query_type' 未预定义（将在运行时动态创建）",
        "运行时变量 'user_query' 未预定义（将在运行时动态创建）",
        "运行时变量 'similarity' 首次赋值（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'reordered_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'graph_results' 首次赋值（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'user_code' 未预定义（将在运行时动态创建）",
        "运行时变量 'analysis_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback' 未预定义（将在运行时动态创建）",
        "运行时变量 'new_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback_count' 未预定义（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'current_requests' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'vector_retrieval_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'query_rate' 未预定义（将在运行时动态创建）",
        "比较运算 < 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 '95th_percentile_response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确"
      ],
      "defined_variables": {
        "vector_similarity_threshold": {
          "name": "vector_similarity_threshold",
          "var_type": "String",
          "initial_value": "\"0.85\"",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "graph_exploration_steps": {
          "name": "graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_documents": {
          "name": "knowledge_base_A_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_documents": {
          "name": "knowledge_base_B_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_documents": {
          "name": "knowledge_base_C_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time": {
          "name": "vector_retrieval_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "low_query_duration_minutes": {
          "name": "low_query_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "high_response_duration_minutes": {
          "name": "high_response_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "knowledge_base_A": {
          "name": "knowledge_base_A",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_A_documents}}",
          "line_number": 53
        },
        "knowledge_base_B": {
          "name": "knowledge_base_B",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_B_documents}}",
          "line_number": 54
        },
        "knowledge_base_C": {
          "name": "knowledge_base_C",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_C_documents}}",
          "line_number": 55
        }
      },
      "runtime_variables": [
        "user_feedback_count",
        "query_rate",
        "graph_results",
        "query_type",
        "current_requests",
        "user_query",
        "reordered_results",
        "analysis_results",
        "new_results",
        "vector_retrieval_time",
        "95th_percentile_response_time",
        "user_code",
        "user_feedback",
        "similarity"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "similarity",
          "line_number": 23
        },
        {
          "function_name": "reorder_results",
          "arguments": [],
          "result_var": "reordered_results",
          "line_number": 27
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{graph_exploration_steps}}"
          ],
          "result_var": "graph_results",
          "line_number": 32
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{user_code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 42
        },
        {
          "function_name": "stronger_reasoning_model",
          "arguments": [],
          "result_var": "new_results",
          "line_number": 47
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 35750,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration_minutes}}: Integer = 10\nDEFINE {{high_response_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{query}})\n    IF {{vector_results.similarity}} > {{vector_similarity_threshold}}\n        RETURN {{vector_results.top_n}}[0:{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results.top_n}}[0:{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposition}} = CALL decompose_intent({{query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposition}}, {{graph_exploration_steps}})\n    IF {{graph_results.match_found}}\n        RETURN {{graph_results.entities}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{static_analysis_results}} = CALL static_analysis({{code}})\n        RETURN {{static_analysis_results}}\n    ELSE\n        {{semantic_analysis_results}} = CALL semantic_analysis({{code}})\n        RETURN {{semantic_analysis_results}}\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{query}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{query}})\nENDIF\nDEFINE {{knowledge_base_A}}: Dict = {\"documents\": {{knowledge_base_A_documents}}}\nDEFINE {{knowledge_base_B}}: Dict = {\"documents\": {{knowledge_base_B_documents}}}\nDEFINE {{knowledge_base_C}}: Dict = {\"documents\": {{knowledge_base_C_documents}}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{query}})\nENDIF\nIF CALL check_sensitive_content({{query}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_category}} == \"financial\"\n    CALL confirm_user_identity({{user_id}})\nENDIF\nIF {{vector_retrieval_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 AND {{duration}} >= {{low_query_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{high_response_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 6,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 6,
            "p2_count": 0,
            "total": 6
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration_minutes}}: Integer = 10\nDEFINE {{high_response_duration_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nDEFINE {{code}}: String\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{query}})\n    {{graph_results}} = CALL graph_database_retrieval({{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    DEFINE {{code_lines}} = CALL count_code_lines({{code}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{code}})\n    ELSE\n        RETURN CALL semantic_analysis({{code}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"not_satisfied\"\n    CALL regenerate_response()\n    IF {{regenerate_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_documents}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_documents}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{query}})\n    CALL log_violation()\n    RETURN \"Service Denied\"\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs()",
          "total_errors": 1,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 1,
            "total": 1
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration_minutes}}: Integer = 10\nDEFINE {{high_response_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{user_code}})\n        RETURN CALL generate_explanation_document({{analysis_results}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{new_results}} = CALL stronger_reasoning_model()\n    RETURN {{new_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_documents}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_documents}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL check_sensitive_words({{user_query}})\n    RETURN CALL reject_service()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR {{low_query_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{high_response_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 1,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 1,
            "p2_count": 0,
            "total": 1
          }
        }
      ],
      "final_decision": "partial_auto_fixed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 1,
        "p2_count": 0,
        "total": 1
      },
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "7c4dba6c",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 9,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 11 个错误：\n  ❌ step_2_reorder_results: 语法错误 - invalid syntax (行 3)\n  ❌ step_4_graph_database_retrieval: 语法错误 - invalid syntax (行 3)\n  ❌ step_5_process: 语法错误 - invalid syntax (行 3)\n  ❌ step_6_semantic_analysis: 语法错误 - invalid syntax (行 3)\n  ❌ step_9_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_10_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_11_process: 语法错误 - invalid syntax (行 3)\n  ❌ step_13_process: 语法错误 - invalid syntax (行 3)\n  ❌ step_14_process: 语法错误 - invalid syntax (行 3)\n  ❌ step_15_process: 语法错误 - invalid decimal literal (行 3)\n  ❌ step_16_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "partial",
    "total_time_ms": 44485,
    "error_message": null
  },
  "af55f3a5": {
    "pipeline_id": "af55f3a5",
    "timestamp": "2026-01-29 13:47:58",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "af8c27c8",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 818字"
        },
        "duration_ms": 8891,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 8892,
    "prompt20_id": "1e90a2fb",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{vector_similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{query_rate_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{response_time_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "vector_similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "query_rate_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "55427d1a",
    "prompt30_dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nDEFINE {{user_query_type}}: String\nDEFINE {{user_code_lines}}: Integer\nDEFINE {{user_code}}: String\nDEFINE {{user_feedback}}: String\nDEFINE {{user_priority}}: Integer\nIF {{user_query_type}} == \"简单事实查询\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{user_query_type}} == \"复杂推理查询\"\n    CALL intent_decomposition({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        {{results}} = {{graph_results}}\n    ELSE\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{user_query_type}} == \"代码相关问题\"\n    IF {{user_code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{user_code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"不满意\"\n    CALL regenerate_response()\n    IF {{user_feedback}} == \"不满意\" AND {{user_feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nCALL cache_results({{results}}, {{cache_expiration_time}})",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [
        "运行时变量 'user_query' 未预定义（将在运行时动态创建）",
        "运行时变量 'similarity' 首次赋值（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'graph_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'analysis_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback_count' 未预定义（将在运行时动态创建）"
      ],
      "defined_variables": {
        "vector_similarity_threshold": {
          "name": "vector_similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "graph_exploration_steps": {
          "name": "graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_documents": {
          "name": "knowledge_base_A_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_documents": {
          "name": "knowledge_base_B_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_documents": {
          "name": "knowledge_base_C_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time": {
          "name": "vector_retrieval_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "query_rate_duration_minutes": {
          "name": "query_rate_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "response_time_duration_minutes": {
          "name": "response_time_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "user_query_type": {
          "name": "user_query_type",
          "var_type": "String",
          "initial_value": null,
          "line_number": 22
        },
        "user_code_lines": {
          "name": "user_code_lines",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 23
        },
        "user_code": {
          "name": "user_code",
          "var_type": "String",
          "initial_value": null,
          "line_number": 24
        },
        "user_feedback": {
          "name": "user_feedback",
          "var_type": "String",
          "initial_value": null,
          "line_number": 25
        },
        "user_priority": {
          "name": "user_priority",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 26
        }
      },
      "runtime_variables": [
        "graph_results",
        "similarity",
        "analysis_results",
        "results",
        "user_query",
        "user_feedback_count"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "similarity",
          "line_number": 28
        },
        {
          "function_name": "return_top_n_results",
          "arguments": [
            "{{top_n_vector_results}}"
          ],
          "result_var": "results",
          "line_number": 30
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{reordered_top_n_results}}"
          ],
          "result_var": "results",
          "line_number": 32
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{graph_exploration_steps}}"
          ],
          "result_var": "graph_results",
          "line_number": 36
        },
        {
          "function_name": "full_search",
          "arguments": [],
          "result_var": "results",
          "line_number": 40
        },
        {
          "function_name": "static_analysis",
          "arguments": [
            "{{user_code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 44
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{user_code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 46
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 18609,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_and_return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{code}})\n    ELSE\n        {{results}} = CALL semantic_analysis_and_generate_document({{code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"unsatisfied\"\n    {{retry}} = CALL enable_stronger_reasoning_model()\n    IF {{retry_count}} >= 3\n        {{queue}} = CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{concurrent_requests}} > {{max_concurrent_requests}}\n    {{queue}} = CALL queue_requests()\nENDIF\nIF {{query_content}} == \"sensitive\"\n    CALL reject_service_and_log()\nENDIF\nIF {{query_type}} == \"financial\"\n    {{confirmation}} = CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_response_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_response_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_response_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\n{{log}} = CALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\n{{monitoring}} = CALL monitor_metrics()\nIF {{query_rate}} < 10 FOR {{query_rate_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{response_time_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 9,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 9,
            "p2_count": 0,
            "total": 9
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nDEFINE {{user_query_type}}: String\nDEFINE {{user_code_lines}}: Integer\nDEFINE {{user_code}}: String\nDEFINE {{user_feedback}}: String\nDEFINE {{user_priority}}: Integer\nIF {{user_query_type}} == \"简单事实查询\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{user_query_type}} == \"复杂推理查询\"\n    CALL intent_decomposition({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        {{results}} = {{graph_results}}\n    ELSE\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{user_query_type}} == \"代码相关问题\"\n    IF {{user_code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{user_code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"不满意\"\n    CALL regenerate_response()\n    IF {{user_feedback}} == \"不满意\" AND {{user_feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nCALL cache_results({{results}}, {{cache_expiration_time}})",
          "total_errors": 0,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 0,
            "total": 0
          }
        }
      ],
      "final_decision": "success",
      "error_summary": {},
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "1e93c029",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 5,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 6 个错误：\n  ❌ step_3_reorder_results: 语法错误 - invalid syntax (行 3)\n  ❌ step_5_graph_database_retrieval: 语法错误 - invalid syntax (行 3)\n  ❌ step_6_full_search: 语法错误 - invalid syntax (行 3)\n  ❌ step_8_static_analysis: 语法错误 - invalid syntax (行 3)\n  ❌ step_10_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_12_compute_results: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "success",
    "total_time_ms": 27506,
    "error_message": null
  },
  "1390f80e": {
    "pipeline_id": "1390f80e",
    "timestamp": "2026-01-29 13:49:17",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "c90dd63d",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 818字"
        },
        "duration_ms": 8967,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 8968,
    "prompt20_id": "a8cddeb7",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{vector_similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{knowledge_graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_for_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time_limit}}内完成，图数据库检索在{{graph_database_response_time_limit}}内完成，代码分析在{{code_analysis_response_time_limit}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{query_rate_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{response_time_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "vector_similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "knowledge_graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_for_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time_limit",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time_limit",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time_limit",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "query_rate_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "960db14b",
    "prompt30_dsl_code": "DEFINE {{vector_similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_for_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time_limit}}: Integer = 500\nDEFINE {{graph_database_response_time_limit}}: Integer = 1\nDEFINE {{code_analysis_response_time_limit}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{query}})\n    {{results}} = CALL graph_database_retrieval({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search({{query}})\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_for_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{code}})\n        {{explanation}} = CALL generate_explanation({{analysis_results}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{new_results}} = CALL stronger_reasoning_model({{query}})\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{contains_sensitive_content}} == TRUE\n    CALL reject_service()\n    CALL log_violation({{query}})\nENDIF\nIF {{is_financial_query}} == TRUE\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_time}} > {{vector_retrieval_response_time_limit}} OR {{graph_database_time}} > {{graph_database_response_time_limit}} OR {{code_analysis_time}} > {{code_analysis_response_time_limit}} OR {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 AND {{duration}} >= {{query_rate_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{response_time_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 36,
          "error_type": "未定义变量",
          "message": "配置参数 {{code_lines}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code_lines}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 37,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 37,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 39,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 39,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 40,
          "error_type": "未定义变量",
          "message": "配置参数 {{explanation}} 在使用前未定义",
          "suggestion": "在DSL开头添加: DEFINE {{explanation}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 53,
          "error_type": "未定义变量",
          "message": "配置参数 {{contains_sensitive_content}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{contains_sensitive_content}}: Type",
          "severity": "P1"
        }
      ],
      "warnings": [
        "运行时变量 'query_type' 未预定义（将在运行时动态创建）",
        "运行时变量 'query' 未预定义（将在运行时动态创建）",
        "运行时变量 'similarity' 首次赋值（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'intent' 首次赋值（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'analysis_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'cache' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback' 未预定义（将在运行时动态创建）",
        "运行时变量 'new_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback_count' 未预定义（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'current_requests' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'is_financial_query' 未预定义（将在运行时动态创建）",
        "运行时变量 'vector_retrieval_time' 未预定义（将在运行时动态创建）",
        "运行时变量 'graph_database_time' 未预定义（将在运行时动态创建）",
        "运行时变量 'code_analysis_time' 未预定义（将在运行时动态创建）",
        "运行时变量 'total_response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'query_rate' 未预定义（将在运行时动态创建）",
        "运行时变量 'duration' 未预定义（将在运行时动态创建）",
        "比较运算 < 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 '95th_percentile_response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确"
      ],
      "defined_variables": {
        "vector_similarity_threshold": {
          "name": "vector_similarity_threshold",
          "var_type": "String",
          "initial_value": "\"0.85\"",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "knowledge_graph_exploration_steps": {
          "name": "knowledge_graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_for_static_analysis": {
          "name": "max_code_lines_for_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_documents": {
          "name": "knowledge_base_A_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_documents": {
          "name": "knowledge_base_B_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_documents": {
          "name": "knowledge_base_C_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time_limit": {
          "name": "vector_retrieval_response_time_limit",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time_limit": {
          "name": "graph_database_response_time_limit",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time_limit": {
          "name": "code_analysis_response_time_limit",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "query_rate_duration_minutes": {
          "name": "query_rate_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "response_time_duration_minutes": {
          "name": "response_time_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        }
      },
      "runtime_variables": [
        "analysis_results",
        "user_feedback_count",
        "similarity",
        "query_type",
        "current_requests",
        "duration",
        "query",
        "new_results",
        "95th_percentile_response_time",
        "user_feedback",
        "total_response_time",
        "is_financial_query",
        "cache",
        "intent",
        "code_analysis_time",
        "query_rate",
        "results",
        "vector_retrieval_time",
        "graph_database_time"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "similarity",
          "line_number": 23
        },
        {
          "function_name": "return_top_n_results",
          "arguments": [
            "{{top_n_vector_results}}"
          ],
          "result_var": "results",
          "line_number": 25
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{reordered_top_n_results}}"
          ],
          "result_var": "results",
          "line_number": 27
        },
        {
          "function_name": "decompose_intent",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "intent",
          "line_number": 30
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{intent}}",
            "{{knowledge_graph_exploration_steps}}"
          ],
          "result_var": "results",
          "line_number": 31
        },
        {
          "function_name": "full_search",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "results",
          "line_number": 33
        },
        {
          "function_name": "static_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 37
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 39
        },
        {
          "function_name": "generate_explanation",
          "arguments": [
            "{{analysis_results}}"
          ],
          "result_var": "explanation",
          "line_number": 40
        },
        {
          "function_name": "cache_results",
          "arguments": [
            "{{results}}",
            "{{cache_expiration_time}}"
          ],
          "result_var": "cache",
          "line_number": 43
        },
        {
          "function_name": "stronger_reasoning_model",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "new_results",
          "line_number": 45
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 31843,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_for_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time_limit}}: Integer = 500\nDEFINE {{graph_database_response_time_limit}}: Integer = 1\nDEFINE {{code_analysis_response_time_limit}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{user_query}})\n    IF {{vector_results.similarity}} > {{vector_similarity_threshold}}\n        RETURN {{vector_results.top_n}} \n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results.top_n}}\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposition}} = CALL decompose_intent({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposition}}, {{knowledge_graph_exploration_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results.entities}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{user_query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_for_static_analysis}}\n        {{static_analysis_results}} = CALL static_analysis({{user_code}})\n        RETURN {{static_analysis_results}}\n    ELSE\n        {{semantic_analysis_results}} = CALL semantic_analysis({{user_code}})\n        RETURN {{semantic_analysis_results}}\n    ENDIF\nENDIF\nCALL cache_results({{query_id}}, {{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{user_query}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{user_query}})\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_query}})\nENDIF\nIF CALL check_sensitive_words({{user_query}})\n    CALL log_violation({{user_query}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 AND {{duration}} >= {{query_rate_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{response_time_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_for_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time_limit}}: Integer = 500\nDEFINE {{graph_database_response_time_limit}}: Integer = 1\nDEFINE {{code_analysis_response_time_limit}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{query}})\n    {{graph_results}} = CALL graph_database_retrieval()\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    DEFINE {{code_lines}} = CALL get_code_lines({{query}})\n    IF {{code_lines}} > {{max_code_lines_for_static_analysis}}\n        RETURN CALL static_analysis({{query}})\n    ELSE\n        RETURN CALL semantic_analysis({{query}})\n    ENDIF\nENDIF\nCALL cache_results({{query}}, {{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    CALL stronger_reasoning_model()\n    IF {{user_feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_documents}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_documents}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL check_sensitive_content({{query}})\n    RETURN CALL reject_service()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 AND {{duration}} >= {{query_rate_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{response_time_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 1,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 1,
            "total": 1
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_for_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time_limit}}: Integer = 500\nDEFINE {{graph_database_response_time_limit}}: Integer = 1\nDEFINE {{code_analysis_response_time_limit}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{query}})\n    {{results}} = CALL graph_database_retrieval({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search({{query}})\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_for_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{code}})\n        {{explanation}} = CALL generate_explanation({{analysis_results}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{new_results}} = CALL stronger_reasoning_model({{query}})\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{contains_sensitive_content}} == TRUE\n    CALL reject_service()\n    CALL log_violation({{query}})\nENDIF\nIF {{is_financial_query}} == TRUE\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_time}} > {{vector_retrieval_response_time_limit}} OR {{graph_database_time}} > {{graph_database_response_time_limit}} OR {{code_analysis_time}} > {{code_analysis_response_time_limit}} OR {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 AND {{duration}} >= {{query_rate_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{response_time_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 7,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 7,
            "p2_count": 0,
            "total": 7
          }
        }
      ],
      "final_decision": "failed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 7,
        "p2_count": 0,
        "total": 7
      },
      "auto_fix_applied": true
    },
    "prompt30_success": false,
    "prompt40_id": "152c2bfe",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 0,
    "prompt40_step1_parsing": {},
    "prompt40_step2_dependency": {},
    "prompt40_step3_clustering": {},
    "prompt40_step4_generation": {},
    "prompt40_step5_orchestration": {},
    "overall_status": "partial",
    "total_time_ms": 40811,
    "error_message": null
  },
  "dd06906d": {
    "pipeline_id": "dd06906d",
    "timestamp": "2026-01-29 13:50:45",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "abef6a30",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 839字"
        },
        "duration_ms": 9519,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 9520,
    "prompt20_id": "57263f1e",
    "prompt20_template": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_search}}；否则结合重排序模型重新评分，再返回{{top_n_reordered_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行{{knowledge_graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引(VI)，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{response_time_vector_search}}内完成，图数据库检索在{{response_time_graph_search}}内完成，代码分析在{{response_time_code_analysis}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续{{qps_alert_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{response_time_alert_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_search",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "top_n_reordered_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "knowledge_graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_vector_search",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "response_time_graph_search",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "response_time_code_analysis",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "qps_alert_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_alert_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "3bdf1a27",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_search}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{qps_alert_duration_minutes}}: Integer = 10\nDEFINE {{response_time_alert_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{query}})\n    IF {{similarity}} > {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{query}})\n    {{graph_results}} = CALL graph_database_search()\n    IF {{graph_results}} == \"match_found\"\n        RETURN CALL return_related_entities()\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{code}})\n    ELSE\n        {{explanation}} = CALL semantic_analysis({{code}})\n        RETURN {{explanation}}\n    ENDIF\nENDIF\nCALL cache_results({{query}}, {{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model}} = CALL enable_stronger_reasoning_model()\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_documents}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_documents}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_requests()\nENDIF\nIF CALL check_sensitive_words({{query}}) == \"detected\"\n    CALL log_violation()\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 AND {{duration}} >= {{qps_alert_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{response_time_alert_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 39,
          "error_type": "未定义变量",
          "message": "配置参数 {{code_lines}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code_lines}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 40,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 42,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 42,
          "error_type": "未定义变量",
          "message": "配置参数 {{explanation}} 在使用前未定义",
          "suggestion": "在DSL开头添加: DEFINE {{explanation}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 42,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 43,
          "error_type": "未定义变量",
          "message": "配置参数 {{explanation}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{explanation}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 48,
          "error_type": "未定义变量",
          "message": "配置参数 {{stronger_model}} 在使用前未定义",
          "suggestion": "在DSL开头添加: DEFINE {{stronger_model}}: Type",
          "severity": "P1"
        }
      ],
      "warnings": [
        "运行时变量 'query_type' 未预定义（将在运行时动态创建）",
        "运行时变量 'query' 未预定义（将在运行时动态创建）",
        "运行时变量 'similarity' 首次赋值（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'reordered_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'graph_results' 首次赋值（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'user_feedback' 未预定义（将在运行时动态创建）",
        "运行时变量 'user_feedback_count' 未预定义（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'current_requests' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'qps' 未预定义（将在运行时动态创建）",
        "运行时变量 'duration' 未预定义（将在运行时动态创建）",
        "比较运算 < 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 '95th_percentile_response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确"
      ],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "\"0.85\"",
          "line_number": 1
        },
        "top_n_vector_search": {
          "name": "top_n_vector_search",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "top_n_reordered_results": {
          "name": "top_n_reordered_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "knowledge_graph_exploration_steps": {
          "name": "knowledge_graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_documents": {
          "name": "knowledge_base_A_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_documents": {
          "name": "knowledge_base_B_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_documents": {
          "name": "knowledge_base_C_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "response_time_vector_search": {
          "name": "response_time_vector_search",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "response_time_graph_search": {
          "name": "response_time_graph_search",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "response_time_code_analysis": {
          "name": "response_time_code_analysis",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "qps_alert_duration_minutes": {
          "name": "qps_alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "response_time_alert_duration_minutes": {
          "name": "response_time_alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "knowledge_base_A": {
          "name": "knowledge_base_A",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_A_documents}}",
          "line_number": 53
        },
        "knowledge_base_B": {
          "name": "knowledge_base_B",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_B_documents}}",
          "line_number": 54
        },
        "knowledge_base_C": {
          "name": "knowledge_base_C",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_C_documents}}",
          "line_number": 55
        }
      },
      "runtime_variables": [
        "query",
        "response_time",
        "user_feedback_count",
        "95th_percentile_response_time",
        "user_feedback",
        "qps",
        "duration",
        "graph_results",
        "query_type",
        "similarity",
        "reordered_results",
        "current_requests"
      ],
      "function_calls": [
        {
          "function_name": "vector_search",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "similarity",
          "line_number": 23
        },
        {
          "function_name": "reorder_results",
          "arguments": [],
          "result_var": "reordered_results",
          "line_number": 27
        },
        {
          "function_name": "graph_database_search",
          "arguments": [],
          "result_var": "graph_results",
          "line_number": 32
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "explanation",
          "line_number": 42
        },
        {
          "function_name": "enable_stronger_reasoning_model",
          "arguments": [],
          "result_var": "stronger_model",
          "line_number": 48
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 34088,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_search}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{qps_alert_duration_minutes}}: Integer = 10\nDEFINE {{response_time_alert_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"简单事实查询\"\n    {{vector_search_result}} = CALL vector_search({{user_query}})\n    IF {{vector_search_result.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_search_result.top_n}}[{{top_n_vector_search}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_search_result}})\n        RETURN {{reordered_results.top_n}}[{{top_n_reordered_results}}]\n    ENDIF\nELIF {{query_type}} == \"复杂推理查询\"\n    {{intent_decomposition}} = CALL decompose_intent({{user_query}})\n    {{graph_search_result}} = CALL graph_search({{intent_decomposition}}, {{knowledge_graph_exploration_steps}})\n    IF {{graph_search_result.has_matching_nodes}}\n        RETURN {{graph_search_result.entities}}\n    ELSE\n        {{full_search_result}} = CALL full_search({{user_query}})\n        RETURN {{full_search_result}}\n    ENDIF\nELIF {{query_type}} == \"代码相关问题\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{static_analysis_result}} = CALL static_analysis({{user_code}})\n        RETURN {{static_analysis_result}}\n    ELSE\n        {{semantic_analysis_result}} = CALL semantic_analysis({{user_code}})\n        RETURN {{semantic_analysis_result}}\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"不满意\"\n    {{regenerate_result}} = CALL stronger_reasoning_model({{user_query}})\n    RETURN {{regenerate_result}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{user_query}})\nENDIF\nDEFINE {{knowledge_base_A}}: Dict = {\"documents\": {{knowledge_base_A_documents}}, \"vector_index\": \"VI_A\"}\nDEFINE {{knowledge_base_B}}: Dict = {\"documents\": {{knowledge_base_B_documents}}, \"vector_index\": \"VI_B\"}\nDEFINE {{knowledge_base_C}}: Dict = {\"documents\": {{knowledge_base_C_documents}}, \"vector_index\": \"VI_C\"}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_query}})\nENDIF\nIF CALL check_sensitive_words({{user_query}})\n    RETURN \"服务拒绝，内容违规\"\nENDIF\nIF {{query_type}} == \"金融类查询\"\n    CALL confirm_user_identity({{user_id}})\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 AND {{duration}} >= {{qps_alert_duration_minutes}}\n    CALL trigger_alert(\"QPS低于阈值\")\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{response_time_alert_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_search}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{qps_alert_duration_minutes}}: Integer = 10\nDEFINE {{response_time_alert_duration_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{user_query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{user_query}})\n    {{results}} = CALL graph_database_search({{knowledge_graph_exploration_steps}})\nELIF {{query_type}} == \"code_related\"\n    DEFINE {{code_lines}} = CALL get_code_lines({{user_query}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{user_query}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{user_query}})\n    ENDIF\nENDIF\nIF {{results}} == \"failed\"\n    {{results}} = CALL hybrid_search()\nENDIF\nCALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"unsatisfied\"\n    CALL regenerate_response()\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{query_content}} == \"contains_sensitive_words\"\n    CALL reject_service()\n    CALL log_violation()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time_vector_search}} > {{response_time_vector_search}}\n    CALL degrade_service()\nENDIF\nIF {{response_time_graph_search}} > {{response_time_graph_search}}\n    CALL degrade_service()\nENDIF\nIF {{response_time_code_analysis}} > {{response_time_code_analysis}}\n    CALL degrade_service()\nENDIF\nIF {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs()\nIF {{qps}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 1,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 1,
            "total": 1
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_search}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{qps_alert_duration_minutes}}: Integer = 10\nDEFINE {{response_time_alert_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{query}})\n    IF {{similarity}} > {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{query}})\n    {{graph_results}} = CALL graph_database_search()\n    IF {{graph_results}} == \"match_found\"\n        RETURN CALL return_related_entities()\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{code}})\n    ELSE\n        {{explanation}} = CALL semantic_analysis({{code}})\n        RETURN {{explanation}}\n    ENDIF\nENDIF\nCALL cache_results({{query}}, {{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model}} = CALL enable_stronger_reasoning_model()\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_documents}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_documents}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_requests()\nENDIF\nIF CALL check_sensitive_words({{query}}) == \"detected\"\n    CALL log_violation()\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 AND {{duration}} >= {{qps_alert_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{response_time_alert_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 7,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 7,
            "p2_count": 0,
            "total": 7
          }
        }
      ],
      "final_decision": "failed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 7,
        "p2_count": 0,
        "total": 7
      },
      "auto_fix_applied": true
    },
    "prompt30_success": false,
    "prompt40_id": "94ebb04c",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 0,
    "prompt40_step1_parsing": {},
    "prompt40_step2_dependency": {},
    "prompt40_step3_clustering": {},
    "prompt40_step4_generation": {},
    "prompt40_step5_orchestration": {},
    "overall_status": "partial",
    "total_time_ms": 43608,
    "error_message": null
  },
  "7c6beb4c": {
    "pipeline_id": "7c6beb4c",
    "timestamp": "2026-01-29 13:52:42",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "5fc7ceed",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 818字"
        },
        "duration_ms": 8133,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 8134,
    "prompt20_id": "38ff7f31",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_search}}；否则结合重排序模型重新评分，再返回{{top_n_reorder_search}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{knowledge_graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{response_time_vector_search}}内完成，图数据库检索在{{response_time_graph_search}}内完成，代码分析在{{response_time_code_analysis}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{query_rate_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{response_time_95th_percentile_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_search",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "top_n_reorder_search",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "knowledge_graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_vector_search",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "response_time_graph_search",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "response_time_code_analysis",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "query_rate_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_95th_percentile_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "1356cdd6",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reorder_search}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_search}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_95th_percentile_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{user_query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_results({{top_n_reorder_search}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_search({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{user_code}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{results}} = CALL stronger_reasoning_model({{user_query}})\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\n{{knowledge_base_A}} = {{knowledge_base_A_documents}}\n{{knowledge_base_B}} = {{knowledge_base_B_documents}}\n{{knowledge_base_C}} = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{contains_sensitive_content}} == TRUE\n    CALL reject_service()\n    CALL log_violation()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{response_time_95th_percentile}} > 3\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 36,
          "error_type": "未定义变量",
          "message": "配置参数 {{code_lines}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code_lines}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 49,
          "error_type": "未定义变量",
          "message": "配置参数 {{knowledge_base_A}} 在使用前未定义",
          "suggestion": "在DSL开头添加: DEFINE {{knowledge_base_A}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 50,
          "error_type": "未定义变量",
          "message": "配置参数 {{knowledge_base_B}} 在使用前未定义",
          "suggestion": "在DSL开头添加: DEFINE {{knowledge_base_B}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 51,
          "error_type": "未定义变量",
          "message": "配置参数 {{knowledge_base_C}} 在使用前未定义",
          "suggestion": "在DSL开头添加: DEFINE {{knowledge_base_C}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 55,
          "error_type": "未定义变量",
          "message": "配置参数 {{contains_sensitive_content}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{contains_sensitive_content}}: Type",
          "severity": "P1"
        }
      ],
      "warnings": [
        "运行时变量 'query_type' 未预定义（将在运行时动态创建）",
        "运行时变量 'user_query' 未预定义（将在运行时动态创建）",
        "运行时变量 'similarity' 首次赋值（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'intent' 首次赋值（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'user_code' 未预定义（将在运行时动态创建）",
        "运行时变量 'cache' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback' 未预定义（将在运行时动态创建）",
        "运行时变量 'user_feedback_count' 未预定义（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'current_requests' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'query_rate' 未预定义（将在运行时动态创建）",
        "比较运算 < 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'response_time_95th_percentile' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确"
      ],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "\"0.85\"",
          "line_number": 1
        },
        "top_n_vector_search": {
          "name": "top_n_vector_search",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "top_n_reorder_search": {
          "name": "top_n_reorder_search",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "knowledge_graph_exploration_steps": {
          "name": "knowledge_graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_documents": {
          "name": "knowledge_base_A_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_documents": {
          "name": "knowledge_base_B_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_documents": {
          "name": "knowledge_base_C_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "response_time_vector_search": {
          "name": "response_time_vector_search",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "response_time_graph_search": {
          "name": "response_time_graph_search",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "response_time_code_analysis": {
          "name": "response_time_code_analysis",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "query_rate_duration_minutes": {
          "name": "query_rate_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "response_time_95th_percentile_duration_minutes": {
          "name": "response_time_95th_percentile_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        }
      },
      "runtime_variables": [
        "cache",
        "response_time_95th_percentile",
        "query_type",
        "user_query",
        "current_requests",
        "results",
        "user_code",
        "intent",
        "user_feedback",
        "user_feedback_count",
        "query_rate",
        "response_time",
        "similarity"
      ],
      "function_calls": [
        {
          "function_name": "vector_search",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "similarity",
          "line_number": 23
        },
        {
          "function_name": "return_top_n_results",
          "arguments": [
            "{{top_n_vector_search}}"
          ],
          "result_var": "results",
          "line_number": 25
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{top_n_reorder_search}}"
          ],
          "result_var": "results",
          "line_number": 27
        },
        {
          "function_name": "decompose_intent",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "intent",
          "line_number": 30
        },
        {
          "function_name": "graph_database_search",
          "arguments": [
            "{{intent}}",
            "{{knowledge_graph_exploration_steps}}"
          ],
          "result_var": "results",
          "line_number": 31
        },
        {
          "function_name": "full_search",
          "arguments": [],
          "result_var": "results",
          "line_number": 33
        },
        {
          "function_name": "static_analysis",
          "arguments": [
            "{{user_code}}"
          ],
          "result_var": "results",
          "line_number": 37
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{user_code}}"
          ],
          "result_var": "results",
          "line_number": 39
        },
        {
          "function_name": "cache_results",
          "arguments": [
            "{{results}}",
            "{{cache_expiration_time}}"
          ],
          "result_var": "cache",
          "line_number": 42
        },
        {
          "function_name": "stronger_reasoning_model",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "results",
          "line_number": 44
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 34840,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reorder_search}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_search}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_95th_percentile_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"简单事实查询\"\n    {{vector_search_results}} = CALL vector_search({{user_query}})\n    IF {{vector_search_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_search_results.top_n}}[{{top_n_vector_search}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_search({{vector_search_results}})\n        RETURN {{reordered_results.top_n}}[{{top_n_reorder_search}}]\n    ENDIF\nELIF {{query_type}} == \"复杂推理查询\"\n    {{intent_decomposition}} = CALL decompose_intent({{user_query}})\n    {{graph_search_results}} = CALL graph_database_search({{intent_decomposition}}, {{knowledge_graph_exploration_steps}})\n    IF {{graph_search_results}} IS NOT EMPTY\n        RETURN {{graph_search_results}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{user_query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"代码相关问题\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{static_analysis_results}} = CALL static_analysis({{user_code}})\n        RETURN {{static_analysis_results}}\n    ELSE\n        {{semantic_analysis_results}} = CALL semantic_analysis({{user_code}})\n        RETURN {{semantic_analysis_results}}\n    ENDIF\nENDIF\nCALL cache_results({{user_query}}, {{results}}, {{cache_expiration_time}})\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_query}})\nENDIF\nIF CALL check_sensitive_words({{user_query}})\n    RETURN \"拒绝服务\"\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 AND {{duration}} > {{query_rate_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{response_time_95th_percentile}} > 3 AND {{duration}} > {{response_time_95th_percentile_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reorder_search}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_search}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_95th_percentile_duration_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_and_return_top_n_results({{top_n_reorder_search}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{query}})\n    {{results}} = CALL graph_database_search({{knowledge_graph_exploration_steps}})\nELIF {{query_type}} == \"code_related\"\n    DEFINE {{code_lines}} = CALL get_code_lines({{query}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{query}})\n    ELSE\n        {{results}} = CALL semantic_analysis_and_generate_document({{query}})\n    ENDIF\nENDIF\nCALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{query}})\n    CALL reject_service()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 AND {{duration}} > {{query_rate_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{response_time_95th_percentile}} > 3 AND {{duration}} > {{response_time_95th_percentile_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 1,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 1,
            "total": 1
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reorder_search}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_search}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_95th_percentile_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{user_query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_results({{top_n_reorder_search}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_search({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} == \"no_match\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{user_code}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{results}} = CALL stronger_reasoning_model({{user_query}})\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\n{{knowledge_base_A}} = {{knowledge_base_A_documents}}\n{{knowledge_base_B}} = {{knowledge_base_B_documents}}\n{{knowledge_base_C}} = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{contains_sensitive_content}} == TRUE\n    CALL reject_service()\n    CALL log_violation()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{response_time_95th_percentile}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 5,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 5,
            "p2_count": 0,
            "total": 5
          }
        }
      ],
      "final_decision": "failed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 5,
        "p2_count": 0,
        "total": 5
      },
      "auto_fix_applied": true
    },
    "prompt30_success": false,
    "prompt40_id": "44525fd0",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 0,
    "prompt40_step1_parsing": {},
    "prompt40_step2_dependency": {},
    "prompt40_step3_clustering": {},
    "prompt40_step4_generation": {},
    "prompt40_step5_orchestration": {},
    "overall_status": "partial",
    "total_time_ms": 42974,
    "error_message": null
  },
  "e4925b01": {
    "pipeline_id": "e4925b01",
    "timestamp": "2026-01-29 13:53:51",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "8eb461a3",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 839字"
        },
        "duration_ms": 7853,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 7854,
    "prompt20_id": "73bb741d",
    "prompt20_template": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_results_count}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行{{kg_neighbor_steps}}探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_a_documents}}，知识库B包含{{knowledge_base_b_documents}}，知识库C包含{{knowledge_base_c_documents}}。每个知识库都有独立的向量索引(VI)，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{response_time_vector_retrieval}}内完成，图数据库检索在{{response_time_graph_retrieval}}内完成，代码分析在{{response_time_code_analysis}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续{{qps_alert_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{response_time_alert_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_results_count",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "kg_neighbor_steps",
        "original_text": "2跳邻居",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_a_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_b_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_c_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_vector_retrieval",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "response_time_graph_retrieval",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "response_time_code_analysis",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "qps_alert_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_alert_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "9c852a4d",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_results_count}}: Integer = 5\nDEFINE {{kg_neighbor_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_a_documents}}: Integer = 2000\nDEFINE {{knowledge_base_b_documents}}: Integer = 3000\nDEFINE {{knowledge_base_c_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{qps_alert_duration_minutes}}: Integer = 10\nDEFINE {{response_time_alert_duration_minutes}}: Integer = 5\nDEFINE {{knowledge_base_a}}: Any\nDEFINE {{knowledge_base_b}}: Any\nDEFINE {{knowledge_base_c}}: Any\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{query}})\n    IF {{vector_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_results.top_n}}[{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results.top_n}}[{{reordered_results_count}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposed}} = CALL decompose_intent({{query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposed}}, {{kg_neighbor_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results.entities}} AND {{graph_results.relations}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{code}})\n        {{explanation}} = CALL generate_explanation({{analysis_results}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{query}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL upgrade_to_human_review_queue({{query}})\nENDIF\n{{knowledge_base_a}} = {{knowledge_base_a_documents}}\n{{knowledge_base_b}} = {{knowledge_base_b_documents}}\n{{knowledge_base_c}} = {{knowledge_base_c_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{query}})\nENDIF\nIF CALL check_sensitive_words({{query}}) == TRUE\n    CALL log_violation({{query}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity({{user_id}})\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 AND {{duration}} >= {{qps_alert_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{response_time_alert_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 27,
          "error_type": "类型错误",
          "message": "比较运算 > 仅支持数字类型，当前为 Dict 与 String",
          "suggestion": "将变量类型改为 Integer/Float，或改用 == / !=",
          "severity": "P1"
        },
        {
          "line_number": 43,
          "error_type": "未定义变量",
          "message": "配置参数 {{code_lines}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code_lines}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 44,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 44,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 46,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 46,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 47,
          "error_type": "未定义变量",
          "message": "配置参数 {{explanation}} 在使用前未定义",
          "suggestion": "在DSL开头添加: DEFINE {{explanation}}: Type",
          "severity": "P1"
        }
      ],
      "warnings": [
        "运行时变量 'query_type' 未预定义（将在运行时动态创建）",
        "运行时变量 'query' 未预定义（将在运行时动态创建）",
        "运行时变量 'vector_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'reordered_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'intent_decomposed' 首次赋值（将在运行时动态创建）",
        "运行时变量 'graph_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'full_search_results' 首次赋值（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'analysis_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback' 未预定义（将在运行时动态创建）",
        "运行时变量 'stronger_model_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback_count' 未预定义（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'current_requests' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'qps' 未预定义（将在运行时动态创建）",
        "运行时变量 'duration' 未预定义（将在运行时动态创建）",
        "比较运算 < 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 '95th_percentile_response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确"
      ],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "\"0.85\"",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_results_count": {
          "name": "reordered_results_count",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "kg_neighbor_steps": {
          "name": "kg_neighbor_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_a_documents": {
          "name": "knowledge_base_a_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_b_documents": {
          "name": "knowledge_base_b_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_c_documents": {
          "name": "knowledge_base_c_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "response_time_vector_retrieval": {
          "name": "response_time_vector_retrieval",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "response_time_graph_retrieval": {
          "name": "response_time_graph_retrieval",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "response_time_code_analysis": {
          "name": "response_time_code_analysis",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "qps_alert_duration_minutes": {
          "name": "qps_alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "response_time_alert_duration_minutes": {
          "name": "response_time_alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "knowledge_base_a": {
          "name": "knowledge_base_a",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 22
        },
        "knowledge_base_b": {
          "name": "knowledge_base_b",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 23
        },
        "knowledge_base_c": {
          "name": "knowledge_base_c",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 24
        }
      },
      "runtime_variables": [
        "vector_results",
        "95th_percentile_response_time",
        "query",
        "graph_results",
        "query_type",
        "stronger_model_results",
        "duration",
        "intent_decomposed",
        "full_search_results",
        "user_feedback",
        "reordered_results",
        "analysis_results",
        "current_requests",
        "response_time",
        "user_feedback_count",
        "qps"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "vector_results",
          "line_number": 26
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{vector_results}}"
          ],
          "result_var": "reordered_results",
          "line_number": 30
        },
        {
          "function_name": "decompose_intent",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "intent_decomposed",
          "line_number": 34
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{intent_decomposed}}",
            "{{kg_neighbor_steps}}"
          ],
          "result_var": "graph_results",
          "line_number": 35
        },
        {
          "function_name": "full_search",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "full_search_results",
          "line_number": 39
        },
        {
          "function_name": "static_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 44
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 46
        },
        {
          "function_name": "generate_explanation",
          "arguments": [
            "{{analysis_results}}"
          ],
          "result_var": "explanation",
          "line_number": 47
        },
        {
          "function_name": "stronger_reasoning_model",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "stronger_model_results",
          "line_number": 51
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 34746,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_results_count}}: Integer = 5\nDEFINE {{kg_neighbor_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_a_documents}}: Integer = 2000\nDEFINE {{knowledge_base_b_documents}}: Integer = 3000\nDEFINE {{knowledge_base_c_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{qps_alert_duration_minutes}}: Integer = 10\nDEFINE {{response_time_alert_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"简单事实查询\"\n    {{vector_results}} = CALL vector_retrieval({{user_query}})\n    IF {{vector_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_results.top_n}}[{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results.top_n}}[{{reordered_results_count}}]\n    ENDIF\nELIF {{query_type}} == \"复杂推理查询\"\n    {{intent_decomposed}} = CALL decompose_intent({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposed}}, {{kg_neighbor_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results.entities}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{user_query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"代码相关问题\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{static_analysis_results}} = CALL static_analysis({{user_code}})\n        RETURN {{static_analysis_results}}\n    ELSE\n        {{semantic_analysis_results}} = CALL semantic_analysis({{user_code}})\n        RETURN {{semantic_analysis_results}}\n    ENDIF\nENDIF\nCALL cache_results({{user_query}}, {{results}}, {{cache_expiration_time}})\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_query}})\nENDIF\nIF CALL check_sensitive_words({{user_query}})\n    RETURN \"拒绝服务\"\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 AND {{duration}} > {{qps_alert_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} > {{response_time_alert_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_results_count}}: Integer = 5\nDEFINE {{kg_neighbor_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_a_documents}}: Integer = 2000\nDEFINE {{knowledge_base_b_documents}}: Integer = 3000\nDEFINE {{knowledge_base_c_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{qps_alert_duration_minutes}}: Integer = 10\nDEFINE {{response_time_alert_duration_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{query}})\n    IF {{vector_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_results.top_n}}[{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results.top_n}}[{{reordered_results_count}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposed}} = CALL decompose_intent({{query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposed}}, {{kg_neighbor_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = CALL get_code_lines({{query}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{query}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{query}})\n    ENDIF\n    RETURN {{analysis_results}}\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{new_results}} = CALL stronger_reasoning_model({{query}})\n    RETURN {{new_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{query}})\nENDIF\n{{knowledge_base_a}} = {{knowledge_base_a_documents}}\n{{knowledge_base_b}} = {{knowledge_base_b_documents}}\n{{knowledge_base_c}} = {{knowledge_base_c_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{query}})\nENDIF\nIF CALL check_sensitive_words({{query}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 AND {{duration}} >= {{qps_alert_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{response_time_alert_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 4,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 4,
            "p2_count": 0,
            "total": 4
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_results_count}}: Integer = 5\nDEFINE {{kg_neighbor_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_a_documents}}: Integer = 2000\nDEFINE {{knowledge_base_b_documents}}: Integer = 3000\nDEFINE {{knowledge_base_c_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{qps_alert_duration_minutes}}: Integer = 10\nDEFINE {{response_time_alert_duration_minutes}}: Integer = 5\nDEFINE {{knowledge_base_a}}: Any\nDEFINE {{knowledge_base_b}}: Any\nDEFINE {{knowledge_base_c}}: Any\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{query}})\n    IF {{vector_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_results.top_n}}[{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results.top_n}}[{{reordered_results_count}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposed}} = CALL decompose_intent({{query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposed}}, {{kg_neighbor_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results.entities}} AND {{graph_results.relations}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{code}})\n        {{explanation}} = CALL generate_explanation({{analysis_results}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{query}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL upgrade_to_human_review_queue({{query}})\nENDIF\n{{knowledge_base_a}} = {{knowledge_base_a_documents}}\n{{knowledge_base_b}} = {{knowledge_base_b_documents}}\n{{knowledge_base_c}} = {{knowledge_base_c_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{query}})\nENDIF\nIF CALL check_sensitive_words({{query}}) == TRUE\n    CALL log_violation({{query}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity({{user_id}})\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 AND {{duration}} >= {{qps_alert_duration_minutes}}\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{response_time_alert_duration_minutes}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 7,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 7,
            "p2_count": 0,
            "total": 7
          }
        }
      ],
      "final_decision": "failed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 7,
        "p2_count": 0,
        "total": 7
      },
      "auto_fix_applied": true
    },
    "prompt30_success": false,
    "prompt40_id": "45ff6faa",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 0,
    "prompt40_step1_parsing": {},
    "prompt40_step2_dependency": {},
    "prompt40_step3_clustering": {},
    "prompt40_step4_generation": {},
    "prompt40_step5_orchestration": {},
    "overall_status": "partial",
    "total_time_ms": 42600,
    "error_message": null
  },
  "a1c69a65": {
    "pipeline_id": "a1c69a65",
    "timestamp": "2026-01-29 14:19:01",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "d7663320",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 839字"
        },
        "duration_ms": 15611,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 15612,
    "prompt20_id": "fbf3fae3",
    "prompt20_template": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行{{kg_neighbor_steps}}探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiry_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_a_documents}}，知识库B包含{{knowledge_base_b_documents}}，知识库C包含{{knowledge_base_c_documents}}。每个知识库都有独立的向量索引(VI)，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{response_time_vector_retrieval}}内完成，图数据库检索在{{response_time_graph_retrieval}}内完成，代码分析在{{response_time_code_analysis}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续{{low_qps_duration}}，触发告警；如果95分位响应时间超过3秒持续{{high_response_time_duration}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "kg_neighbor_steps",
        "original_text": "2跳邻居",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiry_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_a_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_b_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_c_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_vector_retrieval",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "response_time_graph_retrieval",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "response_time_code_analysis",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "low_qps_duration",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "high_response_time_duration",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "504810cc",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{kg_neighbor_steps}}: Integer = 2\nDEFINE {{cache_expiry_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_a_documents}}: Integer = 2000\nDEFINE {{knowledge_base_b_documents}}: Integer = 3000\nDEFINE {{knowledge_base_c_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_qps_duration}}: Integer = 10\nDEFINE {{high_response_time_duration}}: Integer = 5\nDEFINE {{knowledge_base_a}}: Any\nDEFINE {{knowledge_base_b}}: Any\nDEFINE {{knowledge_base_c}}: Any\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{query}})\n    IF {{vector_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_results.top_n}}[0:{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results.top_n}}[0:{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent}}, {{kg_neighbor_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results.entities}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{code}})\n        {{explanation}} = CALL generate_explanation({{analysis_results}})\n    ENDIF\nENDIF\nCALL cache_results({{query}}, {{results}}, {{cache_expiry_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{new_results}} = CALL stronger_reasoning_model({{query}})\n    RETURN {{new_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{query}})\nENDIF\nDEFINE {{knowledge_base_a}}: Any = {{knowledge_base_a_documents}}\nDEFINE {{knowledge_base_b}}: Any = {{knowledge_base_b_documents}}\nDEFINE {{knowledge_base_c}}: Any = {{knowledge_base_c_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{query}})\nENDIF\nIF CALL check_sensitive_content({{query}})\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{user_identity_verified}} = CALL verify_user_identity({{user_id}})\n    IF NOT {{user_identity_verified}}\n        RETURN \"Identity verification required\"\n    ENDIF\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 AND {{duration}} >= {{low_qps_duration}}\n    CALL trigger_alert(\"Low QPS\")\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{high_response_time_duration}}\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 27,
          "error_type": "类型错误",
          "message": "比较运算 > 仅支持数字类型，当前为 Dict 与 String",
          "suggestion": "将变量类型改为 Integer/Float，或改用 == / !=",
          "severity": "P1"
        },
        {
          "line_number": 43,
          "error_type": "未定义变量",
          "message": "配置参数 {{code_lines}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code_lines}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 44,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 44,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 46,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 46,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 47,
          "error_type": "未定义变量",
          "message": "配置参数 {{explanation}} 在使用前未定义",
          "suggestion": "在DSL开头添加: DEFINE {{explanation}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 58,
          "error_type": "重复定义",
          "message": "变量 {{knowledge_base_a}} 已在第22行定义",
          "suggestion": "删除重复定义或使用赋值语句",
          "severity": "P2"
        },
        {
          "line_number": 59,
          "error_type": "重复定义",
          "message": "变量 {{knowledge_base_b}} 已在第23行定义",
          "suggestion": "删除重复定义或使用赋值语句",
          "severity": "P2"
        },
        {
          "line_number": 60,
          "error_type": "重复定义",
          "message": "变量 {{knowledge_base_c}} 已在第24行定义",
          "suggestion": "删除重复定义或使用赋值语句",
          "severity": "P2"
        }
      ],
      "warnings": [
        "运行时变量 'query_type' 未预定义（将在运行时动态创建）",
        "运行时变量 'query' 未预定义（将在运行时动态创建）",
        "运行时变量 'vector_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'reordered_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'intent' 首次赋值（将在运行时动态创建）",
        "运行时变量 'graph_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'full_search_results' 首次赋值（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'analysis_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback' 未预定义（将在运行时动态创建）",
        "运行时变量 'new_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback_count' 未预定义（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'current_requests' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'user_id' 未预定义（将在运行时动态创建）",
        "运行时变量 'user_identity_verified' 首次赋值（将在运行时动态创建）",
        "运行时变量 'response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'qps' 未预定义（将在运行时动态创建）",
        "运行时变量 'duration' 未预定义（将在运行时动态创建）",
        "比较运算 < 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 '95th_percentile_response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确"
      ],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "kg_neighbor_steps": {
          "name": "kg_neighbor_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiry_time": {
          "name": "cache_expiry_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_a_documents": {
          "name": "knowledge_base_a_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_b_documents": {
          "name": "knowledge_base_b_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_c_documents": {
          "name": "knowledge_base_c_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "response_time_vector_retrieval": {
          "name": "response_time_vector_retrieval",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "response_time_graph_retrieval": {
          "name": "response_time_graph_retrieval",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "response_time_code_analysis": {
          "name": "response_time_code_analysis",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "low_qps_duration": {
          "name": "low_qps_duration",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "high_response_time_duration": {
          "name": "high_response_time_duration",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "knowledge_base_a": {
          "name": "knowledge_base_a",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 22
        },
        "knowledge_base_b": {
          "name": "knowledge_base_b",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 23
        },
        "knowledge_base_c": {
          "name": "knowledge_base_c",
          "var_type": "Any",
          "initial_value": null,
          "line_number": 24
        }
      },
      "runtime_variables": [
        "analysis_results",
        "graph_results",
        "intent",
        "user_feedback",
        "reordered_results",
        "vector_results",
        "new_results",
        "query_type",
        "query",
        "user_id",
        "user_feedback_count",
        "user_identity_verified",
        "duration",
        "current_requests",
        "qps",
        "response_time",
        "95th_percentile_response_time",
        "full_search_results"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "vector_results",
          "line_number": 26
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{vector_results}}"
          ],
          "result_var": "reordered_results",
          "line_number": 30
        },
        {
          "function_name": "decompose_intent",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "intent",
          "line_number": 34
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{intent}}",
            "{{kg_neighbor_steps}}"
          ],
          "result_var": "graph_results",
          "line_number": 35
        },
        {
          "function_name": "full_search",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "full_search_results",
          "line_number": 39
        },
        {
          "function_name": "static_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 44
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 46
        },
        {
          "function_name": "generate_explanation",
          "arguments": [
            "{{analysis_results}}"
          ],
          "result_var": "explanation",
          "line_number": 47
        },
        {
          "function_name": "stronger_reasoning_model",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "new_results",
          "line_number": 52
        },
        {
          "function_name": "verify_user_identity",
          "arguments": [
            "{{user_id}}"
          ],
          "result_var": "user_identity_verified",
          "line_number": 68
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 36887,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{kg_neighbor_steps}}: Integer = 2\nDEFINE {{cache_expiry_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_a_documents}}: Integer = 2000\nDEFINE {{knowledge_base_b_documents}}: Integer = 3000\nDEFINE {{knowledge_base_c_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_qps_duration}}: Integer = 10\nDEFINE {{high_response_time_duration}}: Integer = 5\nIF {{query_type}} == \"简单事实查询\"\n    {{similarity}} = CALL vector_retrieval({{query}})\n    IF {{similarity}} > {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"复杂推理查询\"\n    {{intent}} = CALL intent_decomposition({{query}})\n    {{results}} = CALL graph_database_retrieval({{intent}}, {{kg_neighbor_steps}})\n    IF {{results}} == \"无匹配\"\n        {{results}} = CALL full_search({{query}})\n    ENDIF\nELIF {{query_type}} == \"代码相关问题\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{code}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiry_time}})\nIF {{user_feedback}} == \"不满意\"\n    {{results}} = CALL regenerate_results()\n    IF {{feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{concurrent_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{query_content}} == \"违规\"\n    CALL reject_service()\n    CALL log_violation()\nENDIF\nIF {{query_type}} == \"金融类查询\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs()",
          "total_errors": 5,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 5,
            "p2_count": 0,
            "total": 5
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{kg_neighbor_steps}}: Integer = 2\nDEFINE {{cache_expiry_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_a_documents}}: Integer = 2000\nDEFINE {{knowledge_base_b_documents}}: Integer = 3000\nDEFINE {{knowledge_base_c_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_qps_duration}}: Integer = 10\nDEFINE {{high_response_time_duration}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nDEFINE {{code}}: String\nDEFINE {{user_feedback}}: Boolean\nDEFINE {{user_priority}}: Integer\nDEFINE {{query_type}}: String\nDEFINE {{result}}: Any\nIF {{query_type}} == \"简单事实查询\"\n    {{similarity}} = CALL vector_retrieval({{query}})\n    IF {{similarity}} > {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"复杂推理查询\"\n    CALL intent_decomposition({{query}})\n    {{graph_results}} = CALL graph_database_retrieval({{kg_neighbor_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"代码相关问题\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{code}})\n    ELSE\n        {{analysis_result}} = CALL semantic_analysis({{code}})\n        RETURN CALL generate_explanation_document({{analysis_result}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"不满意\"\n    CALL regenerate_with_stronger_model()\n    {{unsatisfied_count}} = {{unsatisfied_count}} + 1\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\n{{knowledge_base_a}} = {{knowledge_base_a_documents}}\n{{knowledge_base_b}} = {{knowledge_base_b_documents}}\n{{knowledge_base_c}} = {{knowledge_base_c_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL check_sensitive_words({{query}})\n    RETURN CALL reject_service()\nENDIF\nIF {{response_time_vector_retrieval}} > {{response_time_vector_retrieval}} OR \n   {{response_time_graph_retrieval}} > {{response_time_graph_retrieval}} OR \n   {{response_time_code_analysis}} > {{response_time_code_analysis}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 AND {{low_qps_duration}} >= 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{high_response_time_duration}} >= 5\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 3,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 3,
            "p2_count": 0,
            "total": 3
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{kg_neighbor_steps}}: Integer = 2\nDEFINE {{cache_expiry_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_a_documents}}: Integer = 2000\nDEFINE {{knowledge_base_b_documents}}: Integer = 3000\nDEFINE {{knowledge_base_c_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_qps_duration}}: Integer = 10\nDEFINE {{high_response_time_duration}}: Integer = 5\nDEFINE {{knowledge_base_a}}: Any\nDEFINE {{knowledge_base_b}}: Any\nDEFINE {{knowledge_base_c}}: Any\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{query}})\n    IF {{vector_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_results.top_n}}[0:{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results.top_n}}[0:{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent}}, {{kg_neighbor_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results.entities}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{code}})\n        {{explanation}} = CALL generate_explanation({{analysis_results}})\n    ENDIF\nENDIF\nCALL cache_results({{query}}, {{results}}, {{cache_expiry_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{new_results}} = CALL stronger_reasoning_model({{query}})\n    RETURN {{new_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{query}})\nENDIF\nDEFINE {{knowledge_base_a}}: Any = {{knowledge_base_a_documents}}\nDEFINE {{knowledge_base_b}}: Any = {{knowledge_base_b_documents}}\nDEFINE {{knowledge_base_c}}: Any = {{knowledge_base_c_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{query}})\nENDIF\nIF CALL check_sensitive_content({{query}})\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{user_identity_verified}} = CALL verify_user_identity({{user_id}})\n    IF NOT {{user_identity_verified}}\n        RETURN \"Identity verification required\"\n    ENDIF\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 AND {{duration}} >= {{low_qps_duration}}\n    CALL trigger_alert(\"Low QPS\")\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= {{high_response_time_duration}}\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 10,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 7,
            "p2_count": 3,
            "total": 10
          }
        }
      ],
      "final_decision": "failed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 7,
        "p2_count": 3,
        "total": 10
      },
      "auto_fix_applied": true
    },
    "prompt30_success": false,
    "prompt40_id": "0314b1d2",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 0,
    "prompt40_step1_parsing": {},
    "prompt40_step2_dependency": {},
    "prompt40_step3_clustering": {},
    "prompt40_step4_generation": {},
    "prompt40_step5_orchestration": {},
    "overall_status": "partial",
    "total_time_ms": 52499,
    "error_message": null
  },
  "a23035df": {
    "pipeline_id": "a23035df",
    "timestamp": "2026-01-29 16:44:51",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "cd2894cf",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 818字"
        },
        "duration_ms": 14261,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 14262,
    "prompt20_id": "c37b7c02",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{vector_similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{alert_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{alert_duration_response_time_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "vector_similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_response_time_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "7e59fa75",
    "prompt30_dsl_code": "DEFINE {{vector_similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nDEFINE {{user_query}}: String\nDEFINE {{query_type}}: String\nDEFINE {{vector_results}}: List\nDEFINE {{matched_nodes}}: List\nDEFINE {{code}}: String\nDEFINE {{response_time}}: Integer\nDEFINE {{user_feedback}}: Boolean\nDEFINE {{retry_count}}: Integer = 0\n{{query_type}} = CALL determine_query_type({{user_query}})\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{user_query}})\n    IF {{vector_results}}.similarity > {{vector_similarity_threshold}}\n        RETURN {{vector_results}}[0:{{top_n_vector_results}}]\n    ELSE\n        {{vector_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{vector_results}}[0:{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{matched_nodes}} = CALL intent_decomposition({{user_query}})\n    {{matched_nodes}} = CALL graph_database_retrieval({{matched_nodes}}, {{graph_exploration_steps}})\n    IF {{matched_nodes}}.found\n        RETURN {{matched_nodes}}\n    ELSE\n        {{matched_nodes}} = CALL full_search({{user_query}})\n        RETURN {{matched_nodes}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{response_time}} = CALL analyze_code({{code}})\n    IF {{code}}.lines > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{code}})\n    ELSE\n        RETURN CALL semantic_analysis({{code}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"unsatisfied\"\n    {{retry_count}} = {{retry_count}} + 1\n    IF {{retry_count}} >= 3\n        CALL escalate_to_human_review()\n    ELSE\n        CALL stronger_reasoning_model()\n    ENDIF\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_query}})\n    CALL log_violation({{user_query}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'current_requests' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'query_rate' 未预定义（将在运行时动态创建）",
        "比较运算 < 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 '95th_percentile_response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确"
      ],
      "defined_variables": {
        "vector_similarity_threshold": {
          "name": "vector_similarity_threshold",
          "var_type": "String",
          "initial_value": "\"0.85\"",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "graph_exploration_steps": {
          "name": "graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_documents": {
          "name": "knowledge_base_A_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_documents": {
          "name": "knowledge_base_B_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_documents": {
          "name": "knowledge_base_C_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time": {
          "name": "vector_retrieval_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "alert_duration_minutes": {
          "name": "alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "alert_duration_response_time_minutes": {
          "name": "alert_duration_response_time_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "user_query": {
          "name": "user_query",
          "var_type": "String",
          "initial_value": null,
          "line_number": 22
        },
        "query_type": {
          "name": "query_type",
          "var_type": "String",
          "initial_value": null,
          "line_number": 23
        },
        "vector_results": {
          "name": "vector_results",
          "var_type": "List",
          "initial_value": null,
          "line_number": 24
        },
        "matched_nodes": {
          "name": "matched_nodes",
          "var_type": "List",
          "initial_value": null,
          "line_number": 25
        },
        "code": {
          "name": "code",
          "var_type": "String",
          "initial_value": null,
          "line_number": 26
        },
        "response_time": {
          "name": "response_time",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 27
        },
        "user_feedback": {
          "name": "user_feedback",
          "var_type": "Boolean",
          "initial_value": null,
          "line_number": 28
        },
        "retry_count": {
          "name": "retry_count",
          "var_type": "Integer",
          "initial_value": "0",
          "line_number": 29
        }
      },
      "runtime_variables": [
        "current_requests",
        "95th_percentile_response_time",
        "query_rate"
      ],
      "function_calls": [
        {
          "function_name": "determine_query_type",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "query_type",
          "line_number": 30
        },
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "vector_results",
          "line_number": 32
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{vector_results}}"
          ],
          "result_var": "vector_results",
          "line_number": 36
        },
        {
          "function_name": "intent_decomposition",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "matched_nodes",
          "line_number": 40
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{matched_nodes}}",
            "{{graph_exploration_steps}}"
          ],
          "result_var": "matched_nodes",
          "line_number": 41
        },
        {
          "function_name": "full_search",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "matched_nodes",
          "line_number": 45
        },
        {
          "function_name": "analyze_code",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "response_time",
          "line_number": 49
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 41875,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_code}})\n    ELSE\n        RETURN CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model}} = CALL activate_stronger_reasoning_model()\nENDIF\nIF {{unsatisfied_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_documents}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_documents}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL check_sensitive_content({{user_query}})\n    RETURN CALL reject_service()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR 10 MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR 5 MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nDEFINE {{stronger_model}}: Any\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{query}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{query}})\n    {{graph_results}} = CALL graph_database_retrieval({{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    DEFINE {{code_lines}} = CALL count_code_lines({{code}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{code}})\n    ELSE\n        RETURN CALL semantic_analysis({{code}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    RETURN CALL generate_with_stronger_model({{stronger_model}})\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_documents}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_documents}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{query}})\n    CALL log_violation({{query}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 3,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 1,
            "total": 3
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nDEFINE {{user_query}}: String\nDEFINE {{query_type}}: String\nDEFINE {{vector_results}}: List\nDEFINE {{matched_nodes}}: List\nDEFINE {{code}}: String\nDEFINE {{response_time}}: Integer\nDEFINE {{user_feedback}}: Boolean\nDEFINE {{retry_count}}: Integer = 0\n{{query_type}} = CALL determine_query_type({{user_query}})\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{user_query}})\n    IF {{vector_results}}.similarity > {{vector_similarity_threshold}}\n        RETURN {{vector_results}}[0:{{top_n_vector_results}}]\n    ELSE\n        {{vector_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{vector_results}}[0:{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{matched_nodes}} = CALL intent_decomposition({{user_query}})\n    {{matched_nodes}} = CALL graph_database_retrieval({{matched_nodes}}, {{graph_exploration_steps}})\n    IF {{matched_nodes}}.found\n        RETURN {{matched_nodes}}\n    ELSE\n        {{matched_nodes}} = CALL full_search({{user_query}})\n        RETURN {{matched_nodes}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{response_time}} = CALL analyze_code({{code}})\n    IF {{code}}.lines > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{code}})\n    ELSE\n        RETURN CALL semantic_analysis({{code}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"unsatisfied\"\n    {{retry_count}} = {{retry_count}} + 1\n    IF {{retry_count}} >= 3\n        CALL escalate_to_human_review()\n    ELSE\n        CALL stronger_reasoning_model()\n    ENDIF\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_query}})\n    CALL log_violation({{user_query}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 0,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 0,
            "total": 0
          }
        }
      ],
      "final_decision": "success",
      "error_summary": {},
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "a3ffedb4",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 17,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 9 个错误：\n  ❌ step_3_reorder_results: 语法错误 - invalid syntax (行 3)\n  ❌ step_5_intent_decomposition: 语法错误 - invalid syntax (行 3)\n  ❌ step_6_full_search: 语法错误 - invalid syntax (行 3)\n  ❌ step_8_analyze_code: 语法错误 - invalid syntax (行 3)\n  ❌ step_14_log_violation: 语法错误 - invalid syntax (行 3)\n  ❌ step_21_compute_{{matched_nodes}}: 语法错误 - expected '(' (行 1)\n  ❌ step_22_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_23_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)\n  ❌ step_24_process: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "success",
    "total_time_ms": 56154,
    "error_message": null
  },
  "147ed5d6": {
    "pipeline_id": "147ed5d6",
    "timestamp": "2026-01-30 09:56:41",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "cb909431",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 818字"
        },
        "duration_ms": 11792,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 11793,
    "prompt20_id": "c98af427",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{query_rate_threshold}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{response_time_vector_retrieval}}内完成，图数据库检索在{{response_time_graph_retrieval}}内完成，代码分析在{{response_time_code_analysis}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续{{high_response_time_duration}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "query_rate_threshold",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_vector_retrieval",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "response_time_graph_retrieval",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "response_time_code_analysis",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "high_response_time_duration",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 20,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 19
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "662b9f63",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: Float = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{query_rate_threshold}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{high_response_time_duration}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{query}})\n    IF {{vector_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_results.top_n}}[0:{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results}}[0:{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposition}} = CALL decompose_intent({{query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposition}}, {{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{static_analysis_results}} = CALL static_analysis({{code}})\n        RETURN {{static_analysis_results}}\n    ELSE\n        {{semantic_analysis_results}} = CALL semantic_analysis({{code}})\n        {{explanation_document}} = CALL generate_explanation({{semantic_analysis_results}})\n        RETURN {{explanation_document}}\n    ENDIF\nENDIF\nCALL cache_results({{query}}, {{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{query}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{query}})\nENDIF\nDEFINE {{knowledge_base_A}}: Dict = {\"documents\": {{knowledge_base_A_documents}}}\nDEFINE {{knowledge_base_B}}: Dict = {\"documents\": {{knowledge_base_B_documents}}}\nDEFINE {{knowledge_base_C}}: Dict = {\"documents\": {{knowledge_base_C_documents}}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{query}})\nENDIF\nIF CALL check_sensitive_words({{query}}) == TRUE\n    CALL log_violation({{query}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{identity_confirmation}} = CALL confirm_identity({{user}})\n    IF {{identity_confirmation}} == FALSE\n        RETURN \"Identity Confirmation Required\"\n    ENDIF\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < {{query_rate_threshold}} AND {{duration}} >= 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > {{total_response_time_limit}} AND {{duration}} >= 5\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 23,
          "error_type": "类型错误",
          "message": "比较运算 > 仅支持数字类型，当前为 Dict 与 Float",
          "suggestion": "将变量类型改为 Integer/Float，或改用 == / !=",
          "severity": "P1"
        },
        {
          "line_number": 39,
          "error_type": "未定义变量",
          "message": "配置参数 {{code_lines}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code_lines}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 40,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 40,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 43,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 43,
          "error_type": "未定义变量",
          "message": "配置参数 {{code}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{code}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 44,
          "error_type": "未定义变量",
          "message": "配置参数 {{explanation_document}} 在使用前未定义",
          "suggestion": "在DSL开头添加: DEFINE {{explanation_document}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 45,
          "error_type": "未定义变量",
          "message": "配置参数 {{explanation_document}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{explanation_document}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 67,
          "error_type": "未定义变量",
          "message": "配置参数 {{identity_confirmation}} 在使用前未定义",
          "suggestion": "在DSL开头添加: DEFINE {{identity_confirmation}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 68,
          "error_type": "未定义变量",
          "message": "配置参数 {{identity_confirmation}} 未在Prompt 2.0中提取",
          "suggestion": "在Prompt 2.0阶段提取此参数，或在DSL开头添加: DEFINE {{identity_confirmation}}: Type",
          "severity": "P1"
        }
      ],
      "warnings": [
        "运行时变量 'query_type' 未预定义（将在运行时动态创建）",
        "运行时变量 'query' 未预定义（将在运行时动态创建）",
        "运行时变量 'vector_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'reordered_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'intent_decomposition' 首次赋值（将在运行时动态创建）",
        "运行时变量 'graph_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'full_search_results' 首次赋值（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'static_analysis_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'semantic_analysis_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback' 未预定义（将在运行时动态创建）",
        "运行时变量 'stronger_model_results' 首次赋值（将在运行时动态创建）",
        "运行时变量 'user_feedback_count' 未预定义（将在运行时动态创建）",
        "比较运算 >= 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'current_requests' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'user' 未预定义（将在运行时动态创建）",
        "运行时变量 'response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 'query_rate' 未预定义（将在运行时动态创建）",
        "运行时变量 'duration' 未预定义（将在运行时动态创建）",
        "比较运算 < 涉及运行时变量（类型将在运行时确定），请确保逻辑正确",
        "运行时变量 '95th_percentile_response_time' 未预定义（将在运行时动态创建）",
        "比较运算 > 涉及运行时变量（类型将在运行时确定），请确保逻辑正确"
      ],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "Float",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "graph_exploration_steps": {
          "name": "graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_documents": {
          "name": "knowledge_base_A_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_documents": {
          "name": "knowledge_base_B_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_documents": {
          "name": "knowledge_base_C_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "query_rate_threshold": {
          "name": "query_rate_threshold",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "response_time_vector_retrieval": {
          "name": "response_time_vector_retrieval",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "response_time_graph_retrieval": {
          "name": "response_time_graph_retrieval",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "response_time_code_analysis": {
          "name": "response_time_code_analysis",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "high_response_time_duration": {
          "name": "high_response_time_duration",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 20
        },
        "knowledge_base_A": {
          "name": "knowledge_base_A",
          "var_type": "Dict",
          "initial_value": "{\"documents\": {{knowledge_base_A_documents}}}",
          "line_number": 56
        },
        "knowledge_base_B": {
          "name": "knowledge_base_B",
          "var_type": "Dict",
          "initial_value": "{\"documents\": {{knowledge_base_B_documents}}}",
          "line_number": 57
        },
        "knowledge_base_C": {
          "name": "knowledge_base_C",
          "var_type": "Dict",
          "initial_value": "{\"documents\": {{knowledge_base_C_documents}}}",
          "line_number": 58
        }
      },
      "runtime_variables": [
        "stronger_model_results",
        "semantic_analysis_results",
        "query",
        "vector_results",
        "user_feedback_count",
        "user",
        "intent_decomposition",
        "graph_results",
        "user_feedback",
        "95th_percentile_response_time",
        "query_type",
        "full_search_results",
        "current_requests",
        "reordered_results",
        "response_time",
        "query_rate",
        "duration",
        "static_analysis_results"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "vector_results",
          "line_number": 22
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{vector_results}}"
          ],
          "result_var": "reordered_results",
          "line_number": 26
        },
        {
          "function_name": "decompose_intent",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "intent_decomposition",
          "line_number": 30
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{intent_decomposition}}",
            "{{graph_exploration_steps}}"
          ],
          "result_var": "graph_results",
          "line_number": 31
        },
        {
          "function_name": "full_search",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "full_search_results",
          "line_number": 35
        },
        {
          "function_name": "static_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "static_analysis_results",
          "line_number": 40
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "semantic_analysis_results",
          "line_number": 43
        },
        {
          "function_name": "generate_explanation",
          "arguments": [
            "{{semantic_analysis_results}}"
          ],
          "result_var": "explanation_document",
          "line_number": 44
        },
        {
          "function_name": "stronger_reasoning_model",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "stronger_model_results",
          "line_number": 50
        },
        {
          "function_name": "confirm_identity",
          "arguments": [
            "{{user}}"
          ],
          "result_var": "identity_confirmation",
          "line_number": 67
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 23219,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{query_rate_threshold}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{high_response_time_duration}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{user_query}})\n    IF {{vector_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_results.top_n}} \n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results.top_n}}\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposed}} = CALL decompose_intent({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposed}}, {{graph_exploration_steps}})\n    IF {{graph_results.has_matching_nodes}}\n        RETURN {{graph_results.entities_and_relationships}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{user_query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{static_analysis_results}} = CALL static_analysis({{user_code}})\n        RETURN {{static_analysis_results}}\n    ELSE\n        {{semantic_analysis_results}} = CALL semantic_analysis({{user_code}})\n        {{explanation_document}} = CALL generate_explanation({{semantic_analysis_results}})\n        RETURN {{explanation_document}}\n    ENDIF\nENDIF\n{{cache_results}} = CALL cache_results({{user_query}}, {{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{user_query}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{user_query}})\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_documents}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_documents}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_documents}}\nIF {{current_concurrent_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_query}})\nENDIF\nIF {{contains_sensitive_content}} == TRUE\n    CALL reject_service({{user_query}})\n    CALL log_violation({{user_query}})\nENDIF\nIF {{is_financial_query}} == TRUE\n    {{user_identity_confirmed}} = CALL confirm_user_identity({{user_query}})\n    IF {{user_identity_confirmed}} == FALSE\n        CALL reject_service({{user_query}})\n    ENDIF\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < {{query_rate_threshold}} AND {{duration}} >= 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > {{total_response_time_limit}} AND {{duration}} >= 5\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 5,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 5,
            "p2_count": 0,
            "total": 5
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = \"0.85\"\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{query_rate_threshold}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{high_response_time_duration}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nDEFINE {{explanation_document}}: String\nDEFINE {{contains_sensitive_content}}: Boolean\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{user_query}})\n    IF {{vector_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_results.top_n}}[0:{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results.top_n}}[0:{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposition}} = CALL decompose_intent({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposition}}, {{graph_exploration_steps}})\n    IF {{graph_results.has_matches}}\n        RETURN {{graph_results.entities}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{user_query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = CALL get_code_lines({{user_query}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{static_analysis_results}} = CALL static_analysis({{user_query}})\n        RETURN {{static_analysis_results}}\n    ELSE\n        {{explanation_document}} = CALL semantic_analysis({{user_query}})\n        RETURN {{explanation_document}}\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{user_query}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{user_query}})\nENDIF\nIF {{contains_sensitive_content}} == TRUE\n    CALL log_violation({{user_query}})\n    RETURN \"Service denied due to sensitive content.\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity({{user_query}})\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs()",
          "total_errors": 1,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 1,
            "p2_count": 0,
            "total": 1
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{similarity_threshold}}: Float = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{query_rate_threshold}}: Integer = 10\nDEFINE {{response_time_vector_retrieval}}: Integer = 500\nDEFINE {{response_time_graph_retrieval}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{high_response_time_duration}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{query}})\n    IF {{vector_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_results.top_n}}[0:{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results}}[0:{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposition}} = CALL decompose_intent({{query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposition}}, {{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{static_analysis_results}} = CALL static_analysis({{code}})\n        RETURN {{static_analysis_results}}\n    ELSE\n        {{semantic_analysis_results}} = CALL semantic_analysis({{code}})\n        {{explanation_document}} = CALL generate_explanation({{semantic_analysis_results}})\n        RETURN {{explanation_document}}\n    ENDIF\nENDIF\nCALL cache_results({{query}}, {{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{query}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{query}})\nENDIF\nDEFINE {{knowledge_base_A}}: Dict = {\"documents\": {{knowledge_base_A_documents}}}\nDEFINE {{knowledge_base_B}}: Dict = {\"documents\": {{knowledge_base_B_documents}}}\nDEFINE {{knowledge_base_C}}: Dict = {\"documents\": {{knowledge_base_C_documents}}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{query}})\nENDIF\nIF CALL check_sensitive_words({{query}}) == TRUE\n    CALL log_violation({{query}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{identity_confirmation}} = CALL confirm_identity({{user}})\n    IF {{identity_confirmation}} == FALSE\n        RETURN \"Identity Confirmation Required\"\n    ENDIF\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < {{query_rate_threshold}} AND {{duration}} >= 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > {{total_response_time_limit}} AND {{duration}} >= 5\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 10,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 10,
            "p2_count": 0,
            "total": 10
          }
        }
      ],
      "final_decision": "failed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 10,
        "p2_count": 0,
        "total": 10
      },
      "auto_fix_applied": true
    },
    "prompt30_success": false,
    "prompt40_id": "79a28dab",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 0,
    "prompt40_step1_parsing": {},
    "prompt40_step2_dependency": {},
    "prompt40_step3_clustering": {},
    "prompt40_step4_generation": {},
    "prompt40_step5_orchestration": {},
    "overall_status": "partial",
    "total_time_ms": 35012,
    "error_message": null
  },
  "c81c5caa": {
    "pipeline_id": "c81c5caa",
    "timestamp": "2026-01-30 13:16:09",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "8b998fc8",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 2,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 2,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 818字"
        },
        "duration_ms": 17446,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 17450,
    "prompt20_id": "d8c858a4",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_search}}；否则结合重排序模型重新评分，再返回{{top_n_reordered_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{knowledge_graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_search_response_time_limit}}内完成，图数据库检索在{{graph_database_response_time_limit}}内完成，代码分析在{{code_analysis_response_time_limit}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{alert_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{alert_duration_minutes_95th_percentile}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_search",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "top_n_reordered_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "knowledge_graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_search_response_time_limit",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time_limit",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time_limit",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_minutes_95th_percentile",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "0657e81f",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_search_response_time_limit}}: Integer = 500\nDEFINE {{graph_database_response_time_limit}}: Integer = 1\nDEFINE {{code_analysis_response_time_limit}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_minutes_95th_percentile}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nDEFINE {{current_requests}}: Integer\nDEFINE {{query_rate}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\nIF {{query_type}} == \"简单事实查询\"\n    {{similarity}} = CALL vector_search({{query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"复杂推理查询\"\n    CALL intent_decomposition({{query}})\n    {{graph_results}} = CALL graph_database_search({{knowledge_graph_exploration_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        {{results}} = {{graph_results}}\n    ELSE\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"代码相关问题\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{code}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"不满意\"\n    CALL regenerate_response()\n    IF {{regenerate_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{query_content}} CONTAINS \"敏感词\"\n    CALL reject_service()\n    CALL log_error()\nENDIF\nIF {{query_type}} == \"金融类查询\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_search": {
          "name": "top_n_vector_search",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "top_n_reordered_results": {
          "name": "top_n_reordered_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "knowledge_graph_exploration_steps": {
          "name": "knowledge_graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_documents": {
          "name": "knowledge_base_A_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_documents": {
          "name": "knowledge_base_B_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_documents": {
          "name": "knowledge_base_C_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_search_response_time_limit": {
          "name": "vector_search_response_time_limit",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time_limit": {
          "name": "graph_database_response_time_limit",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time_limit": {
          "name": "code_analysis_response_time_limit",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "alert_duration_minutes": {
          "name": "alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "alert_duration_minutes_95th_percentile": {
          "name": "alert_duration_minutes_95th_percentile",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "code_lines": {
          "name": "code_lines",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 22
        },
        "current_requests": {
          "name": "current_requests",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 23
        },
        "query_rate": {
          "name": "query_rate",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 24
        },
        "95th_percentile_response_time": {
          "name": "95th_percentile_response_time",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 25
        }
      },
      "runtime_variables": [
        "similarity",
        "response_time",
        "query_content",
        "user_feedback",
        "regenerate_count",
        "query",
        "analysis_results",
        "results",
        "query_type",
        "code",
        "graph_results"
      ],
      "function_calls": [
        {
          "function_name": "vector_search",
          "arguments": [
            "{{query}}"
          ],
          "result_var": "similarity",
          "line_number": 27
        },
        {
          "function_name": "return_top_n_results",
          "arguments": [
            "{{top_n_vector_search}}"
          ],
          "result_var": "results",
          "line_number": 29
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{top_n_reordered_results}}"
          ],
          "result_var": "results",
          "line_number": 31
        },
        {
          "function_name": "graph_database_search",
          "arguments": [
            "{{knowledge_graph_exploration_steps}}"
          ],
          "result_var": "graph_results",
          "line_number": 35
        },
        {
          "function_name": "full_search",
          "arguments": [],
          "result_var": "results",
          "line_number": 39
        },
        {
          "function_name": "static_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 43
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 45
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 18276,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_search_response_time_limit}}: Integer = 500\nDEFINE {{graph_database_response_time_limit}}: Integer = 1\nDEFINE {{code_analysis_response_time_limit}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_minutes_95th_percentile}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{vector_search_results}} = CALL vector_search({{user_query}})\n    IF {{vector_search_results.similarity}} > {{similarity_threshold}}\n        RETURN {{vector_search_results.top_n}} \n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_search_results}})\n        RETURN {{reordered_results.top_n}}\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposition}} = CALL decompose_intent({{user_query}})\n    {{graph_database_results}} = CALL graph_database_search({{intent_decomposition}}, {{knowledge_graph_exploration_steps}})\n    IF {{graph_database_results}} IS NOT EMPTY\n        RETURN {{graph_database_results}}\n    ELSE\n        {{full_search_results}} = CALL full_search({{user_query}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{static_analysis_results}} = CALL static_analysis({{user_code}})\n        RETURN {{static_analysis_results}}\n    ELSE\n        {{semantic_analysis_results}} = CALL semantic_analysis({{user_code}})\n        RETURN {{semantic_analysis_results}}\n    ENDIF\nENDIF\n{{cache_result}} = CALL cache_results({{query_id}}, {{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{user_query}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{user_query}})\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_documents}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_documents}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_query}})\nENDIF\nIF CALL check_sensitive_content({{user_query}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity({{user_id}})\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 4,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 4,
            "p2_count": 0,
            "total": 4
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_search_response_time_limit}}: Integer = 500\nDEFINE {{graph_database_response_time_limit}}: Integer = 1\nDEFINE {{code_analysis_response_time_limit}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_minutes_95th_percentile}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nDEFINE {{current_requests}}: Integer\nDEFINE {{query_rate}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\nIF {{query_type}} == \"简单事实查询\"\n    {{similarity}} = CALL vector_search({{query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"复杂推理查询\"\n    CALL intent_decomposition({{query}})\n    {{graph_results}} = CALL graph_database_search({{knowledge_graph_exploration_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        {{results}} = {{graph_results}}\n    ELSE\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"代码相关问题\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{code}})\n    ENDIF\nENDIF\nIF {{user_feedback}} == \"不满意\"\n    CALL regenerate_response()\n    IF {{regenerate_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{query_content}} CONTAINS \"敏感词\"\n    CALL reject_service()\n    CALL log_error()\nENDIF\nIF {{query_type}} == \"金融类查询\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 0,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 0,
            "total": 0
          }
        }
      ],
      "final_decision": "success",
      "error_summary": {},
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "c3505ca2",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 17,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 3 个错误：\n  ❌ step_3_intent_decomposition: 语法错误 - invalid syntax (行 3)\n  ❌ step_5_process: 语法错误 - invalid syntax (行 3)\n  ❌ step_12_reject_service: 语法错误 - invalid syntax (行 3)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "success",
    "total_time_ms": 35743,
    "error_message": null
  },
  "7d755fe8": {
    "pipeline_id": "7d755fe8",
    "timestamp": "2026-01-30 13:33:34",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "7fd82da2",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 838字"
        },
        "duration_ms": 15608,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 15609,
    "prompt20_id": "124f0c18",
    "prompt20_template": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_search}}；否则结合重排序模型重新评分，再返回{{top_n_reordered_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱(KG)进行{{knowledge_graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_size}}，知识库B包含{{knowledge_base_B_size}}，知识库C包含{{knowledge_base_C_size}}。每个知识库都有独立的向量索引(VI)，向量维度统一为{{vector_index_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{priority_admin_user}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{response_time_vector_search}}内完成，图数据库检索在{{response_time_graph_database}}内完成，代码分析在{{response_time_code_analysis}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续{{qps_alert_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{response_time_alert_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_search",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "top_n_reordered_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "knowledge_graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_size",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_size",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_size",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_index_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "priority_admin_user",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_vector_search",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "response_time_graph_database",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "response_time_code_analysis",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "qps_alert_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_alert_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "ca2cb01c",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_index_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{priority_admin_user}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_database}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{qps_alert_duration_minutes}}: Integer = 10\nDEFINE {{response_time_alert_duration_minutes}}: Integer = 5\nDEFINE {{95th_percentile_response_time}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{results}} = CALL vector_search({{user_query}})\n    IF {{results.similarity}} > {{similarity_threshold}}\n        RETURN {{results.top_n}} = {{top_n_vector_search}}\n    ELSE\n        {{results}} = CALL reorder_results({{results}})\n        RETURN {{results.top_n}} = {{top_n_reordered_results}}\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_search({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} IS NOT EMPTY\n        RETURN {{results}}\n    ELSE\n        {{results}} = CALL full_search({{user_query}})\n        RETURN {{results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{code}})\n        {{explanation}} = CALL generate_explanation({{analysis_results}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"unsatisfied\"\n    {{new_results}} = CALL stronger_reasoning_model({{user_query}})\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review({{user_query}})\n    ENDIF\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_query}})\nENDIF\nIF {{query_content}} CONTAINS \"sensitive_word\"\n    CALL log_violation({{query_content}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{confirmation}} = CALL confirm_user_identity({{user_id}})\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 FOR {{qps_alert_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{response_time_alert_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 41,
          "error_type": "未定义变量",
          "message": "配置参数 {{code_lines}} 未定义",
          "suggestion": "在DSL开头添加: DEFINE {{code_lines}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 55,
          "error_type": "未定义变量",
          "message": "配置参数 {{current_requests}} 未定义",
          "suggestion": "在DSL开头添加: DEFINE {{current_requests}}: Type",
          "severity": "P1"
        }
      ],
      "warnings": [],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_search": {
          "name": "top_n_vector_search",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "top_n_reordered_results": {
          "name": "top_n_reordered_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "knowledge_graph_exploration_steps": {
          "name": "knowledge_graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_size": {
          "name": "knowledge_base_A_size",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_size": {
          "name": "knowledge_base_B_size",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_size": {
          "name": "knowledge_base_C_size",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_index_dimension": {
          "name": "vector_index_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "priority_admin_user": {
          "name": "priority_admin_user",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "response_time_vector_search": {
          "name": "response_time_vector_search",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "response_time_graph_database": {
          "name": "response_time_graph_database",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "response_time_code_analysis": {
          "name": "response_time_code_analysis",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "qps_alert_duration_minutes": {
          "name": "qps_alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "response_time_alert_duration_minutes": {
          "name": "response_time_alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "95th_percentile_response_time": {
          "name": "95th_percentile_response_time",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 22
        }
      },
      "runtime_variables": [
        "unsatisfied_count",
        "results",
        "query_type",
        "response_time",
        "user_feedback",
        "analysis_results",
        "user_id",
        "explanation",
        "query_content",
        "code",
        "cache",
        "confirmation",
        "user_query",
        "new_results",
        "qps",
        "intent"
      ],
      "function_calls": [
        {
          "function_name": "vector_search",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "results",
          "line_number": 24
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{results}}"
          ],
          "result_var": "results",
          "line_number": 28
        },
        {
          "function_name": "decompose_intent",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "intent",
          "line_number": 32
        },
        {
          "function_name": "graph_database_search",
          "arguments": [
            "{{intent}}",
            "{{knowledge_graph_exploration_steps}}"
          ],
          "result_var": "results",
          "line_number": 33
        },
        {
          "function_name": "full_search",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "results",
          "line_number": 37
        },
        {
          "function_name": "static_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 42
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{code}}"
          ],
          "result_var": "analysis_results",
          "line_number": 44
        },
        {
          "function_name": "generate_explanation",
          "arguments": [
            "{{analysis_results}}"
          ],
          "result_var": "explanation",
          "line_number": 45
        },
        {
          "function_name": "cache_results",
          "arguments": [
            "{{results}}",
            "{{cache_expiration_time}}"
          ],
          "result_var": "cache",
          "line_number": 48
        },
        {
          "function_name": "stronger_reasoning_model",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "new_results",
          "line_number": 50
        },
        {
          "function_name": "confirm_user_identity",
          "arguments": [
            "{{user_id}}"
          ],
          "result_var": "confirmation",
          "line_number": 63
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 22531,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_index_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{priority_admin_user}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_database}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{qps_alert_duration_minutes}}: Integer = 10\nDEFINE {{response_time_alert_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"简单事实查询\"\n    {{similarity}} = CALL vector_search({{user_query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"复杂推理查询\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_search({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} == \"无匹配\"\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"代码相关问题\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{user_code}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{user_code}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"不满意\"\n    {{retry}} = CALL enable_stronger_model()\n    IF {{retry_count}} >= 3\n        {{queue}} = CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{concurrent_requests}} > {{max_concurrent_requests}}\n    {{queue}} = CALL queue_requests()\nENDIF\nIF {{query_content}} == \"违规\"\n    CALL reject_service()\n    CALL log_violation()\nENDIF\nIF {{query_type}} == \"金融类查询\"\n    {{confirmation}} = CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs()",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_index_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{priority_admin_user}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_database}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{qps_alert_duration_minutes}}: Integer = 10\nDEFINE {{response_time_alert_duration_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nDEFINE {{concurrent_requests}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_search({{user_query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_search}})\n    ELSE\n        {{results}} = CALL reorder_results({{top_n_reordered_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_search({{intent}}, {{knowledge_graph_exploration_steps}})\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = CALL get_code_lines({{user_query}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{results}} = CALL static_analysis({{user_query}})\n    ELSE\n        {{results}} = CALL semantic_analysis({{user_query}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{results}} == \"not_found\"\n    {{results}} = CALL hybrid_search({{user_query}})\nENDIF\nIF {{user_feedback}} == \"unsatisfied\"\n    {{results}} = CALL regenerate_results({{user_query}})\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{concurrent_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_query}})\nENDIF\nIF {{query_content}} == \"sensitive\"\n    CALL log_violation({{user_query}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time_vector_search}} > {{response_time_alert_duration_minutes}}\n    CALL downgrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 1,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 1,
            "p2_count": 0,
            "total": 1
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_search}}: Integer = 3\nDEFINE {{top_n_reordered_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_index_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{priority_admin_user}}: Integer = 10\nDEFINE {{response_time_vector_search}}: Integer = 500\nDEFINE {{response_time_graph_database}}: Integer = 1\nDEFINE {{response_time_code_analysis}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{qps_alert_duration_minutes}}: Integer = 10\nDEFINE {{response_time_alert_duration_minutes}}: Integer = 5\nDEFINE {{95th_percentile_response_time}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{results}} = CALL vector_search({{user_query}})\n    IF {{results.similarity}} > {{similarity_threshold}}\n        RETURN {{results.top_n}} = {{top_n_vector_search}}\n    ELSE\n        {{results}} = CALL reorder_results({{results}})\n        RETURN {{results.top_n}} = {{top_n_reordered_results}}\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{results}} = CALL graph_database_search({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} IS NOT EMPTY\n        RETURN {{results}}\n    ELSE\n        {{results}} = CALL full_search({{user_query}})\n        RETURN {{results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{code}})\n        {{explanation}} = CALL generate_explanation({{analysis_results}})\n    ENDIF\nENDIF\n{{cache}} = CALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"unsatisfied\"\n    {{new_results}} = CALL stronger_reasoning_model({{user_query}})\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review({{user_query}})\n    ENDIF\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_query}})\nENDIF\nIF {{query_content}} CONTAINS \"sensitive_word\"\n    CALL log_violation({{query_content}})\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{confirmation}} = CALL confirm_user_identity({{user_id}})\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 FOR {{qps_alert_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{response_time_alert_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        }
      ],
      "final_decision": "partial_auto_fixed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 2,
        "p2_count": 0,
        "total": 2
      },
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "d93a496b",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 10,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 5 个错误：\n  ❌ step_2_reorder_results: 语法错误 - invalid syntax (行 4)\n  ❌ step_3_decompose_intent: 语法错误 - invalid syntax (行 3)\n  ❌ step_5_process: 语法错误 - invalid syntax (行 3)\n  ❌ step_16_trigger_alert: 语法错误 - invalid syntax (行 3)\n  ❌ step_17_trigger_scaling: 语法错误 - invalid syntax (行 3)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "partial",
    "total_time_ms": 38150,
    "error_message": null
  },
  "e8718f55": {
    "pipeline_id": "e8718f55",
    "timestamp": "2026-01-30 13:56:15",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "5c6a5a7d",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 818字"
        },
        "duration_ms": 8188,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 8189,
    "prompt20_id": "2bc6cebe",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_size}}，知识库B包含{{knowledge_base_B_size}}，知识库C包含{{knowledge_base_C_size}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_time_limit}}内完成，图数据库检索在{{graph_database_retrieval_time_limit}}内完成，代码分析在{{code_analysis_time_limit}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{low_query_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{high_response_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_size",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_size",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_size",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_time_limit",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_retrieval_time_limit",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_time_limit",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "low_query_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "high_response_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "86dd3099",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_time_limit}}: Integer = 500\nDEFINE {{graph_database_retrieval_time_limit}}: Integer = 1\nDEFINE {{code_analysis_time_limit}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration_minutes}}: Integer = 10\nDEFINE {{high_response_duration_minutes}}: Integer = 5\nDEFINE {{query_rate}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} > {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT NULL\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_query}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_query}})\n    ELSE\n        {{explanation}} = CALL semantic_analysis({{user_query}})\n        RETURN {{explanation}}\n    ENDIF\nELSE\n    RETURN CALL handle_invalid_query()\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL enable_stronger_reasoning_model()\n    IF {{user_feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_size}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_size}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_size}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_query}})\n    CALL log_violation()\n    RETURN \"Service Denied\"\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 59,
          "error_type": "未定义变量",
          "message": "配置参数 {{current_requests}} 未定义",
          "suggestion": "在DSL开头添加: DEFINE {{current_requests}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 73,
          "error_type": "未定义变量",
          "message": "配置参数 {{95th_percentile_response_time}} 未定义",
          "suggestion": "在DSL开头添加: DEFINE {{95th_percentile_response_time}}: Type",
          "severity": "P1"
        }
      ],
      "warnings": [],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "graph_exploration_steps": {
          "name": "graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_size": {
          "name": "knowledge_base_A_size",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_size": {
          "name": "knowledge_base_B_size",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_size": {
          "name": "knowledge_base_C_size",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_time_limit": {
          "name": "vector_retrieval_time_limit",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_retrieval_time_limit": {
          "name": "graph_database_retrieval_time_limit",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_time_limit": {
          "name": "code_analysis_time_limit",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "low_query_duration_minutes": {
          "name": "low_query_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "high_response_duration_minutes": {
          "name": "high_response_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "query_rate": {
          "name": "query_rate",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 22
        },
        "knowledge_base_A": {
          "name": "knowledge_base_A",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_A_size}}",
          "line_number": 56
        },
        "knowledge_base_B": {
          "name": "knowledge_base_B",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_B_size}}",
          "line_number": 57
        },
        "knowledge_base_C": {
          "name": "knowledge_base_C",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_C_size}}",
          "line_number": 58
        }
      },
      "runtime_variables": [
        "reordered_results",
        "graph_results",
        "response_time",
        "query_type",
        "similarity",
        "user_feedback_count",
        "user_feedback",
        "explanation",
        "intent",
        "user_query",
        "code_lines"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "similarity",
          "line_number": 24
        },
        {
          "function_name": "reorder_results",
          "arguments": [],
          "result_var": "reordered_results",
          "line_number": 28
        },
        {
          "function_name": "decompose_intent",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "intent",
          "line_number": 32
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{intent}}",
            "{{graph_exploration_steps}}"
          ],
          "result_var": "graph_results",
          "line_number": 33
        },
        {
          "function_name": "count_code_lines",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "code_lines",
          "line_number": 40
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{user_query}}"
          ],
          "result_var": "explanation",
          "line_number": 44
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 31500,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_time_limit}}: Integer = 500\nDEFINE {{graph_database_retrieval_time_limit}}: Integer = 1\nDEFINE {{code_analysis_time_limit}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration_minutes}}: Integer = 10\nDEFINE {{high_response_duration_minutes}}: Integer = 5\n{{query_type}} = CALL determine_query_type({{user_input}})\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{user_input}})\n    IF {{vector_results}}.similarity > {{similarity_threshold}}\n        RETURN {{vector_results}}.top_n = {{top_n_vector_results}}\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results}}.top_n = {{reordered_top_n_results}}\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposition}} = CALL decompose_intent({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposition}}, {{graph_exploration_steps}})\n    IF {{graph_results}}.found\n        RETURN {{graph_results}}.entities_and_relationships\n    ELSE\n        {{full_search_results}} = CALL full_search({{user_input}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{user_input}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{user_input}})\n    ENDIF\n    RETURN {{analysis_results}}\nELSE\n    RETURN \"Unsupported query type\"\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{user_input}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback}} == \"unsatisfied\"\n    {{unsatisfied_count}} = {{unsatisfied_count}} + 1\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\n{{knowledge_base_A}} = {{knowledge_base_A_size}}\n{{knowledge_base_B}} = {{knowledge_base_B_size}}\n{{knowledge_base_C}} = {{knowledge_base_C_size}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_input}})\nENDIF\nIF CALL contains_sensitive_words({{user_input}})\n    CALL log_violation({{user_input}})\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 FOR {{low_query_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{high_response_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_time_limit}}: Integer = 500\nDEFINE {{graph_database_retrieval_time_limit}}: Integer = 1\nDEFINE {{code_analysis_time_limit}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration_minutes}}: Integer = 10\nDEFINE {{high_response_duration_minutes}}: Integer = 5\nDEFINE {{current_requests}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\n{{query_type}} = CALL get_user_query_type({{user_input}})\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_input}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        {{results}} = CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_input}})\n    {{results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{results}} IS NOT FOUND\n        {{results}} = CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_result}} = CALL static_analysis({{user_input}})\n    ELSE\n        {{analysis_result}} = CALL semantic_analysis({{user_input}})\n    ENDIF\nENDIF\nCALL cache_results({{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{results}} = CALL stronger_reasoning_model({{user_input}})\n    IF {{user_feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{query_content}} CONTAINS \"sensitive_word\"\n    CALL reject_service()\n    CALL log_error()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs()\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 1,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 1,
            "p2_count": 0,
            "total": 1
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_time_limit}}: Integer = 500\nDEFINE {{graph_database_retrieval_time_limit}}: Integer = 1\nDEFINE {{code_analysis_time_limit}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration_minutes}}: Integer = 10\nDEFINE {{high_response_duration_minutes}}: Integer = 5\nDEFINE {{query_rate}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} > {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT NULL\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_query}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_query}})\n    ELSE\n        {{explanation}} = CALL semantic_analysis({{user_query}})\n        RETURN {{explanation}}\n    ENDIF\nELSE\n    RETURN CALL handle_invalid_query()\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL enable_stronger_reasoning_model()\n    IF {{user_feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_size}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_size}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_size}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_query}})\n    CALL log_violation()\n    RETURN \"Service Denied\"\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        }
      ],
      "final_decision": "partial_auto_fixed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 2,
        "p2_count": 0,
        "total": 2
      },
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "af2a6ff6",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 15,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 3 个错误：\n  ❌ step_3_decompose_intent: 语法错误 - invalid syntax (行 3)\n  ❌ step_5_count_code_lines: 语法错误 - invalid syntax (行 3)\n  ❌ step_7_handle_invalid_query: 语法错误 - invalid syntax (行 3)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "partial",
    "total_time_ms": 39704,
    "error_message": null
  },
  "c64b65bd": {
    "pipeline_id": "c64b65bd",
    "timestamp": "2026-01-30 14:17:13",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "de7efb06",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 814字"
        },
        "duration_ms": 29192,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 29192,
    "prompt20_id": "d7c04855",
    "prompt20_template": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{vector_similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{alert_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{alert_duration_response_time_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "vector_similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_response_time_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "295e5e86",
    "prompt30_dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieve({{user_input}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieve({{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT NULL\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_input}})\n    ELSE\n        RETURN CALL semantic_analysis({{user_input}})\n    ENDIF\nELSE\n    CALL log_invalid_query({{user_input}})\n    RETURN \"Invalid query type\"\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL enable_stronger_reasoning_model()\nELIF {{user_feedback}} == \"not_satisfied\"\n    {{unsatisfied_count}} = {{unsatisfied_count}} + 1\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_bases}}: Dict = {\n    \"A\": {{knowledge_base_A_documents}},\n    \"B\": {{knowledge_base_B_documents}},\n    \"C\": {{knowledge_base_C_documents}}\n}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_input}})\n    CALL log_violation({{user_input}})\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 63,
          "error_type": "未定义变量",
          "message": "配置参数 {{current_requests}} 未定义",
          "suggestion": "在DSL开头添加: DEFINE {{current_requests}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 77,
          "error_type": "未定义变量",
          "message": "配置参数 {{query_rate}} 未定义",
          "suggestion": "在DSL开头添加: DEFINE {{query_rate}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 80,
          "error_type": "未定义变量",
          "message": "配置参数 {{95th_percentile_response_time}} 未定义",
          "suggestion": "在DSL开头添加: DEFINE {{95th_percentile_response_time}}: Type",
          "severity": "P1"
        }
      ],
      "warnings": [],
      "defined_variables": {
        "vector_similarity_threshold": {
          "name": "vector_similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "graph_exploration_steps": {
          "name": "graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_documents": {
          "name": "knowledge_base_A_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_documents": {
          "name": "knowledge_base_B_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_documents": {
          "name": "knowledge_base_C_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time": {
          "name": "vector_retrieval_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "alert_duration_minutes": {
          "name": "alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "alert_duration_response_time_minutes": {
          "name": "alert_duration_response_time_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "code_lines": {
          "name": "code_lines",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 22
        },
        "knowledge_bases": {
          "name": "knowledge_bases",
          "var_type": "Dict",
          "initial_value": "{",
          "line_number": 58
        }
      },
      "runtime_variables": [
        "user_input",
        "similarity",
        "unsatisfied_count",
        "user_feedback",
        "query_type",
        "graph_results"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieve",
          "arguments": [
            "{{user_input}}"
          ],
          "result_var": "similarity",
          "line_number": 24
        },
        {
          "function_name": "graph_database_retrieve",
          "arguments": [
            "{{graph_exploration_steps}}"
          ],
          "result_var": "graph_results",
          "line_number": 33
        },
        {
          "function_name": "count_code_lines",
          "arguments": [
            "{{user_input}}"
          ],
          "result_var": "code_lines",
          "line_number": 40
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 28941,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\n{{query_type}} = CALL determine_query_type({{user_input}})\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_input}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        RETURN CALL get_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL get_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT NULL\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_input}})\n    ELSE\n        RETURN CALL semantic_analysis({{user_input}})\n    ENDIF\nELSE\n    RETURN CALL handle_invalid_query()\nENDIF\n{{cache}} = CALL cache_results({{user_input}}, {{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model}} = CALL enable_stronger_model()\n    IF {{user_feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{query_rate}} < 10 AND {{duration}} >= 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= 5\n    CALL trigger_scaling()\nENDIF\n{{log}} = CALL upload_logs()",
          "total_errors": 4,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 4,
            "p2_count": 0,
            "total": 4
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nDEFINE {{query_rate}}: Integer\nDEFINE {{duration}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    IF {{vector_similarity}} > {{vector_similarity_threshold}}\n        RETURN {{top_n_vector_results}}\n    ELSE\n        CALL reorder_results()\n        RETURN {{reordered_top_n_results}}\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition()\n    CALL graph_database_retrieval({{graph_exploration_steps}})\nELIF {{query_type}} == \"code_analysis\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        CALL static_analysis()\n    ELSE\n        CALL semantic_analysis()\n    ENDIF\nELSE\n    CALL hybrid_retrieval()\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL stronger_reasoning_model()\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{query_rate}} < 10 AND {{duration}} >= 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{duration}} >= 5\n    CALL trigger_scaling()\nENDIF\n{{error_log}}.retention_days = {{error_log_retention_days}}\n{{access_log}}.retention_days = {{access_log_retention_days}}\n{{debug_log}}.retention_days = {{debug_log_retention_days}}\nCALL upload_logs()",
          "total_errors": 1,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 1,
            "p2_count": 0,
            "total": 1
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieve({{user_input}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieve({{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT NULL\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_input}})\n    ELSE\n        RETURN CALL semantic_analysis({{user_input}})\n    ENDIF\nELSE\n    CALL log_invalid_query({{user_input}})\n    RETURN \"Invalid query type\"\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL enable_stronger_reasoning_model()\nELIF {{user_feedback}} == \"not_satisfied\"\n    {{unsatisfied_count}} = {{unsatisfied_count}} + 1\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_bases}}: Dict = {\n    \"A\": {{knowledge_base_A_documents}},\n    \"B\": {{knowledge_base_B_documents}},\n    \"C\": {{knowledge_base_C_documents}}\n}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_input}})\n    CALL log_violation({{user_input}})\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 3,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 3,
            "p2_count": 0,
            "total": 3
          }
        }
      ],
      "final_decision": "partial_auto_fixed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 3,
        "p2_count": 0,
        "total": 3
      },
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "368e7fd8",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 22,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 4 个错误：\n  ❌ step_3_intent_decomposition: 语法错误 - invalid syntax (行 3)\n  ❌ step_5_count_code_lines: 语法错误 - invalid syntax (行 3)\n  ❌ step_7_log_invalid_query: 语法错误 - invalid syntax (行 3)\n  ❌ step_11_process: 语法错误 - unmatched '}' (行 6)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "partial",
    "total_time_ms": 58155,
    "error_message": null
  },
  "b1b3827c": {
    "pipeline_id": "b1b3827c",
    "timestamp": "2026-01-30 14:40:56",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "5c2450d2",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 1,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 1,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 819字"
        },
        "duration_ms": 9735,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 9737,
    "prompt20_id": "24c1d741",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{knowledge_graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期为{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_for_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_documents}}，知识库B包含{{knowledge_base_B_documents}}，知识库C包含{{knowledge_base_C_documents}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{low_query_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{high_response_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "knowledge_graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_for_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_documents",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_documents",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_documents",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "low_query_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "high_response_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "be401f9b",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_for_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration_minutes}}: Integer = 10\nDEFINE {{high_response_duration_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nDEFINE {{query_rate}}: Integer\n{{query_type}} = user_input\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_input}})\n    IF {{similarity}} > {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieval({{knowledge_graph_exploration_steps}})\n    IF {{graph_results}} IS NOT NULL\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_for_static_analysis}}\n        RETURN CALL static_analysis({{user_input}})\n    ELSE\n        RETURN CALL semantic_analysis({{user_input}})\n    ENDIF\nELSE\n    RETURN CALL handle_invalid_query()\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL enable_stronger_reasoning_model()\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_documents}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_documents}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_input}})\n    CALL log_violation()\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR {{low_query_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{high_response_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 60,
          "error_type": "未定义变量",
          "message": "配置参数 {{current_requests}} 未定义",
          "suggestion": "在DSL开头添加: DEFINE {{current_requests}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 80,
          "error_type": "未定义变量",
          "message": "配置参数 {{95th_percentile_response_time}} 未定义",
          "suggestion": "在DSL开头添加: DEFINE {{95th_percentile_response_time}}: Type",
          "severity": "P1"
        }
      ],
      "warnings": [],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "knowledge_graph_exploration_steps": {
          "name": "knowledge_graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_for_static_analysis": {
          "name": "max_code_lines_for_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_documents": {
          "name": "knowledge_base_A_documents",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_documents": {
          "name": "knowledge_base_B_documents",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_documents": {
          "name": "knowledge_base_C_documents",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time": {
          "name": "vector_retrieval_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "low_query_duration_minutes": {
          "name": "low_query_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "high_response_duration_minutes": {
          "name": "high_response_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "code_lines": {
          "name": "code_lines",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 22
        },
        "query_rate": {
          "name": "query_rate",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 23
        },
        "knowledge_base_A": {
          "name": "knowledge_base_A",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_A_documents}}",
          "line_number": 57
        },
        "knowledge_base_B": {
          "name": "knowledge_base_B",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_B_documents}}",
          "line_number": 58
        },
        "knowledge_base_C": {
          "name": "knowledge_base_C",
          "var_type": "Integer",
          "initial_value": "{{knowledge_base_C_documents}}",
          "line_number": 59
        }
      },
      "runtime_variables": [
        "query_type",
        "graph_results",
        "user_feedback",
        "similarity",
        "reordered_results",
        "vector_retrieval_time",
        "user_input",
        "user_feedback_count"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{user_input}}"
          ],
          "result_var": "similarity",
          "line_number": 26
        },
        {
          "function_name": "reorder_results",
          "arguments": [],
          "result_var": "reordered_results",
          "line_number": 30
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{knowledge_graph_exploration_steps}}"
          ],
          "result_var": "graph_results",
          "line_number": 35
        },
        {
          "function_name": "count_code_lines",
          "arguments": [
            "{{user_input}}"
          ],
          "result_var": "code_lines",
          "line_number": 42
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 31184,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_for_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration_minutes}}: Integer = 10\nDEFINE {{high_response_duration_minutes}}: Integer = 5\n{{query_type}} = CALL determine_query_type({{user_input}})\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{user_input}})\n    IF {{vector_results}}.similarity > {{similarity_threshold}}\n        RETURN {{vector_results}}.top_n[{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results}}.top_n[{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposition}} = CALL decompose_intent({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposition}}, {{knowledge_graph_exploration_steps}})\n    IF {{graph_results}}.found\n        RETURN {{graph_results}}.entities_and_relationships\n    ELSE\n        {{full_search_results}} = CALL full_search({{user_input}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_for_static_analysis}}\n        {{static_analysis_results}} = CALL static_analysis({{user_input}})\n        RETURN {{static_analysis_results}}\n    ELSE\n        {{semantic_analysis_results}} = CALL semantic_analysis({{user_input}})\n        RETURN {{semantic_analysis_results}}\n    ENDIF\nELSE\n    RETURN \"Unsupported query type\"\nENDIF\n{{cache}} = CALL cache_results({{user_input}}, {{results}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{user_input}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback}} == \"unsatisfied\"\n    {{unsatisfied_count}} = {{unsatisfied_count}} + 1\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_input}})\nENDIF\nIF {{query_content}} CONTAINS \"sensitive_word\"\n    CALL log_violation({{query_content}})\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{identity_confirmation}} = CALL confirm_identity({{user_input}})\n    IF NOT {{identity_confirmation}}.confirmed\n        RETURN \"Identity confirmation required\"\n    ENDIF\nENDIF\nIF {{vector_retrieval_response_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_response_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_response_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\n{{error_log_retention}} = {{error_log_retention_days}}\n{{access_log_retention}} = {{access_log_retention_days}}\n{{debug_log_retention}} = {{debug_log_retention_days}}\nIF {{qps}} < 10 FOR {{low_query_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{high_response_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_for_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration_minutes}}: Integer = 10\nDEFINE {{high_response_duration_minutes}}: Integer = 5\nDEFINE {{current_requests}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} > {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{knowledge_graph_exploration_steps}})\n    IF {{graph_results}} IS NOT NULL\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    IF {{code_lines}} > {{max_code_lines_for_static_analysis}}\n        RETURN CALL static_analysis({{user_code}})\n    ELSE\n        {{explanation}} = CALL semantic_analysis({{user_code}})\n        RETURN {{explanation}}\n    ENDIF\nELSE\n    RETURN CALL handle_unknown_query()\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL stronger_reasoning_model()\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{query_content}} CONTAINS \"sensitive_word\"\n    CALL log_violation()\n    RETURN \"Service denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nIF {{error_log_retention_days}} > 0\n    CALL upload_logs(\"error\")\nENDIF\nIF {{access_log_retention_days}} > 0\n    CALL upload_logs(\"access\")\nENDIF\nIF {{debug_log_retention_days}} > 0\n    CALL upload_logs(\"debug\")\nENDIF\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_for_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_documents}}: Integer = 2000\nDEFINE {{knowledge_base_B_documents}}: Integer = 3000\nDEFINE {{knowledge_base_C_documents}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration_minutes}}: Integer = 10\nDEFINE {{high_response_duration_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nDEFINE {{query_rate}}: Integer\n{{query_type}} = user_input\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_input}})\n    IF {{similarity}} > {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieval({{knowledge_graph_exploration_steps}})\n    IF {{graph_results}} IS NOT NULL\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_for_static_analysis}}\n        RETURN CALL static_analysis({{user_input}})\n    ELSE\n        RETURN CALL semantic_analysis({{user_input}})\n    ENDIF\nELSE\n    RETURN CALL handle_invalid_query()\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL enable_stronger_reasoning_model()\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_documents}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_documents}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_documents}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_input}})\n    CALL log_violation()\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR {{low_query_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{high_response_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        }
      ],
      "final_decision": "partial_auto_fixed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 2,
        "p2_count": 0,
        "total": 2
      },
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "15fbe21d",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 11,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 6 个错误：\n  ❌ step_1_compute_similarity_threshold: 语法错误 - invalid syntax (行 3)\n  ❌ step_2_vector_retrieval: 语法错误 - invalid syntax (行 10)\n  ❌ step_5_compute_knowledge_base_A: 语法错误 - invalid syntax (行 3)\n  ❌ step_9_degrade_service: 语法错误 - invalid syntax (行 3)\n  ❌ step_11_trigger_alert: 语法错误 - invalid syntax (行 3)\n  ❌ step_12_trigger_scaling: 语法错误 - invalid syntax (行 3)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "partial",
    "total_time_ms": 40932,
    "error_message": null
  },
  "fae327d5": {
    "pipeline_id": "fae327d5",
    "timestamp": "2026-01-30 14:44:59",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "c854bc77",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 818字"
        },
        "duration_ms": 46811,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 46812,
    "prompt20_id": "ef92d09a",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_size}}，知识库B包含{{knowledge_base_B_size}}，知识库C包含{{knowledge_base_C_size}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{alert_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{alert_response_time_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_size",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_size",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_size",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "alert_response_time_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "596d9706",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_response_time_duration_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nDEFINE {{query_rate}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    IF {{similarity}} > {{similarity_threshold}}\n        RETURN {{top_n_vector_results}}\n    ELSE\n        CALL reorder_results()\n        RETURN {{reordered_top_n_results}}\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition()\n    CALL graph_database_retrieval()\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        CALL static_analysis()\n    ELSE\n        CALL semantic_analysis()\n    ENDIF\nELSE\n    CALL mixed_retrieval()\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL stronger_reasoning_model()\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\n{{error_log}}.retention_days = {{error_log_retention_days}}\n{{access_log}}.retention_days = {{access_log_retention_days}}\n{{debug_log}}.retention_days = {{debug_log_retention_days}}\nCALL upload_logs()",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "graph_exploration_steps": {
          "name": "graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_size": {
          "name": "knowledge_base_A_size",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_size": {
          "name": "knowledge_base_B_size",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_size": {
          "name": "knowledge_base_C_size",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time": {
          "name": "vector_retrieval_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "alert_duration_minutes": {
          "name": "alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "alert_response_time_duration_minutes": {
          "name": "alert_response_time_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "code_lines": {
          "name": "code_lines",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 22
        },
        "query_rate": {
          "name": "query_rate",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 23
        }
      },
      "runtime_variables": [
        "total_response_time",
        "unsatisfied_count",
        "query_type",
        "similarity",
        "user_feedback"
      ],
      "function_calls": [],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 33516,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_response_time_duration_minutes}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT NULL\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_code}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_code}})\n    ELSE\n        {{explanation}} = CALL semantic_analysis({{user_code}})\n        RETURN {{explanation}}\n    ENDIF\nELSE\n    RETURN CALL invalid_query_response()\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL enable_stronger_reasoning_model()\nELIF {{user_feedback}} == \"unsatisfied\"\n    {{unsatisfied_count}} = {{unsatisfied_count}} + 1\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_size}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_size}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_size}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_query}})\n    CALL log_violation()\n    RETURN CALL deny_service()\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{qps}} < 10 FOR 10 MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR 5 MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_response_time_duration_minutes}}: Integer = 5\nDEFINE {{current_requests}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        RETURN CALL get_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL get_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT NULL\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{code}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{code}})\n        RETURN CALL generate_explanation_document({{analysis_results}})\n    ENDIF\nELSE\n    RETURN CALL handle_unknown_query()\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL enable_stronger_reasoning_model()\nELIF {{user_feedback}} == \"not_satisfied\"\n    {{unsatisfied_count}} = {{unsatisfied_count}} + 1\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{knowledge_base_A_size}}\nDEFINE {{knowledge_base_B}}: Integer = {{knowledge_base_B_size}}\nDEFINE {{knowledge_base_C}}: Integer = {{knowledge_base_C_size}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_query}})\n    CALL log_violation()\n    RETURN \"Service denied due to sensitive content.\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_response_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_response_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_response_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_response_time_duration_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nDEFINE {{query_rate}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    IF {{similarity}} > {{similarity_threshold}}\n        RETURN {{top_n_vector_results}}\n    ELSE\n        CALL reorder_results()\n        RETURN {{reordered_top_n_results}}\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition()\n    CALL graph_database_retrieval()\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        CALL static_analysis()\n    ELSE\n        CALL semantic_analysis()\n    ENDIF\nELSE\n    CALL mixed_retrieval()\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL stronger_reasoning_model()\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\n{{error_log}}.retention_days = {{error_log_retention_days}}\n{{access_log}}.retention_days = {{access_log_retention_days}}\n{{debug_log}}.retention_days = {{debug_log_retention_days}}\nCALL upload_logs()",
          "total_errors": 0,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 0,
            "total": 0
          }
        }
      ],
      "final_decision": "success",
      "error_summary": {},
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "7c173c5b",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 16,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 2 个错误：\n  ❌ step_1_compute_similarity_threshold: 语法错误 - invalid syntax (行 3)\n  ❌ step_2_reorder_results: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "success",
    "total_time_ms": 80344,
    "error_message": null
  },
  "0cca360d": {
    "pipeline_id": "0cca360d",
    "timestamp": "2026-01-30 14:48:50",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "c91aeb96",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 818字"
        },
        "duration_ms": 6859,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 6860,
    "prompt20_id": "5934f069",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{medical_documents_count}}，知识库B包含{{technical_documents_count}}，知识库C包含{{legal_documents_count}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{query_rate_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{response_time_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "medical_documents_count",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "technical_documents_count",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "legal_documents_count",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "query_rate_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "f8aa66c6",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{medical_documents_count}}: Integer = 2000\nDEFINE {{technical_documents_count}}: Integer = 3000\nDEFINE {{legal_documents_count}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nDEFINE {{current_requests}}: Integer\nDEFINE {{query_rate}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\n{{query_type}} = user_input\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval()\n    IF {{vector_results}}.similarity > {{similarity_threshold}}\n        RETURN {{vector_results}}.top_n[{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results}}.top_n[{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent(user_input)\n    {{graph_results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{graph_results}}.found\n        RETURN {{graph_results}}.entities\n    ELSE\n        {{full_search_results}} = CALL full_search()\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = user_input.lines\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis(user_input)\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis(user_input)\n    ENDIF\n    RETURN {{analysis_results}}\nELSE\n    RETURN \"Unsupported query type\"\nENDIF\n{{cache}} = CALL cache_results(user_input, {{results}}, {{cache_expiration_time}})\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request(user_input)\nENDIF\n{{filtered_input}} = CALL filter_sensitive_words(user_input)\nIF {{filtered_input}}.contains_sensitive_content\n    CALL log_violation(user_input)\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{identity_confirmed}} = CALL confirm_identity(user_input)\n    IF NOT {{identity_confirmed}}\n        RETURN \"Identity confirmation required\"\n    ENDIF\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs()\nIF {{query_rate}} < 10 FOR {{query_rate_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{response_time_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "graph_exploration_steps": {
          "name": "graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "medical_documents_count": {
          "name": "medical_documents_count",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "technical_documents_count": {
          "name": "technical_documents_count",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "legal_documents_count": {
          "name": "legal_documents_count",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time": {
          "name": "vector_retrieval_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "query_rate_duration_minutes": {
          "name": "query_rate_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "response_time_duration_minutes": {
          "name": "response_time_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "current_requests": {
          "name": "current_requests",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 22
        },
        "query_rate": {
          "name": "query_rate",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 23
        },
        "95th_percentile_response_time": {
          "name": "95th_percentile_response_time",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 24
        }
      },
      "runtime_variables": [
        "query_type",
        "intent",
        "analysis_results",
        "filtered_input",
        "identity_confirmed",
        "full_search_results",
        "cache",
        "reordered_results",
        "results",
        "vector_results",
        "graph_results",
        "code_lines"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [],
          "result_var": "vector_results",
          "line_number": 27
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{vector_results}}"
          ],
          "result_var": "reordered_results",
          "line_number": 31
        },
        {
          "function_name": "decompose_intent",
          "arguments": [
            "user_input"
          ],
          "result_var": "intent",
          "line_number": 35
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{intent}}",
            "{{graph_exploration_steps}}"
          ],
          "result_var": "graph_results",
          "line_number": 36
        },
        {
          "function_name": "full_search",
          "arguments": [],
          "result_var": "full_search_results",
          "line_number": 40
        },
        {
          "function_name": "static_analysis",
          "arguments": [
            "user_input"
          ],
          "result_var": "analysis_results",
          "line_number": 46
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "user_input"
          ],
          "result_var": "analysis_results",
          "line_number": 48
        },
        {
          "function_name": "cache_results",
          "arguments": [
            "user_input",
            "{{results}}",
            "{{cache_expiration_time}}"
          ],
          "result_var": "cache",
          "line_number": 54
        },
        {
          "function_name": "filter_sensitive_words",
          "arguments": [
            "user_input"
          ],
          "result_var": "filtered_input",
          "line_number": 58
        },
        {
          "function_name": "confirm_identity",
          "arguments": [
            "user_input"
          ],
          "result_var": "identity_confirmed",
          "line_number": 64
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 27953,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{medical_documents_count}}: Integer = 2000\nDEFINE {{technical_documents_count}}: Integer = 3000\nDEFINE {{legal_documents_count}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\n{{query_type}} = CALL determine_query_type({{user_input}})\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{user_input}})\n    IF {{vector_results}}.similarity >= {{similarity_threshold}}\n        RETURN {{vector_results}}.top_n[{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results}}.top_n[{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{graph_results}}.found\n        RETURN {{graph_results}}.entities_and_relationships\n    ELSE\n        {{full_search_results}} = CALL full_search({{user_input}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{user_input}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{user_input}})\n    ENDIF\n    RETURN {{analysis_results}}\nELSE\n    RETURN \"Unsupported query type\"\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{user_input}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback}} == \"unsatisfied\"\n    {{unsatisfied_count}} = {{unsatisfied_count}} + 1\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{medical_documents_count}}\nDEFINE {{knowledge_base_B}}: Integer = {{technical_documents_count}}\nDEFINE {{knowledge_base_C}}: Integer = {{legal_documents_count}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_input}})\nENDIF\nIF CALL contains_sensitive_words({{user_input}})\n    CALL log_violation({{user_input}})\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{user_identity_confirmed}} = CALL confirm_user_identity({{user_input}})\n    IF NOT {{user_identity_confirmed}}\n        RETURN \"Identity confirmation required\"\n    ENDIF\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR {{query_rate_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{response_time_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 3,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 3,
            "p2_count": 0,
            "total": 3
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{medical_documents_count}}: Integer = 2000\nDEFINE {{technical_documents_count}}: Integer = 3000\nDEFINE {{legal_documents_count}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nDEFINE {{current_requests}}: Integer\nDEFINE {{query_rate}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\n{{query_type}} = user_input\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval()\n    IF {{vector_results}}.similarity > {{similarity_threshold}}\n        RETURN {{vector_results}}.top_n[{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results}}.top_n[{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent(user_input)\n    {{graph_results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{graph_results}}.found\n        RETURN {{graph_results}}.entities\n    ELSE\n        {{full_search_results}} = CALL full_search()\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = user_input.lines\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis(user_input)\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis(user_input)\n    ENDIF\n    RETURN {{analysis_results}}\nELSE\n    RETURN \"Unsupported query type\"\nENDIF\n{{cache}} = CALL cache_results(user_input, {{results}}, {{cache_expiration_time}})\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request(user_input)\nENDIF\n{{filtered_input}} = CALL filter_sensitive_words(user_input)\nIF {{filtered_input}}.contains_sensitive_content\n    CALL log_violation(user_input)\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{identity_confirmed}} = CALL confirm_identity(user_input)\n    IF NOT {{identity_confirmed}}\n        RETURN \"Identity confirmation required\"\n    ENDIF\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs()\nIF {{query_rate}} < 10 FOR {{query_rate_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{response_time_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 0,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 0,
            "total": 0
          }
        }
      ],
      "final_decision": "success",
      "error_summary": {},
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "bcc29cc5",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 8,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 2 个错误：\n  ❌ step_1_compute_similarity_threshold: 语法错误 - invalid syntax (行 3)\n  ❌ step_2_vector_retrieval: 语法错误 - invalid syntax (行 10)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "success",
    "total_time_ms": 34821,
    "error_message": null
  },
  "1e5a9e2a": {
    "pipeline_id": "1e5a9e2a",
    "timestamp": "2026-01-30 14:52:29",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "486d4f9e",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 817字"
        },
        "duration_ms": 5545,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 5545,
    "prompt20_id": "9fa45ddc",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_size}}，知识库B包含{{knowledge_base_B_size}}，知识库C包含{{knowledge_base_C_size}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{alert_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{alert_duration_response_time_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_size",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_size",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_size",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "alert_duration_response_time_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "96d6f170",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    IF {{similarity}} > {{similarity_threshold}}\n        RETURN {{top_n_vector_results}}\n    ELSE\n        CALL reorder_results()\n        RETURN {{reordered_top_n_results}}\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition()\n    CALL graph_database_retrieval()\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        CALL static_analysis()\n    ELSE\n        CALL semantic_analysis()\n    ENDIF\nELSE\n    CALL mixed_retrieval()\nENDIF\nIF {{user_feedback}} == \"unsatisfied\"\n    CALL regenerate_response()\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": false,
      "errors": [
        {
          "line_number": 48,
          "error_type": "未定义变量",
          "message": "配置参数 {{query_rate}} 未定义",
          "suggestion": "在DSL开头添加: DEFINE {{query_rate}}: Type",
          "severity": "P1"
        },
        {
          "line_number": 51,
          "error_type": "未定义变量",
          "message": "配置参数 {{95th_percentile_response_time}} 未定义",
          "suggestion": "在DSL开头添加: DEFINE {{95th_percentile_response_time}}: Type",
          "severity": "P1"
        }
      ],
      "warnings": [],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "graph_exploration_steps": {
          "name": "graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_size": {
          "name": "knowledge_base_A_size",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_size": {
          "name": "knowledge_base_B_size",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_size": {
          "name": "knowledge_base_C_size",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time": {
          "name": "vector_retrieval_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "alert_duration_minutes": {
          "name": "alert_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "alert_duration_response_time_minutes": {
          "name": "alert_duration_response_time_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "code_lines": {
          "name": "code_lines",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 22
        }
      },
      "runtime_variables": [
        "similarity",
        "unsatisfied_count",
        "user_feedback",
        "query_type"
      ],
      "function_calls": [],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 26725,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\n{{query_type}} = CALL determine_query_type({{user_input}})\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{user_input}})\n    IF {{vector_results}}.similarity >= {{similarity_threshold}}\n        RETURN {{vector_results}}.top_n[{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results}}.top_n[{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposition}} = CALL decompose_intent({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposition}}, {{graph_exploration_steps}})\n    IF {{graph_results}}.found\n        RETURN {{graph_results}}.entities_and_relationships\n    ELSE\n        {{full_search_results}} = CALL full_search({{user_input}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{static_analysis_results}} = CALL static_analysis({{user_input}})\n        RETURN {{static_analysis_results}}\n    ELSE\n        {{semantic_analysis_results}} = CALL semantic_analysis({{user_input}})\n        RETURN {{semantic_analysis_results}}\n    ENDIF\nELSE\n    CALL log_invalid_query({{user_input}})\n    RETURN \"Invalid query type\"\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL use_stronger_model({{user_input}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{user_input}})\nENDIF\n{{knowledge_base_A}} = {{knowledge_base_A_size}}\n{{knowledge_base_B}} = {{knowledge_base_B_size}}\n{{knowledge_base_C}} = {{knowledge_base_C_size}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_input}})\nENDIF\nIF CALL contains_sensitive_words({{user_input}})\n    CALL reject_service({{user_input}})\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity({{user_input}})\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs_to_central_system()\nIF {{qps}} < 10 FOR 10 MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{p95_response_time}} > 3 FOR 5 MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 1,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 1,
            "p2_count": 0,
            "total": 1
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nDEFINE {{current_requests}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{matched_nodes}} = CALL graph_database_retrieval({{user_query}}, {{graph_exploration_steps}})\n    IF {{matched_nodes}} IS NOT EMPTY\n        RETURN {{matched_nodes}}\n    ELSE\n        RETURN CALL full_search({{user_query}})\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_code}})\n    ELSE\n        {{explanation}} = CALL semantic_analysis({{user_code}})\n        RETURN {{explanation}}\n    ENDIF\nELSE\n    RETURN CALL handle_invalid_query()\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL enable_stronger_model()\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF {{query_content}} CONTAINS \"sensitive_word\"\n    CALL log_violation({{query_content}})\n    RETURN \"Service denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs()",
          "total_errors": 1,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 1,
            "p2_count": 0,
            "total": 1
          }
        },
        {
          "attempt": 3,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{alert_duration_minutes}}: Integer = 10\nDEFINE {{alert_duration_response_time_minutes}}: Integer = 5\nDEFINE {{code_lines}}: Integer\nIF {{query_type}} == \"simple_fact\"\n    IF {{similarity}} > {{similarity_threshold}}\n        RETURN {{top_n_vector_results}}\n    ELSE\n        CALL reorder_results()\n        RETURN {{reordered_top_n_results}}\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition()\n    CALL graph_database_retrieval()\nELIF {{query_type}} == \"code_related\"\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        CALL static_analysis()\n    ELSE\n        CALL semantic_analysis()\n    ENDIF\nELSE\n    CALL mixed_retrieval()\nENDIF\nIF {{user_feedback}} == \"unsatisfied\"\n    CALL regenerate_response()\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 2,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 2,
            "p2_count": 0,
            "total": 2
          }
        }
      ],
      "final_decision": "partial_auto_fixed",
      "error_summary": {
        "p0_count": 0,
        "p1_count": 2,
        "p2_count": 0,
        "total": 2
      },
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "1c263264",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 8,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 2 个错误：\n  ❌ step_1_compute_similarity_threshold: 语法错误 - invalid syntax (行 3)\n  ❌ step_2_reorder_results: 语法错误 - expected an indented block after 'if' statement on line 3 (行 4)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "partial",
    "total_time_ms": 32278,
    "error_message": null
  },
  "069b1cc2": {
    "pipeline_id": "069b1cc2",
    "timestamp": "2026-01-30 15:00:43",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "228f8b82",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 818字"
        },
        "duration_ms": 8820,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 8821,
    "prompt20_id": "4fe3cd5f",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_size}}，知识库B包含{{knowledge_base_B_size}}，知识库C包含{{knowledge_base_C_size}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{query_rate_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{response_time_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_size",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_size",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_size",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "query_rate_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "d2dafb04",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nDEFINE {{current_requests}}: Integer\nDEFINE {{query_rate}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\n{{query_type}} = user_input\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_input}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT NULL\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_input}})\n    ELSE\n        {{explanation}} = CALL semantic_analysis({{user_input}})\n        RETURN {{explanation}}\n    ENDIF\nELSE\n    RETURN CALL invalid_query_response()\nENDIF\n{{cache}} = CALL cache_results({{user_input}}, {{result}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model}} = CALL enable_stronger_model()\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_input}})\n    CALL log_violation()\n    RETURN \"Service denied due to sensitive content.\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_response_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_response_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_response_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR {{query_rate_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{response_time_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "graph_exploration_steps": {
          "name": "graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_size": {
          "name": "knowledge_base_A_size",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_size": {
          "name": "knowledge_base_B_size",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_size": {
          "name": "knowledge_base_C_size",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time": {
          "name": "vector_retrieval_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "query_rate_duration_minutes": {
          "name": "query_rate_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "response_time_duration_minutes": {
          "name": "response_time_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "current_requests": {
          "name": "current_requests",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 22
        },
        "query_rate": {
          "name": "query_rate",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 23
        },
        "95th_percentile_response_time": {
          "name": "95th_percentile_response_time",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 24
        }
      },
      "runtime_variables": [
        "graph_results",
        "code_lines",
        "intent",
        "user_feedback",
        "reordered_results",
        "explanation",
        "query_type",
        "stronger_model",
        "user_feedback_count",
        "result",
        "similarity",
        "user_input",
        "cache"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{user_input}}"
          ],
          "result_var": "similarity",
          "line_number": 27
        },
        {
          "function_name": "reorder_results",
          "arguments": [],
          "result_var": "reordered_results",
          "line_number": 31
        },
        {
          "function_name": "decompose_intent",
          "arguments": [
            "{{user_input}}"
          ],
          "result_var": "intent",
          "line_number": 35
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{intent}}",
            "{{graph_exploration_steps}}"
          ],
          "result_var": "graph_results",
          "line_number": 36
        },
        {
          "function_name": "count_code_lines",
          "arguments": [
            "{{user_input}}"
          ],
          "result_var": "code_lines",
          "line_number": 43
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "{{user_input}}"
          ],
          "result_var": "explanation",
          "line_number": 47
        },
        {
          "function_name": "cache_results",
          "arguments": [
            "{{user_input}}",
            "{{result}}",
            "{{cache_expiration_time}}"
          ],
          "result_var": "cache",
          "line_number": 53
        },
        {
          "function_name": "enable_stronger_model",
          "arguments": [],
          "result_var": "stronger_model",
          "line_number": 55
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 21223,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\n{{query_type}} = CALL determine_query_type({{user_input}})\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{user_input}})\n    IF {{vector_results}}.similarity >= {{similarity_threshold}}\n        RETURN {{vector_results}}.top_n[{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results}}.top_n[{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposition}} = CALL decompose_intent({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposition}}, {{graph_exploration_steps}})\n    IF {{graph_results}}.found\n        RETURN {{graph_results}}.entities_and_relationships\n    ELSE\n        {{full_search_results}} = CALL full_search({{user_input}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{static_analysis_results}} = CALL static_analysis({{user_input}})\n        RETURN {{static_analysis_results}}\n    ELSE\n        {{semantic_analysis_results}} = CALL semantic_analysis({{user_input}})\n        RETURN {{semantic_analysis_results}}\n    ENDIF\nELSE\n    RETURN \"Unsupported query type\"\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL use_stronger_model({{user_input}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review({{user_input}})\nENDIF\n{{knowledge_base_A}} = {{knowledge_base_A_size}}\n{{knowledge_base_B}} = {{knowledge_base_B_size}}\n{{knowledge_base_C}} = {{knowledge_base_C_size}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_input}})\nENDIF\nIF CALL contains_sensitive_words({{user_input}})\n    CALL log_violation({{user_input}})\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{identity_confirmation}} = CALL confirm_user_identity({{user_input}})\n    IF NOT {{identity_confirmation}}\n        RETURN \"Identity confirmation required\"\n    ENDIF\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR {{query_rate_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > {{total_response_time_limit}} FOR {{response_time_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 3,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 3,
            "p2_count": 0,
            "total": 3
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nDEFINE {{current_requests}}: Integer\nDEFINE {{query_rate}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\n{{query_type}} = user_input\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_input}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{graph_results}} IS NOT NULL\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_input}})\n    ELSE\n        {{explanation}} = CALL semantic_analysis({{user_input}})\n        RETURN {{explanation}}\n    ENDIF\nELSE\n    RETURN CALL invalid_query_response()\nENDIF\n{{cache}} = CALL cache_results({{user_input}}, {{result}}, {{cache_expiration_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model}} = CALL enable_stronger_model()\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_input}})\n    CALL log_violation()\n    RETURN \"Service denied due to sensitive content.\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_response_time}} > {{vector_retrieval_response_time}} OR \n   {{graph_database_response_time}} > {{graph_database_response_time}} OR \n   {{code_analysis_response_time}} > {{code_analysis_response_time}} OR \n   {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR {{query_rate_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{response_time_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 0,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 0,
            "total": 0
          }
        }
      ],
      "final_decision": "success",
      "error_summary": {},
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "7bdce3fe",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 9,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 2 个错误：\n  ❌ step_2_vector_retrieval: 语法错误 - invalid syntax (行 7)\n  ❌ step_9_degrade_service: 语法错误 - invalid syntax (行 3)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "success",
    "total_time_ms": 30053,
    "error_message": null
  },
  "8ba50fc3": {
    "pipeline_id": "8ba50fc3",
    "timestamp": "2026-01-30 15:02:33",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "287ce290",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 816字"
        },
        "duration_ms": 10038,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 10039,
    "prompt20_id": "25aac343",
    "prompt20_template": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{knowledge_graph_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiry_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{medical_documents_count}}，知识库B包含{{technical_documents_count}}，知识库C包含{{legal_documents_count}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{low_query_duration}}，触发告警；如果95分位响应时间超过3秒持续{{high_response_duration}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "knowledge_graph_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiry_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "medical_documents_count",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "technical_documents_count",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "legal_documents_count",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "low_query_duration",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "high_response_duration",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "3b559424",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{knowledge_graph_steps}}: Integer = 2\nDEFINE {{cache_expiry_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{medical_documents_count}}: Integer = 2000\nDEFINE {{technical_documents_count}}: Integer = 3000\nDEFINE {{legal_documents_count}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration}}: Integer = 10\nDEFINE {{high_response_duration}}: Integer = 5\nDEFINE {{current_requests}}: Integer\nDEFINE {{query_rate}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\n{{query_type}} = CALL get_user_query_type({{user_input}})\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_input}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        RETURN CALL get_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL get_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{matched_nodes}} = CALL graph_database_retrieval({{user_input}}, {{knowledge_graph_steps}})\n    IF {{matched_nodes}} IS NOT EMPTY\n        RETURN {{matched_nodes}}\n    ELSE\n        RETURN CALL full_search({{user_input}})\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        CALL static_analysis({{user_input}})\n    ELSE\n        CALL semantic_analysis({{user_input}})\n    ENDIF\nELSE\n    RETURN \"Unsupported query type\"\nENDIF\nCALL cache_results({{user_input}}, {{cache_expiry_time}})\nIF {{user_feedback}} == \"regenerate\"\n    CALL stronger_reasoning_model()\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_input}})\n    CALL log_violation()\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "knowledge_graph_steps": {
          "name": "knowledge_graph_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiry_time": {
          "name": "cache_expiry_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "medical_documents_count": {
          "name": "medical_documents_count",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "technical_documents_count": {
          "name": "technical_documents_count",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "legal_documents_count": {
          "name": "legal_documents_count",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time": {
          "name": "vector_retrieval_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "low_query_duration": {
          "name": "low_query_duration",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "high_response_duration": {
          "name": "high_response_duration",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "current_requests": {
          "name": "current_requests",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 22
        },
        "query_rate": {
          "name": "query_rate",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 23
        },
        "95th_percentile_response_time": {
          "name": "95th_percentile_response_time",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 24
        }
      },
      "runtime_variables": [
        "user_input",
        "code_lines",
        "reordered_results",
        "matched_nodes",
        "user_feedback_count",
        "query_type",
        "user_feedback",
        "similarity"
      ],
      "function_calls": [
        {
          "function_name": "get_user_query_type",
          "arguments": [
            "{{user_input}}"
          ],
          "result_var": "query_type",
          "line_number": 25
        },
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{user_input}}"
          ],
          "result_var": "similarity",
          "line_number": 27
        },
        {
          "function_name": "reorder_results",
          "arguments": [],
          "result_var": "reordered_results",
          "line_number": 31
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{user_input}}",
            "{{knowledge_graph_steps}}"
          ],
          "result_var": "matched_nodes",
          "line_number": 35
        },
        {
          "function_name": "count_code_lines",
          "arguments": [
            "{{user_input}}"
          ],
          "result_var": "code_lines",
          "line_number": 42
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 20552,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{knowledge_graph_steps}}: Integer = 2\nDEFINE {{cache_expiry_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{medical_documents_count}}: Integer = 2000\nDEFINE {{technical_documents_count}}: Integer = 3000\nDEFINE {{legal_documents_count}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration}}: Integer = 10\nDEFINE {{high_response_duration}}: Integer = 5\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_query}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        RETURN CALL return_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL return_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_query}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent}}, {{knowledge_graph_steps}})\n    IF {{graph_results}} IS NOT EMPTY\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_query}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_query}})\n    ELSE\n        RETURN CALL semantic_analysis({{user_query}})\n    ENDIF\nELSE\n    RETURN CALL handle_invalid_query()\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    CALL enable_stronger_model()\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_query}})\n    CALL log_violation()\n    RETURN \"Service Denied\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR {{low_query_duration}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{high_response_duration}} MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 3,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 3,
            "p2_count": 0,
            "total": 3
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{knowledge_graph_steps}}: Integer = 2\nDEFINE {{cache_expiry_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{medical_documents_count}}: Integer = 2000\nDEFINE {{technical_documents_count}}: Integer = 3000\nDEFINE {{legal_documents_count}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{low_query_duration}}: Integer = 10\nDEFINE {{high_response_duration}}: Integer = 5\nDEFINE {{current_requests}}: Integer\nDEFINE {{query_rate}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\n{{query_type}} = CALL get_user_query_type({{user_input}})\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_input}})\n    IF {{similarity}} >= {{similarity_threshold}}\n        RETURN CALL get_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL get_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{matched_nodes}} = CALL graph_database_retrieval({{user_input}}, {{knowledge_graph_steps}})\n    IF {{matched_nodes}} IS NOT EMPTY\n        RETURN {{matched_nodes}}\n    ELSE\n        RETURN CALL full_search({{user_input}})\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        CALL static_analysis({{user_input}})\n    ELSE\n        CALL semantic_analysis({{user_input}})\n    ENDIF\nELSE\n    RETURN \"Unsupported query type\"\nENDIF\nCALL cache_results({{user_input}}, {{cache_expiry_time}})\nIF {{user_feedback}} == \"regenerate\"\n    CALL stronger_reasoning_model()\nENDIF\nIF {{user_feedback_count}} >= 3\n    CALL escalate_to_human_review()\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_input}})\n    CALL log_violation()\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    CALL confirm_user_identity()\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 0,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 0,
            "total": 0
          }
        }
      ],
      "final_decision": "success",
      "error_summary": {},
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "c7dca22d",
    "prompt40_modules": [],
    "prompt40_module_count": 0,
    "prompt40_main_code": "",
    "prompt40_time_ms": 6,
    "prompt40_step1_parsing": {
      "status": "failed",
      "reason": "语法验证失败，发现 1 个错误：\n  ❌ step_2_vector_retrieval: 语法错误 - invalid syntax (行 7)"
    },
    "prompt40_step2_dependency": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step3_clustering": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step4_generation": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "prompt40_step5_orchestration": {
      "status": "skipped",
      "reason": "Parsing failed"
    },
    "overall_status": "success",
    "total_time_ms": 30597,
    "error_message": null
  },
  "fb3e6b69": {
    "pipeline_id": "fb3e6b69",
    "timestamp": "2026-01-30 15:05:37",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "f4b08efd",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 816字"
        },
        "duration_ms": 8902,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 8902,
    "prompt20_id": "086acb00",
    "prompt20_template": "请设计一个智能问答系统，处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{vector_similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{knowledge_graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiry_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{knowledge_base_A_size}}，知识库B包含{{knowledge_base_B_size}}，知识库C包含{{knowledge_base_C_size}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{query_rate_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{response_time_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "vector_similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "knowledge_graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiry_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_A_size",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_B_size",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "knowledge_base_C_size",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "query_rate_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "1705be24",
    "prompt30_dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiry_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nDEFINE {{current_requests}}: Integer\nDEFINE {{query_rate}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\n{{query_type}} = user_input\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_input}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        RETURN CALL get_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL get_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieval({{knowledge_graph_exploration_steps}})\n    IF {{graph_results}} IS NOT NULL\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_input}})\n    ELSE\n        RETURN CALL semantic_analysis({{user_input}})\n    ENDIF\nELSE\n    RETURN \"Invalid query type\"\nENDIF\nCALL cache_results({{user_input}}, {{result}}, {{cache_expiry_time}})\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_input}})\n    CALL log_violation({{user_input}})\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 AND {{query_rate_duration_minutes}} >= 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{response_time_duration_minutes}} >= 5\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [],
      "defined_variables": {
        "vector_similarity_threshold": {
          "name": "vector_similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "knowledge_graph_exploration_steps": {
          "name": "knowledge_graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiry_time": {
          "name": "cache_expiry_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "knowledge_base_A_size": {
          "name": "knowledge_base_A_size",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "knowledge_base_B_size": {
          "name": "knowledge_base_B_size",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "knowledge_base_C_size": {
          "name": "knowledge_base_C_size",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time": {
          "name": "vector_retrieval_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "query_rate_duration_minutes": {
          "name": "query_rate_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "response_time_duration_minutes": {
          "name": "response_time_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "current_requests": {
          "name": "current_requests",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 22
        },
        "query_rate": {
          "name": "query_rate",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 23
        },
        "95th_percentile_response_time": {
          "name": "95th_percentile_response_time",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 24
        }
      },
      "runtime_variables": [
        "query_type",
        "reordered_results",
        "graph_results",
        "user_input",
        "similarity",
        "code_lines"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [
            "{{user_input}}"
          ],
          "result_var": "similarity",
          "line_number": 27
        },
        {
          "function_name": "reorder_results",
          "arguments": [],
          "result_var": "reordered_results",
          "line_number": 31
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{knowledge_graph_exploration_steps}}"
          ],
          "result_var": "graph_results",
          "line_number": 36
        },
        {
          "function_name": "count_code_lines",
          "arguments": [
            "{{user_input}}"
          ],
          "result_var": "code_lines",
          "line_number": 43
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 20729,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiry_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\n{{query_type}} = CALL determine_query_type({{user_input}})\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_input}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        {{results}} = CALL get_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{results}} = CALL reorder_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_input}})\n    {{results}} = CALL graph_database_retrieval({{intent}}, {{knowledge_graph_exploration_steps}})\n    IF {{results}} IS NOT FOUND\n        {{results}} = CALL full_search({{user_input}})\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis({{user_input}})\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis({{user_input}})\n    ENDIF\nENDIF\nCALL cache_results({{results}}, {{cache_expiry_time}})\nIF {{user_feedback}} == \"regenerate\"\n    {{results}} = CALL enhanced_reasoning_model({{user_input}})\n    IF {{user_feedback_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_input}})\nENDIF\nIF {{contains_sensitive_content}} == TRUE\n    CALL log_violation({{user_input}})\n    RETURN \"Service denied due to sensitive content.\"\nENDIF\nIF {{is_financial_query}} == TRUE\n    CALL confirm_user_identity()\nENDIF\nIF {{total_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs()\nCALL monitor_metrics()\nIF {{query_rate}} < 10 FOR {{query_rate_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{response_time_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 3,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 3,
            "p2_count": 0,
            "total": 3
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{vector_similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{knowledge_graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiry_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{knowledge_base_A_size}}: Integer = 2000\nDEFINE {{knowledge_base_B_size}}: Integer = 3000\nDEFINE {{knowledge_base_C_size}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nDEFINE {{current_requests}}: Integer\nDEFINE {{query_rate}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\n{{query_type}} = user_input\nIF {{query_type}} == \"simple_fact\"\n    {{similarity}} = CALL vector_retrieval({{user_input}})\n    IF {{similarity}} >= {{vector_similarity_threshold}}\n        RETURN CALL get_top_n_results({{top_n_vector_results}})\n    ELSE\n        {{reordered_results}} = CALL reorder_results()\n        RETURN CALL get_top_n_results({{reordered_top_n_results}})\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    CALL intent_decomposition({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieval({{knowledge_graph_exploration_steps}})\n    IF {{graph_results}} IS NOT NULL\n        RETURN {{graph_results}}\n    ELSE\n        RETURN CALL full_search()\n    ENDIF\nELIF {{query_type}} == \"code_analysis\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        RETURN CALL static_analysis({{user_input}})\n    ELSE\n        RETURN CALL semantic_analysis({{user_input}})\n    ENDIF\nELSE\n    RETURN \"Invalid query type\"\nENDIF\nCALL cache_results({{user_input}}, {{result}}, {{cache_expiry_time}})\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\nIF CALL contains_sensitive_words({{user_input}})\n    CALL log_violation({{user_input}})\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 AND {{query_rate_duration_minutes}} >= 10\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 AND {{response_time_duration_minutes}} >= 5\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 0,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 0,
            "total": 0
          }
        }
      ],
      "final_decision": "success",
      "error_summary": {},
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "f6ad1ac5",
    "prompt40_modules": [
      {
        "name": "step_1_compute_vector_similarity_threshold",
        "inputs": [
          "_95th_percentile_response_time",
          "current_requests",
          "query_rate"
        ],
        "outputs": [
          "access_log_retention_days",
          "admin_user_priority",
          "cache_expiry_time",
          "code_analysis_response_time",
          "debug_log_retention_days",
          "error_log_retention_days",
          "graph_database_response_time",
          "knowledge_base_A_size",
          "knowledge_base_B_size",
          "knowledge_base_C_size",
          "knowledge_graph_exploration_steps",
          "max_code_lines_static_analysis",
          "max_concurrent_requests",
          "query_rate_duration_minutes",
          "query_type",
          "reordered_top_n_results",
          "response_time_duration_minutes",
          "top_n_vector_results",
          "total_response_time_limit",
          "vector_dimension",
          "vector_retrieval_response_time",
          "vector_similarity_threshold"
        ],
        "is_async": false
      },
      {
        "name": "step_2_vector_retrieval",
        "inputs": [
          "knowledge_graph_exploration_steps",
          "max_code_lines_static_analysis",
          "query_type",
          "reordered_top_n_results",
          "top_n_vector_results",
          "user_input",
          "vector_similarity_threshold"
        ],
        "outputs": [
          "__graph_results__",
          "code_lines",
          "graph_results",
          "reordered_results",
          "similarity"
        ],
        "is_async": true
      },
      {
        "name": "step_3_cache_results",
        "inputs": [
          "cache_expiry_time",
          "result",
          "user_input"
        ],
        "outputs": [],
        "is_async": true
      },
      {
        "name": "step_4_queue_request",
        "inputs": [
          "current_requests",
          "max_concurrent_requests"
        ],
        "outputs": [],
        "is_async": true
      },
      {
        "name": "step_5_log_violation",
        "inputs": [
          "user_input"
        ],
        "outputs": [],
        "is_async": true
      },
      {
        "name": "step_6_degrade_service",
        "inputs": [
          "total_response_time_limit",
          "vector_retrieval_response_time"
        ],
        "outputs": [],
        "is_async": true
      },
      {
        "name": "step_7_upload_logs",
        "inputs": [
          "access_log_retention_days",
          "debug_log_retention_days",
          "error_log_retention_days"
        ],
        "outputs": [],
        "is_async": true
      },
      {
        "name": "step_8_trigger_alert",
        "inputs": [
          "query_rate",
          "query_rate_duration_minutes"
        ],
        "outputs": [],
        "is_async": true
      },
      {
        "name": "step_9_trigger_scaling",
        "inputs": [
          "_95th_percentile_response_time",
          "response_time_duration_minutes"
        ],
        "outputs": [],
        "is_async": true
      }
    ],
    "prompt40_module_count": 9,
    "prompt40_main_code": "async def main_workflow(input_params: dict):\n    \"\"\"\n    主工作流 - 自动生成\n    \n    Args:\n        input_params: 包含 ['95th_percentile_response_time', 'current_requests', 'query_rate', 'result', 'user_input'] 的字典\n    \n    Returns:\n        执行结果上下文\n    \"\"\"\n    # 初始化上下文\n    ctx = input_params.copy()\n\n    # Module 1: step_1_compute_vector_similarity_threshold\n    ctx[\"access_log_retention_days\"], ctx[\"admin_user_priority\"], ctx[\"cache_expiry_time\"], ctx[\"code_analysis_response_time\"], ctx[\"debug_log_retention_days\"], ctx[\"error_log_retention_days\"], ctx[\"graph_database_response_time\"], ctx[\"knowledge_base_A_size\"], ctx[\"knowledge_base_B_size\"], ctx[\"knowledge_base_C_size\"], ctx[\"knowledge_graph_exploration_steps\"], ctx[\"max_code_lines_static_analysis\"], ctx[\"max_concurrent_requests\"], ctx[\"query_rate_duration_minutes\"], ctx[\"query_type\"], ctx[\"reordered_top_n_results\"], ctx[\"response_time_duration_minutes\"], ctx[\"top_n_vector_results\"], ctx[\"total_response_time_limit\"], ctx[\"vector_dimension\"], ctx[\"vector_retrieval_response_time\"], ctx[\"vector_similarity_threshold\"] = step_1_compute_vector_similarity_threshold(ctx.get(\"_95th_percentile_response_time\"), ctx.get(\"current_requests\"), ctx.get(\"query_rate\"))\n\n    # Module 2: step_2_vector_retrieval\n    ctx[\"__graph_results__\"], ctx[\"code_lines\"], ctx[\"graph_results\"], ctx[\"reordered_results\"], ctx[\"similarity\"] = await step_2_vector_retrieval(ctx.get(\"knowledge_graph_exploration_steps\"), ctx.get(\"max_code_lines_static_analysis\"), ctx.get(\"query_type\"), ctx.get(\"reordered_top_n_results\"), ctx.get(\"top_n_vector_results\"), ctx.get(\"user_input\"), ctx.get(\"vector_similarity_threshold\"))\n\n    # Module 3: step_3_cache_results\n    await step_3_cache_results(ctx.get(\"cache_expiry_time\"), ctx.get(\"result\"), ctx.get(\"user_input\"))\n\n    # Module 4: step_4_queue_request\n    await step_4_queue_request(ctx.get(\"current_requests\"), ctx.get(\"max_concurrent_requests\"))\n\n    # Module 5: step_5_log_violation\n    await step_5_log_violation(ctx.get(\"user_input\"))\n\n    # Module 6: step_6_degrade_service\n    await step_6_degrade_service(ctx.get(\"total_response_time_limit\"), ctx.get(\"vector_retrieval_response_time\"))\n\n    # Module 7: step_7_upload_logs\n    await step_7_upload_logs(ctx.get(\"access_log_retention_days\"), ctx.get(\"debug_log_retention_days\"), ctx.get(\"error_log_retention_days\"))\n\n    # Module 8: step_8_trigger_alert\n    await step_8_trigger_alert(ctx.get(\"query_rate\"), ctx.get(\"query_rate_duration_minutes\"))\n\n    # Module 9: step_9_trigger_scaling\n    await step_9_trigger_scaling(ctx.get(\"_95th_percentile_response_time\"), ctx.get(\"response_time_duration_minutes\"))\n\n    return ctx",
    "prompt40_time_ms": 14,
    "prompt40_step1_parsing": {
      "total_blocks": 69,
      "block_types": {
        "ASSIGN": 28,
        "IF": 9,
        "CALL": 17,
        "ELSE": 4,
        "ENDIF": 9,
        "ELIF": 2
      },
      "blocks": [
        {
          "id": "OP_0",
          "type": "ASSIGN",
          "line_number": 1,
          "is_async": false,
          "inputs": [
            "vector_similarity_threshold"
          ],
          "outputs": [
            "vector_similarity_threshold"
          ],
          "code_lines": [
            "DEFINE {{vector_similarity_threshold}}: String = 0.85"
          ]
        },
        {
          "id": "OP_1",
          "type": "ASSIGN",
          "line_number": 2,
          "is_async": false,
          "inputs": [
            "top_n_vector_results"
          ],
          "outputs": [
            "top_n_vector_results"
          ],
          "code_lines": [
            "DEFINE {{top_n_vector_results}}: Integer = 3"
          ]
        },
        {
          "id": "OP_2",
          "type": "ASSIGN",
          "line_number": 3,
          "is_async": false,
          "inputs": [
            "reordered_top_n_results"
          ],
          "outputs": [
            "reordered_top_n_results"
          ],
          "code_lines": [
            "DEFINE {{reordered_top_n_results}}: Integer = 5"
          ]
        },
        {
          "id": "OP_3",
          "type": "ASSIGN",
          "line_number": 4,
          "is_async": false,
          "inputs": [
            "knowledge_graph_exploration_steps"
          ],
          "outputs": [
            "knowledge_graph_exploration_steps"
          ],
          "code_lines": [
            "DEFINE {{knowledge_graph_exploration_steps}}: Integer = 2"
          ]
        },
        {
          "id": "OP_4",
          "type": "ASSIGN",
          "line_number": 5,
          "is_async": false,
          "inputs": [
            "cache_expiry_time"
          ],
          "outputs": [
            "cache_expiry_time"
          ],
          "code_lines": [
            "DEFINE {{cache_expiry_time}}: Integer = 30"
          ]
        },
        {
          "id": "OP_5",
          "type": "ASSIGN",
          "line_number": 6,
          "is_async": false,
          "inputs": [
            "max_code_lines_static_analysis"
          ],
          "outputs": [
            "max_code_lines_static_analysis"
          ],
          "code_lines": [
            "DEFINE {{max_code_lines_static_analysis}}: Integer = 500"
          ]
        },
        {
          "id": "OP_6",
          "type": "ASSIGN",
          "line_number": 7,
          "is_async": false,
          "inputs": [
            "knowledge_base_A_size"
          ],
          "outputs": [
            "knowledge_base_A_size"
          ],
          "code_lines": [
            "DEFINE {{knowledge_base_A_size}}: Integer = 2000"
          ]
        },
        {
          "id": "OP_7",
          "type": "ASSIGN",
          "line_number": 8,
          "is_async": false,
          "inputs": [
            "knowledge_base_B_size"
          ],
          "outputs": [
            "knowledge_base_B_size"
          ],
          "code_lines": [
            "DEFINE {{knowledge_base_B_size}}: Integer = 3000"
          ]
        },
        {
          "id": "OP_8",
          "type": "ASSIGN",
          "line_number": 9,
          "is_async": false,
          "inputs": [
            "knowledge_base_C_size"
          ],
          "outputs": [
            "knowledge_base_C_size"
          ],
          "code_lines": [
            "DEFINE {{knowledge_base_C_size}}: Integer = 1500"
          ]
        },
        {
          "id": "OP_9",
          "type": "ASSIGN",
          "line_number": 10,
          "is_async": false,
          "inputs": [
            "vector_dimension"
          ],
          "outputs": [
            "vector_dimension"
          ],
          "code_lines": [
            "DEFINE {{vector_dimension}}: Integer = 1536"
          ]
        },
        {
          "id": "OP_10",
          "type": "ASSIGN",
          "line_number": 11,
          "is_async": false,
          "inputs": [
            "max_concurrent_requests"
          ],
          "outputs": [
            "max_concurrent_requests"
          ],
          "code_lines": [
            "DEFINE {{max_concurrent_requests}}: Integer = 50"
          ]
        },
        {
          "id": "OP_11",
          "type": "ASSIGN",
          "line_number": 12,
          "is_async": false,
          "inputs": [
            "admin_user_priority"
          ],
          "outputs": [
            "admin_user_priority"
          ],
          "code_lines": [
            "DEFINE {{admin_user_priority}}: Integer = 10"
          ]
        },
        {
          "id": "OP_12",
          "type": "ASSIGN",
          "line_number": 13,
          "is_async": false,
          "inputs": [
            "vector_retrieval_response_time"
          ],
          "outputs": [
            "vector_retrieval_response_time"
          ],
          "code_lines": [
            "DEFINE {{vector_retrieval_response_time}}: Integer = 500"
          ]
        },
        {
          "id": "OP_13",
          "type": "ASSIGN",
          "line_number": 14,
          "is_async": false,
          "inputs": [
            "graph_database_response_time"
          ],
          "outputs": [
            "graph_database_response_time"
          ],
          "code_lines": [
            "DEFINE {{graph_database_response_time}}: Integer = 1"
          ]
        },
        {
          "id": "OP_14",
          "type": "ASSIGN",
          "line_number": 15,
          "is_async": false,
          "inputs": [
            "code_analysis_response_time"
          ],
          "outputs": [
            "code_analysis_response_time"
          ],
          "code_lines": [
            "DEFINE {{code_analysis_response_time}}: Integer = 2"
          ]
        },
        {
          "id": "OP_15",
          "type": "ASSIGN",
          "line_number": 16,
          "is_async": false,
          "inputs": [
            "total_response_time_limit"
          ],
          "outputs": [
            "total_response_time_limit"
          ],
          "code_lines": [
            "DEFINE {{total_response_time_limit}}: Integer = 3"
          ]
        },
        {
          "id": "OP_16",
          "type": "ASSIGN",
          "line_number": 17,
          "is_async": false,
          "inputs": [
            "error_log_retention_days"
          ],
          "outputs": [
            "error_log_retention_days"
          ],
          "code_lines": [
            "DEFINE {{error_log_retention_days}}: Integer = 90"
          ]
        },
        {
          "id": "OP_17",
          "type": "ASSIGN",
          "line_number": 18,
          "is_async": false,
          "inputs": [
            "access_log_retention_days"
          ],
          "outputs": [
            "access_log_retention_days"
          ],
          "code_lines": [
            "DEFINE {{access_log_retention_days}}: Integer = 30"
          ]
        },
        {
          "id": "OP_18",
          "type": "ASSIGN",
          "line_number": 19,
          "is_async": false,
          "inputs": [
            "debug_log_retention_days"
          ],
          "outputs": [
            "debug_log_retention_days"
          ],
          "code_lines": [
            "DEFINE {{debug_log_retention_days}}: Integer = 7"
          ]
        },
        {
          "id": "OP_19",
          "type": "ASSIGN",
          "line_number": 20,
          "is_async": false,
          "inputs": [
            "query_rate_duration_minutes"
          ],
          "outputs": [
            "query_rate_duration_minutes"
          ],
          "code_lines": [
            "DEFINE {{query_rate_duration_minutes}}: Integer = 10"
          ]
        },
        {
          "id": "OP_20",
          "type": "ASSIGN",
          "line_number": 21,
          "is_async": false,
          "inputs": [
            "response_time_duration_minutes"
          ],
          "outputs": [
            "response_time_duration_minutes"
          ],
          "code_lines": [
            "DEFINE {{response_time_duration_minutes}}: Integer = 5"
          ]
        },
        {
          "id": "OP_21",
          "type": "ASSIGN",
          "line_number": 22,
          "is_async": false,
          "inputs": [
            "current_requests"
          ],
          "outputs": [],
          "code_lines": [
            "DEFINE {{current_requests}}: Integer"
          ]
        },
        {
          "id": "OP_22",
          "type": "ASSIGN",
          "line_number": 23,
          "is_async": false,
          "inputs": [
            "query_rate"
          ],
          "outputs": [],
          "code_lines": [
            "DEFINE {{query_rate}}: Integer"
          ]
        },
        {
          "id": "OP_23",
          "type": "ASSIGN",
          "line_number": 24,
          "is_async": false,
          "inputs": [
            "95th_percentile_response_time"
          ],
          "outputs": [],
          "code_lines": [
            "DEFINE {{95th_percentile_response_time}}: Integer"
          ]
        },
        {
          "id": "OP_24",
          "type": "ASSIGN",
          "line_number": 25,
          "is_async": false,
          "inputs": [],
          "outputs": [
            "query_type"
          ],
          "code_lines": [
            "{{query_type}} = user_input"
          ]
        },
        {
          "id": "CTRL_25",
          "type": "IF",
          "line_number": 26,
          "is_async": false,
          "inputs": [
            "query_type"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{query_type}} == \"simple_fact\""
          ]
        },
        {
          "id": "OP_26",
          "type": "CALL",
          "line_number": 27,
          "is_async": true,
          "inputs": [
            "user_input"
          ],
          "outputs": [
            "similarity"
          ],
          "code_lines": [
            "{{similarity}} = CALL vector_retrieval({{user_input}})"
          ]
        },
        {
          "id": "CTRL_27",
          "type": "IF",
          "line_number": 28,
          "is_async": false,
          "inputs": [
            "similarity",
            "vector_similarity_threshold"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{similarity}} >= {{vector_similarity_threshold}}"
          ]
        },
        {
          "id": "OP_28",
          "type": "CALL",
          "line_number": 29,
          "is_async": true,
          "inputs": [
            "top_n_vector_results"
          ],
          "outputs": [],
          "code_lines": [
            "RETURN CALL get_top_n_results({{top_n_vector_results}})"
          ]
        },
        {
          "id": "CTRL_29",
          "type": "ELSE",
          "line_number": 30,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ELSE"
          ]
        },
        {
          "id": "OP_30",
          "type": "CALL",
          "line_number": 31,
          "is_async": true,
          "inputs": [],
          "outputs": [
            "reordered_results"
          ],
          "code_lines": [
            "{{reordered_results}} = CALL reorder_results()"
          ]
        },
        {
          "id": "OP_31",
          "type": "CALL",
          "line_number": 32,
          "is_async": true,
          "inputs": [
            "reordered_top_n_results"
          ],
          "outputs": [],
          "code_lines": [
            "RETURN CALL get_top_n_results({{reordered_top_n_results}})"
          ]
        },
        {
          "id": "CTRL_32",
          "type": "ENDIF",
          "line_number": 33,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_33",
          "type": "ELIF",
          "line_number": 34,
          "is_async": false,
          "inputs": [
            "query_type"
          ],
          "outputs": [],
          "code_lines": [
            "ELIF {{query_type}} == \"complex_reasoning\""
          ]
        },
        {
          "id": "OP_34",
          "type": "CALL",
          "line_number": 35,
          "is_async": true,
          "inputs": [
            "user_input"
          ],
          "outputs": [],
          "code_lines": [
            "CALL intent_decomposition({{user_input}})"
          ]
        },
        {
          "id": "OP_35",
          "type": "CALL",
          "line_number": 36,
          "is_async": true,
          "inputs": [
            "knowledge_graph_exploration_steps"
          ],
          "outputs": [
            "graph_results"
          ],
          "code_lines": [
            "{{graph_results}} = CALL graph_database_retrieval({{knowledge_graph_exploration_steps}})"
          ]
        },
        {
          "id": "CTRL_36",
          "type": "IF",
          "line_number": 37,
          "is_async": false,
          "inputs": [
            "graph_results"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{graph_results}} IS NOT NULL"
          ]
        },
        {
          "id": "OP_37",
          "type": "ASSIGN",
          "line_number": 38,
          "is_async": false,
          "inputs": [
            "graph_results"
          ],
          "outputs": [
            "{{graph_results}}"
          ],
          "code_lines": [
            "RETURN {{graph_results}}"
          ]
        },
        {
          "id": "CTRL_38",
          "type": "ELSE",
          "line_number": 39,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ELSE"
          ]
        },
        {
          "id": "OP_39",
          "type": "CALL",
          "line_number": 40,
          "is_async": true,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "RETURN CALL full_search()"
          ]
        },
        {
          "id": "CTRL_40",
          "type": "ENDIF",
          "line_number": 41,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_41",
          "type": "ELIF",
          "line_number": 42,
          "is_async": false,
          "inputs": [
            "query_type"
          ],
          "outputs": [],
          "code_lines": [
            "ELIF {{query_type}} == \"code_analysis\""
          ]
        },
        {
          "id": "OP_42",
          "type": "CALL",
          "line_number": 43,
          "is_async": true,
          "inputs": [
            "user_input"
          ],
          "outputs": [
            "code_lines"
          ],
          "code_lines": [
            "{{code_lines}} = CALL count_code_lines({{user_input}})"
          ]
        },
        {
          "id": "CTRL_43",
          "type": "IF",
          "line_number": 44,
          "is_async": false,
          "inputs": [
            "max_code_lines_static_analysis",
            "code_lines"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{code_lines}} > {{max_code_lines_static_analysis}}"
          ]
        },
        {
          "id": "OP_44",
          "type": "CALL",
          "line_number": 45,
          "is_async": true,
          "inputs": [
            "user_input"
          ],
          "outputs": [],
          "code_lines": [
            "RETURN CALL static_analysis({{user_input}})"
          ]
        },
        {
          "id": "CTRL_45",
          "type": "ELSE",
          "line_number": 46,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ELSE"
          ]
        },
        {
          "id": "OP_46",
          "type": "CALL",
          "line_number": 47,
          "is_async": true,
          "inputs": [
            "user_input"
          ],
          "outputs": [],
          "code_lines": [
            "RETURN CALL semantic_analysis({{user_input}})"
          ]
        },
        {
          "id": "CTRL_47",
          "type": "ENDIF",
          "line_number": 48,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_48",
          "type": "ELSE",
          "line_number": 49,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ELSE"
          ]
        },
        {
          "id": "OP_49",
          "type": "ASSIGN",
          "line_number": 50,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "RETURN \"Invalid query type\""
          ]
        },
        {
          "id": "CTRL_50",
          "type": "ENDIF",
          "line_number": 51,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "OP_51",
          "type": "CALL",
          "line_number": 52,
          "is_async": true,
          "inputs": [
            "user_input",
            "result",
            "cache_expiry_time"
          ],
          "outputs": [],
          "code_lines": [
            "CALL cache_results({{user_input}}, {{result}}, {{cache_expiry_time}})"
          ]
        },
        {
          "id": "CTRL_52",
          "type": "IF",
          "line_number": 53,
          "is_async": false,
          "inputs": [
            "max_concurrent_requests",
            "current_requests"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{current_requests}} > {{max_concurrent_requests}}"
          ]
        },
        {
          "id": "OP_53",
          "type": "CALL",
          "line_number": 54,
          "is_async": true,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "CALL queue_request()"
          ]
        },
        {
          "id": "CTRL_54",
          "type": "ENDIF",
          "line_number": 55,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_55",
          "type": "IF",
          "line_number": 56,
          "is_async": false,
          "inputs": [
            "user_input"
          ],
          "outputs": [],
          "code_lines": [
            "IF CALL contains_sensitive_words({{user_input}})"
          ]
        },
        {
          "id": "OP_56",
          "type": "CALL",
          "line_number": 57,
          "is_async": true,
          "inputs": [
            "user_input"
          ],
          "outputs": [],
          "code_lines": [
            "CALL log_violation({{user_input}})"
          ]
        },
        {
          "id": "OP_57",
          "type": "ASSIGN",
          "line_number": 58,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "RETURN \"Service denied due to sensitive content\""
          ]
        },
        {
          "id": "CTRL_58",
          "type": "ENDIF",
          "line_number": 59,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_59",
          "type": "IF",
          "line_number": 60,
          "is_async": false,
          "inputs": [
            "total_response_time_limit",
            "vector_retrieval_response_time"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{vector_retrieval_response_time}} > {{total_response_time_limit}}"
          ]
        },
        {
          "id": "OP_60",
          "type": "CALL",
          "line_number": 61,
          "is_async": true,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "CALL degrade_service()"
          ]
        },
        {
          "id": "CTRL_61",
          "type": "ENDIF",
          "line_number": 62,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "OP_62",
          "type": "CALL",
          "line_number": 63,
          "is_async": true,
          "inputs": [
            "access_log_retention_days",
            "error_log_retention_days",
            "debug_log_retention_days"
          ],
          "outputs": [],
          "code_lines": [
            "CALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})"
          ]
        },
        {
          "id": "CTRL_63",
          "type": "IF",
          "line_number": 64,
          "is_async": false,
          "inputs": [
            "query_rate",
            "query_rate_duration_minutes"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{query_rate}} < 10 AND {{query_rate_duration_minutes}} >= 10"
          ]
        },
        {
          "id": "OP_64",
          "type": "CALL",
          "line_number": 65,
          "is_async": true,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "CALL trigger_alert()"
          ]
        },
        {
          "id": "CTRL_65",
          "type": "ENDIF",
          "line_number": 66,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_66",
          "type": "IF",
          "line_number": 67,
          "is_async": false,
          "inputs": [
            "95th_percentile_response_time",
            "response_time_duration_minutes"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{95th_percentile_response_time}} > 3 AND {{response_time_duration_minutes}} >= 5"
          ]
        },
        {
          "id": "OP_67",
          "type": "CALL",
          "line_number": 68,
          "is_async": true,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "CALL trigger_scaling()"
          ]
        },
        {
          "id": "CTRL_68",
          "type": "ENDIF",
          "line_number": 69,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        }
      ]
    },
    "prompt40_step2_dependency": {
      "has_cycles": false,
      "dead_code_count": 22,
      "dead_code_blocks": [
        "OP_6",
        "OP_7",
        "OP_8",
        "OP_9",
        "OP_11",
        "OP_13",
        "OP_14",
        "OP_21",
        "OP_22",
        "OP_23",
        "OP_30",
        "OP_34",
        "OP_39",
        "OP_44",
        "OP_46",
        "OP_49",
        "OP_53",
        "OP_56",
        "OP_57",
        "OP_60",
        "OP_64",
        "OP_67"
      ],
      "topological_order": [
        "OP_0",
        "OP_1",
        "OP_2",
        "OP_3",
        "OP_4",
        "OP_5",
        "OP_6",
        "OP_7",
        "OP_8",
        "OP_9",
        "OP_10",
        "OP_11",
        "OP_12",
        "OP_13",
        "OP_14",
        "OP_15",
        "OP_16",
        "OP_17",
        "OP_18",
        "OP_19",
        "OP_20",
        "OP_21",
        "OP_22",
        "OP_23",
        "OP_24",
        "OP_26",
        "CTRL_29",
        "OP_30",
        "CTRL_32",
        "OP_34",
        "CTRL_38",
        "OP_39",
        "CTRL_40",
        "OP_42",
        "OP_44",
        "CTRL_45",
        "OP_46",
        "CTRL_47",
        "CTRL_48",
        "OP_49",
        "CTRL_50",
        "OP_53",
        "CTRL_54",
        "CTRL_55",
        "OP_56",
        "OP_57",
        "CTRL_58",
        "OP_60",
        "CTRL_61",
        "OP_64",
        "CTRL_65",
        "OP_67",
        "CTRL_68",
        "OP_28",
        "OP_31",
        "OP_35",
        "OP_51",
        "CTRL_52",
        "CTRL_59",
        "OP_62",
        "CTRL_63",
        "CTRL_66",
        "CTRL_25",
        "CTRL_33",
        "CTRL_41",
        "CTRL_27",
        "CTRL_43",
        "CTRL_36",
        "OP_37"
      ],
      "edge_count": 21,
      "node_count": 69
    },
    "prompt40_step3_clustering": {
      "strategy": "hybrid",
      "total_clusters": 9,
      "clusters": [
        {
          "cluster_id": 1,
          "block_count": 25,
          "blocks": [
            "OP_0",
            "OP_1",
            "OP_2",
            "OP_3",
            "OP_4",
            "OP_5",
            "OP_6",
            "OP_7",
            "OP_8",
            "OP_9",
            "OP_10",
            "OP_11",
            "OP_12",
            "OP_13",
            "OP_14",
            "OP_15",
            "OP_16",
            "OP_17",
            "OP_18",
            "OP_19",
            "OP_20",
            "OP_21",
            "OP_22",
            "OP_23",
            "OP_24"
          ]
        },
        {
          "cluster_id": 2,
          "block_count": 26,
          "blocks": [
            "CTRL_25",
            "OP_26",
            "CTRL_27",
            "OP_28",
            "CTRL_29",
            "OP_30",
            "OP_31",
            "CTRL_32",
            "CTRL_33",
            "OP_34",
            "OP_35",
            "CTRL_36",
            "OP_37",
            "CTRL_38",
            "OP_39",
            "CTRL_40",
            "CTRL_41",
            "OP_42",
            "CTRL_43",
            "OP_44",
            "CTRL_45",
            "OP_46",
            "CTRL_47",
            "CTRL_48",
            "OP_49",
            "CTRL_50"
          ]
        },
        {
          "cluster_id": 3,
          "block_count": 1,
          "blocks": [
            "OP_51"
          ]
        },
        {
          "cluster_id": 4,
          "block_count": 3,
          "blocks": [
            "CTRL_52",
            "OP_53",
            "CTRL_54"
          ]
        },
        {
          "cluster_id": 5,
          "block_count": 4,
          "blocks": [
            "CTRL_55",
            "OP_56",
            "OP_57",
            "CTRL_58"
          ]
        },
        {
          "cluster_id": 6,
          "block_count": 3,
          "blocks": [
            "CTRL_59",
            "OP_60",
            "CTRL_61"
          ]
        },
        {
          "cluster_id": 7,
          "block_count": 1,
          "blocks": [
            "OP_62"
          ]
        },
        {
          "cluster_id": 8,
          "block_count": 3,
          "blocks": [
            "CTRL_63",
            "OP_64",
            "CTRL_65"
          ]
        },
        {
          "cluster_id": 9,
          "block_count": 3,
          "blocks": [
            "CTRL_66",
            "OP_67",
            "CTRL_68"
          ]
        }
      ]
    },
    "prompt40_step4_generation": {
      "total_modules": 9,
      "async_modules": 8,
      "sync_modules": 1,
      "modules": [
        {
          "name": "step_1_compute_vector_similarity_threshold",
          "inputs": [
            "_95th_percentile_response_time",
            "current_requests",
            "query_rate"
          ],
          "outputs": [
            "access_log_retention_days",
            "admin_user_priority",
            "cache_expiry_time",
            "code_analysis_response_time",
            "debug_log_retention_days",
            "error_log_retention_days",
            "graph_database_response_time",
            "knowledge_base_A_size",
            "knowledge_base_B_size",
            "knowledge_base_C_size",
            "knowledge_graph_exploration_steps",
            "max_code_lines_static_analysis",
            "max_concurrent_requests",
            "query_rate_duration_minutes",
            "query_type",
            "reordered_top_n_results",
            "response_time_duration_minutes",
            "top_n_vector_results",
            "total_response_time_limit",
            "vector_dimension",
            "vector_retrieval_response_time",
            "vector_similarity_threshold"
          ],
          "is_async": false,
          "body_code": "def step_1_compute_vector_similarity_threshold(_95th_percentile_response_time, current_requests, query_rate):\n    \"\"\"Auto-generated module\"\"\"\n    query_type = user_input\n    return access_log_retention_days, admin_user_priority, cache_expiry_time, code_analysis_response_time, debug_log_retention_days, error_log_retention_days, graph_database_response_time, knowledge_base_A_size, knowledge_base_B_size, knowledge_base_C_size, knowledge_graph_exploration_steps, max_code_lines_static_analysis, max_concurrent_requests, query_rate_duration_minutes, query_type, reordered_top_n_results, response_time_duration_minutes, top_n_vector_results, total_response_time_limit, vector_dimension, vector_retrieval_response_time, vector_similarity_threshold",
          "original_block_count": 25
        },
        {
          "name": "step_2_vector_retrieval",
          "inputs": [
            "knowledge_graph_exploration_steps",
            "max_code_lines_static_analysis",
            "query_type",
            "reordered_top_n_results",
            "top_n_vector_results",
            "user_input",
            "vector_similarity_threshold"
          ],
          "outputs": [
            "__graph_results__",
            "code_lines",
            "graph_results",
            "reordered_results",
            "similarity"
          ],
          "is_async": true,
          "body_code": "async def step_2_vector_retrieval(knowledge_graph_exploration_steps, max_code_lines_static_analysis, query_type, reordered_top_n_results, top_n_vector_results, user_input, vector_similarity_threshold):\n    \"\"\"Auto-generated module\"\"\"\n    if query_type == \"simple_fact\":\n        similarity = await invoke_function('vector_retrieval', user_input=user_input)\n        if similarity >= vector_similarity_threshold:\n            return await invoke_function('get_top_n_results', top_n_vector_results=top_n_vector_results)\n        else:\n            reordered_results = await invoke_function('reorder_results')\n            return await invoke_function('get_top_n_results', reordered_top_n_results=reordered_top_n_results)\n    elif query_type == \"complex_reasoning\":\n        await invoke_function('intent_decomposition', user_input=user_input)\n        graph_results = await invoke_function('graph_database_retrieval', knowledge_graph_exploration_steps=knowledge_graph_exploration_steps)\n        if graph_results   is  not   NULL:\n            return graph_results\n        else:\n            return await invoke_function('full_search')\n    elif query_type == \"code_analysis\":\n        code_lines = await invoke_function('count_code_lines', user_input=user_input)\n        if code_lines > max_code_lines_static_analysis:\n            return await invoke_function('static_analysis', user_input=user_input)\n        else:\n            return await invoke_function('semantic_analysis', user_input=user_input)\n    else:\n        return \"Invalid query type\"",
          "original_block_count": 26
        },
        {
          "name": "step_3_cache_results",
          "inputs": [
            "cache_expiry_time",
            "result",
            "user_input"
          ],
          "outputs": [],
          "is_async": true,
          "body_code": "async def step_3_cache_results(cache_expiry_time, result, user_input):\n    \"\"\"Auto-generated module\"\"\"\n    await invoke_function('cache_results', user_input=user_input, result=result, cache_expiry_time=cache_expiry_time)\n    return None",
          "original_block_count": 1
        },
        {
          "name": "step_4_queue_request",
          "inputs": [
            "current_requests",
            "max_concurrent_requests"
          ],
          "outputs": [],
          "is_async": true,
          "body_code": "async def step_4_queue_request(current_requests, max_concurrent_requests):\n    \"\"\"Auto-generated module\"\"\"\n    if current_requests > max_concurrent_requests:\n        await invoke_function('queue_request')\n    return None",
          "original_block_count": 3
        },
        {
          "name": "step_5_log_violation",
          "inputs": [
            "user_input"
          ],
          "outputs": [],
          "is_async": true,
          "body_code": "async def step_5_log_violation(user_input):\n    \"\"\"Auto-generated module\"\"\"\n    if await invoke_function('contains_sensitive_words', user_input=user_input):\n        await invoke_function('log_violation', user_input=user_input)\n        return \"Service denied due to sensitive content\"",
          "original_block_count": 4
        },
        {
          "name": "step_6_degrade_service",
          "inputs": [
            "total_response_time_limit",
            "vector_retrieval_response_time"
          ],
          "outputs": [],
          "is_async": true,
          "body_code": "async def step_6_degrade_service(total_response_time_limit, vector_retrieval_response_time):\n    \"\"\"Auto-generated module\"\"\"\n    if vector_retrieval_response_time > total_response_time_limit:\n        await invoke_function('degrade_service')\n    return None",
          "original_block_count": 3
        },
        {
          "name": "step_7_upload_logs",
          "inputs": [
            "access_log_retention_days",
            "debug_log_retention_days",
            "error_log_retention_days"
          ],
          "outputs": [],
          "is_async": true,
          "body_code": "async def step_7_upload_logs(access_log_retention_days, debug_log_retention_days, error_log_retention_days):\n    \"\"\"Auto-generated module\"\"\"\n    await invoke_function('upload_logs', error_log_retention_days=error_log_retention_days, access_log_retention_days=access_log_retention_days, debug_log_retention_days=debug_log_retention_days)\n    return None",
          "original_block_count": 1
        },
        {
          "name": "step_8_trigger_alert",
          "inputs": [
            "query_rate",
            "query_rate_duration_minutes"
          ],
          "outputs": [],
          "is_async": true,
          "body_code": "async def step_8_trigger_alert(query_rate, query_rate_duration_minutes):\n    \"\"\"Auto-generated module\"\"\"\n    if query_rate < 10  and  query_rate_duration_minutes >= 10:\n        await invoke_function('trigger_alert')\n    return None",
          "original_block_count": 3
        },
        {
          "name": "step_9_trigger_scaling",
          "inputs": [
            "_95th_percentile_response_time",
            "response_time_duration_minutes"
          ],
          "outputs": [],
          "is_async": true,
          "body_code": "async def step_9_trigger_scaling(_95th_percentile_response_time, response_time_duration_minutes):\n    \"\"\"Auto-generated module\"\"\"\n    if _95th_percentile_response_time > 3  and  response_time_duration_minutes >= 5:\n        await invoke_function('trigger_scaling')\n    return None",
          "original_block_count": 3
        }
      ]
    },
    "prompt40_step5_orchestration": {
      "main_inputs": [
        "95th_percentile_response_time",
        "current_requests",
        "query_rate",
        "result",
        "user_input"
      ],
      "input_count": 5,
      "main_code": "async def main_workflow(input_params: dict):\n    \"\"\"\n    主工作流 - 自动生成\n    \n    Args:\n        input_params: 包含 ['95th_percentile_response_time', 'current_requests', 'query_rate', 'result', 'user_input'] 的字典\n    \n    Returns:\n        执行结果上下文\n    \"\"\"\n    # 初始化上下文\n    ctx = input_params.copy()\n\n    # Module 1: step_1_compute_vector_similarity_threshold\n    ctx[\"access_log_retention_days\"], ctx[\"admin_user_priority\"], ctx[\"cache_expiry_time\"], ctx[\"code_analysis_response_time\"], ctx[\"debug_log_retention_days\"], ctx[\"error_log_retention_days\"], ctx[\"graph_database_response_time\"], ctx[\"knowledge_base_A_size\"], ctx[\"knowledge_base_B_size\"], ctx[\"knowledge_base_C_size\"], ctx[\"knowledge_graph_exploration_steps\"], ctx[\"max_code_lines_static_analysis\"], ctx[\"max_concurrent_requests\"], ctx[\"query_rate_duration_minutes\"], ctx[\"query_type\"], ctx[\"reordered_top_n_results\"], ctx[\"response_time_duration_minutes\"], ctx[\"top_n_vector_results\"], ctx[\"total_response_time_limit\"], ctx[\"vector_dimension\"], ctx[\"vector_retrieval_response_time\"], ctx[\"vector_similarity_threshold\"] = step_1_compute_vector_similarity_threshold(ctx.get(\"_95th_percentile_response_time\"), ctx.get(\"current_requests\"), ctx.get(\"query_rate\"))\n\n    # Module 2: step_2_vector_retrieval\n    ctx[\"__graph_results__\"], ctx[\"code_lines\"], ctx[\"graph_results\"], ctx[\"reordered_results\"], ctx[\"similarity\"] = await step_2_vector_retrieval(ctx.get(\"knowledge_graph_exploration_steps\"), ctx.get(\"max_code_lines_static_analysis\"), ctx.get(\"query_type\"), ctx.get(\"reordered_top_n_results\"), ctx.get(\"top_n_vector_results\"), ctx.get(\"user_input\"), ctx.get(\"vector_similarity_threshold\"))\n\n    # Module 3: step_3_cache_results\n    await step_3_cache_results(ctx.get(\"cache_expiry_time\"), ctx.get(\"result\"), ctx.get(\"user_input\"))\n\n    # Module 4: step_4_queue_request\n    await step_4_queue_request(ctx.get(\"current_requests\"), ctx.get(\"max_concurrent_requests\"))\n\n    # Module 5: step_5_log_violation\n    await step_5_log_violation(ctx.get(\"user_input\"))\n\n    # Module 6: step_6_degrade_service\n    await step_6_degrade_service(ctx.get(\"total_response_time_limit\"), ctx.get(\"vector_retrieval_response_time\"))\n\n    # Module 7: step_7_upload_logs\n    await step_7_upload_logs(ctx.get(\"access_log_retention_days\"), ctx.get(\"debug_log_retention_days\"), ctx.get(\"error_log_retention_days\"))\n\n    # Module 8: step_8_trigger_alert\n    await step_8_trigger_alert(ctx.get(\"query_rate\"), ctx.get(\"query_rate_duration_minutes\"))\n\n    # Module 9: step_9_trigger_scaling\n    await step_9_trigger_scaling(ctx.get(\"_95th_percentile_response_time\"), ctx.get(\"response_time_duration_minutes\"))\n\n    return ctx"
    },
    "overall_status": "success",
    "total_time_ms": 29645,
    "error_message": null
  },
  "0fab8fcf": {
    "pipeline_id": "0fab8fcf",
    "timestamp": "2026-01-30 15:15:45",
    "raw_input": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_id": "2280385d",
    "prompt10_original": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_processed": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
    "prompt10_mode": "dictionary",
    "prompt10_steps": [
      {
        "step_name": "术语对齐",
        "step_index": 1,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": [
          "替换 8 处"
        ]
      },
      {
        "step_name": "术语对齐",
        "step_index": 2,
        "input_text": "帮我设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回top-3结果；否则结合重排序模型重新评分，再返回top-5。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：QPS、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果QPS低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "帮我": "请",
          "top-3": "前3个结果",
          "top-5": "前5个结果",
          "知识图谱": "知识图谱(KG)",
          "向量索引": "向量索引(VI)",
          "QPS": "每秒查询率(QPS)",
          "缓存命中率": "缓存命中率(CRH)"
        },
        "duration_ms": 0,
        "notes": []
      },
      {
        "step_name": "LLM语义重构",
        "step_index": 3,
        "input_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n向量检索模式下，如果相似度超过0.85，直接返回前3个结果结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n图数据库检索时，需要沿着知识图谱(KG)进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码，如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n用户反馈环节：如果用户对结果不满意，点击\"重新生成\"时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引(VI)，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500ms内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率(QPS)、平均响应时间、95分位响应时间、缓存命中率(CRH)、检索准确率。如果每秒查询率(QPS)低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "output_text": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过0.85，直接返回前3个结果；否则结合重排序模型重新评分，再返回前5个结果。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行2跳邻居探索，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期30分钟。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过500行，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含2000个医学文档，知识库B包含3000个技术文档，知识库C包含1500个法律文档。每个知识库都有独立的向量索引，向量维度统一为1536。\n\n并发控制：系统支持最大50个并发请求，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为10。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在500毫秒内完成，图数据库检索在1秒内完成，代码分析在2秒内完成。总响应时间不超过3秒，否则降级服务。\n\n日志级别：错误日志保留90天，访问日志保留30天，调试日志保留7天。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续10分钟，触发告警；如果95分位响应时间超过3秒持续5分钟，触发扩容。",
        "changes": {
          "标准化": "840字 → 818字"
        },
        "duration_ms": 10514,
        "notes": []
      }
    ],
    "prompt10_terminology_changes": {
      "帮我": "请",
      "top-3": "前3个结果",
      "top-5": "前5个结果",
      "知识图谱": "知识图谱(KG)",
      "向量索引": "向量索引(VI)",
      "QPS": "每秒查询率(QPS)",
      "缓存命中率": "缓存命中率(CRH)"
    },
    "prompt10_ambiguity_detected": false,
    "prompt10_status": "success",
    "prompt10_time_ms": 10515,
    "prompt20_id": "6b3eb5ac",
    "prompt20_template": "请设计一个智能问答系统，需要处理多领域知识库的检索与推理。\n\n首先，用户输入查询后，系统需要判断查询类型：如果是简单事实查询，走向量检索通道；如果是复杂推理查询，先进行意图分解，再走图数据库检索；如果是代码相关问题，则调用代码分析引擎。\n\n在向量检索模式下，如果相似度超过{{similarity_threshold}}，直接返回{{top_n_vector_results}}；否则结合重排序模型重新评分，再返回{{reordered_top_n_results}}。检索失败时自动切换到混合检索模式。\n\n在图数据库检索时，需要沿着知识图谱进行{{graph_exploration_steps}}，如果找到匹配节点则返回相关实体和关系，否则回退到全量搜索。每次查询都要缓存结果，缓存有效期{{cache_expiration_time}}。\n\n代码分析引擎支持Python和Java代码。如果代码行数超过{{max_code_lines_static_analysis}}，只进行静态分析；如果少于500行，则进行完整语义分析并生成解释文档。\n\n在用户反馈环节，如果用户对结果不满意，点击“重新生成”时启用更强的推理模型；如果连续3次不满意，则自动升级到人工审核队列。\n\n数据源配置：知识库A包含{{medical_documents_count}}，知识库B包含{{technical_documents_count}}，知识库C包含{{legal_documents_count}}。每个知识库都有独立的向量索引，向量维度统一为{{vector_dimension}}。\n\n并发控制：系统支持最大{{max_concurrent_requests}}，如果超过则排队等待。普通用户优先级设为1，VIP用户优先级设为5，管理员优先级设为{{admin_user_priority}}。\n\n安全策略：所有查询内容经过敏感词过滤，如果检测到违规内容则拒绝服务并记录日志。对于金融类查询，需要二次确认用户身份。\n\n响应时间要求：向量检索要在{{vector_retrieval_response_time}}内完成，图数据库检索在{{graph_database_response_time}}内完成，代码分析在{{code_analysis_response_time}}内完成。总响应时间不超过{{total_response_time_limit}}，否则降级服务。\n\n日志级别：错误日志保留{{error_log_retention_days}}，访问日志保留{{access_log_retention_days}}，调试日志保留{{debug_log_retention_days}}。所有日志都要上传到中央日志系统。\n\n监控指标：每秒查询率、平均响应时间、95分位响应时间、缓存命中率、检索准确率。如果每秒查询率低于10持续{{query_rate_duration_minutes}}，触发告警；如果95分位响应时间超过3秒持续{{response_time_duration_minutes}}，触发扩容。",
    "prompt20_variables": [
      {
        "variable": "similarity_threshold",
        "original_text": "0.85",
        "value": "0.85",
        "type": "String"
      },
      {
        "variable": "top_n_vector_results",
        "original_text": "前3个结果",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "reordered_top_n_results",
        "original_text": "前5个结果",
        "value": 5,
        "type": "Integer"
      },
      {
        "variable": "graph_exploration_steps",
        "original_text": "2跳邻居探索",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "cache_expiration_time",
        "original_text": "30分钟",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "max_code_lines_static_analysis",
        "original_text": "500行",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "medical_documents_count",
        "original_text": "2000个医学文档",
        "value": 2000,
        "type": "Integer"
      },
      {
        "variable": "technical_documents_count",
        "original_text": "3000个技术文档",
        "value": 3000,
        "type": "Integer"
      },
      {
        "variable": "legal_documents_count",
        "original_text": "1500个法律文档",
        "value": 1500,
        "type": "Integer"
      },
      {
        "variable": "vector_dimension",
        "original_text": "1536",
        "value": 1536,
        "type": "Integer"
      },
      {
        "variable": "max_concurrent_requests",
        "original_text": "50个并发请求",
        "value": 50,
        "type": "Integer"
      },
      {
        "variable": "admin_user_priority",
        "original_text": "10",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "vector_retrieval_response_time",
        "original_text": "500毫秒",
        "value": 500,
        "type": "Integer"
      },
      {
        "variable": "graph_database_response_time",
        "original_text": "1秒",
        "value": 1,
        "type": "Integer"
      },
      {
        "variable": "code_analysis_response_time",
        "original_text": "2秒",
        "value": 2,
        "type": "Integer"
      },
      {
        "variable": "total_response_time_limit",
        "original_text": "3秒",
        "value": 3,
        "type": "Integer"
      },
      {
        "variable": "error_log_retention_days",
        "original_text": "90天",
        "value": 90,
        "type": "Integer"
      },
      {
        "variable": "access_log_retention_days",
        "original_text": "30天",
        "value": 30,
        "type": "Integer"
      },
      {
        "variable": "debug_log_retention_days",
        "original_text": "7天",
        "value": 7,
        "type": "Integer"
      },
      {
        "variable": "query_rate_duration_minutes",
        "original_text": "10分钟",
        "value": 10,
        "type": "Integer"
      },
      {
        "variable": "response_time_duration_minutes",
        "original_text": "5分钟",
        "value": 5,
        "type": "Integer"
      }
    ],
    "prompt20_variable_count": 21,
    "prompt20_type_stats": {
      "String": 1,
      "Integer": 20
    },
    "prompt20_extraction_log": [],
    "prompt20_time_ms": 0,
    "prompt30_id": "d6e2e93f",
    "prompt30_dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{medical_documents_count}}: Integer = 2000\nDEFINE {{technical_documents_count}}: Integer = 3000\nDEFINE {{legal_documents_count}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nDEFINE {{current_requests}}: Integer\nDEFINE {{query_rate}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\n{{query_type}} = user_input\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval()\n    IF {{vector_results}}.similarity > {{similarity_threshold}}\n        RETURN {{vector_results}}.top_n[{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results}}.top_n[{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposed}} = CALL decompose_intent(user_input)\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposed}}, {{graph_exploration_steps}})\n    IF {{graph_results}}.found\n        RETURN {{graph_results}}.entities_and_relationships\n    ELSE\n        {{full_search_results}} = CALL full_search()\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = user_input.lines\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis(user_input)\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis(user_input)\n    ENDIF\n    RETURN {{analysis_results}}\nELSE\n    RETURN \"Unsupported query type\"\nENDIF\nIF user_feedback == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model(user_input)\n    RETURN {{stronger_model_results}}\nENDIF\nIF user_feedback == \"unsatisfied\"\n    {{unsatisfied_count}} += 1\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\n{{medical_documents}} = {{medical_documents_count}}\n{{technical_documents}} = {{technical_documents_count}}\n{{legal_documents}} = {{legal_documents_count}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\n{{filtered_content}} = CALL filter_sensitive_content(user_input)\nIF {{filtered_content}}.contains_sensitive_content\n    CALL log_violation(user_input)\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{confirmation}} = CALL confirm_user_identity(user_input)\n    IF NOT {{confirmation}}.confirmed\n        RETURN \"Identity confirmation required\"\n    ENDIF\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR {{query_rate_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{response_time_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
    "prompt30_validation_result": {
      "is_valid": true,
      "errors": [],
      "warnings": [],
      "defined_variables": {
        "similarity_threshold": {
          "name": "similarity_threshold",
          "var_type": "String",
          "initial_value": "0.85",
          "line_number": 1
        },
        "top_n_vector_results": {
          "name": "top_n_vector_results",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 2
        },
        "reordered_top_n_results": {
          "name": "reordered_top_n_results",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 3
        },
        "graph_exploration_steps": {
          "name": "graph_exploration_steps",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 4
        },
        "cache_expiration_time": {
          "name": "cache_expiration_time",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 5
        },
        "max_code_lines_static_analysis": {
          "name": "max_code_lines_static_analysis",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 6
        },
        "medical_documents_count": {
          "name": "medical_documents_count",
          "var_type": "Integer",
          "initial_value": "2000",
          "line_number": 7
        },
        "technical_documents_count": {
          "name": "technical_documents_count",
          "var_type": "Integer",
          "initial_value": "3000",
          "line_number": 8
        },
        "legal_documents_count": {
          "name": "legal_documents_count",
          "var_type": "Integer",
          "initial_value": "1500",
          "line_number": 9
        },
        "vector_dimension": {
          "name": "vector_dimension",
          "var_type": "Integer",
          "initial_value": "1536",
          "line_number": 10
        },
        "max_concurrent_requests": {
          "name": "max_concurrent_requests",
          "var_type": "Integer",
          "initial_value": "50",
          "line_number": 11
        },
        "admin_user_priority": {
          "name": "admin_user_priority",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 12
        },
        "vector_retrieval_response_time": {
          "name": "vector_retrieval_response_time",
          "var_type": "Integer",
          "initial_value": "500",
          "line_number": 13
        },
        "graph_database_response_time": {
          "name": "graph_database_response_time",
          "var_type": "Integer",
          "initial_value": "1",
          "line_number": 14
        },
        "code_analysis_response_time": {
          "name": "code_analysis_response_time",
          "var_type": "Integer",
          "initial_value": "2",
          "line_number": 15
        },
        "total_response_time_limit": {
          "name": "total_response_time_limit",
          "var_type": "Integer",
          "initial_value": "3",
          "line_number": 16
        },
        "error_log_retention_days": {
          "name": "error_log_retention_days",
          "var_type": "Integer",
          "initial_value": "90",
          "line_number": 17
        },
        "access_log_retention_days": {
          "name": "access_log_retention_days",
          "var_type": "Integer",
          "initial_value": "30",
          "line_number": 18
        },
        "debug_log_retention_days": {
          "name": "debug_log_retention_days",
          "var_type": "Integer",
          "initial_value": "7",
          "line_number": 19
        },
        "query_rate_duration_minutes": {
          "name": "query_rate_duration_minutes",
          "var_type": "Integer",
          "initial_value": "10",
          "line_number": 20
        },
        "response_time_duration_minutes": {
          "name": "response_time_duration_minutes",
          "var_type": "Integer",
          "initial_value": "5",
          "line_number": 21
        },
        "current_requests": {
          "name": "current_requests",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 22
        },
        "query_rate": {
          "name": "query_rate",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 23
        },
        "95th_percentile_response_time": {
          "name": "95th_percentile_response_time",
          "var_type": "Integer",
          "initial_value": null,
          "line_number": 24
        }
      },
      "runtime_variables": [
        "intent_decomposed",
        "confirmation",
        "code_lines",
        "technical_documents",
        "stronger_model_results",
        "filtered_content",
        "vector_results",
        "analysis_results",
        "medical_documents",
        "full_search_results",
        "legal_documents",
        "graph_results",
        "unsatisfied_count",
        "query_type",
        "reordered_results"
      ],
      "function_calls": [
        {
          "function_name": "vector_retrieval",
          "arguments": [],
          "result_var": "vector_results",
          "line_number": 27
        },
        {
          "function_name": "reorder_results",
          "arguments": [
            "{{vector_results}}"
          ],
          "result_var": "reordered_results",
          "line_number": 31
        },
        {
          "function_name": "decompose_intent",
          "arguments": [
            "user_input"
          ],
          "result_var": "intent_decomposed",
          "line_number": 35
        },
        {
          "function_name": "graph_database_retrieval",
          "arguments": [
            "{{intent_decomposed}}",
            "{{graph_exploration_steps}}"
          ],
          "result_var": "graph_results",
          "line_number": 36
        },
        {
          "function_name": "full_search",
          "arguments": [],
          "result_var": "full_search_results",
          "line_number": 40
        },
        {
          "function_name": "static_analysis",
          "arguments": [
            "user_input"
          ],
          "result_var": "analysis_results",
          "line_number": 46
        },
        {
          "function_name": "semantic_analysis",
          "arguments": [
            "user_input"
          ],
          "result_var": "analysis_results",
          "line_number": 48
        },
        {
          "function_name": "stronger_reasoning_model",
          "arguments": [
            "user_input"
          ],
          "result_var": "stronger_model_results",
          "line_number": 55
        },
        {
          "function_name": "filter_sensitive_content",
          "arguments": [
            "user_input"
          ],
          "result_var": "filtered_content",
          "line_number": 70
        },
        {
          "function_name": "confirm_user_identity",
          "arguments": [
            "user_input"
          ],
          "result_var": "confirmation",
          "line_number": 76
        }
      ],
      "control_blocks": [],
      "max_nesting_depth": 2
    },
    "prompt30_time_ms": 24890,
    "prompt30_compile_history": {
      "attempts": [
        {
          "attempt": 1,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{medical_documents_count}}: Integer = 2000\nDEFINE {{technical_documents_count}}: Integer = 3000\nDEFINE {{legal_documents_count}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\n{{query_type}} = CALL determine_query_type({{user_input}})\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval({{user_input}})\n    IF {{vector_results}}.similarity >= {{similarity_threshold}}\n        RETURN {{vector_results}}.top_n[{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results}}.top_n[{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent}} = CALL decompose_intent({{user_input}})\n    {{graph_results}} = CALL graph_database_retrieval({{intent}}, {{graph_exploration_steps}})\n    IF {{graph_results}}.found\n        RETURN {{graph_results}}.entities_and_relationships\n    ELSE\n        {{full_search_results}} = CALL full_search({{user_input}})\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = CALL count_code_lines({{user_input}})\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{static_analysis_results}} = CALL static_analysis({{user_input}})\n        RETURN {{static_analysis_results}}\n    ELSE\n        {{semantic_analysis_results}} = CALL semantic_analysis({{user_input}})\n        RETURN {{semantic_analysis_results}}\n    ENDIF\nELSE\n    RETURN \"Unsupported query type\"\nENDIF\nIF {{user_feedback}} == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model({{user_input}})\n    RETURN {{stronger_model_results}}\nENDIF\nIF {{user_feedback}} == \"not_satisfied\"\n    {{unsatisfied_count}} = {{unsatisfied_count}} + 1\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\nDEFINE {{knowledge_base_A}}: Integer = {{medical_documents_count}}\nDEFINE {{knowledge_base_B}}: Integer = {{technical_documents_count}}\nDEFINE {{knowledge_base_C}}: Integer = {{legal_documents_count}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request({{user_input}})\nENDIF\n{{filtered_content}} = CALL filter_sensitive_content({{user_input}})\nIF {{filtered_content}}.contains_sensitive_terms\n    CALL log_violation({{filtered_content}})\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{identity_confirmation}} = CALL confirm_user_identity({{user_input}})\n    IF NOT {{identity_confirmation}}.confirmed\n        RETURN \"Identity confirmation required\"\n    ENDIF\nENDIF\nIF {{response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR {{query_rate_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{response_time_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 3,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 3,
            "p2_count": 0,
            "total": 3
          }
        },
        {
          "attempt": 2,
          "dsl_code": "DEFINE {{similarity_threshold}}: String = 0.85\nDEFINE {{top_n_vector_results}}: Integer = 3\nDEFINE {{reordered_top_n_results}}: Integer = 5\nDEFINE {{graph_exploration_steps}}: Integer = 2\nDEFINE {{cache_expiration_time}}: Integer = 30\nDEFINE {{max_code_lines_static_analysis}}: Integer = 500\nDEFINE {{medical_documents_count}}: Integer = 2000\nDEFINE {{technical_documents_count}}: Integer = 3000\nDEFINE {{legal_documents_count}}: Integer = 1500\nDEFINE {{vector_dimension}}: Integer = 1536\nDEFINE {{max_concurrent_requests}}: Integer = 50\nDEFINE {{admin_user_priority}}: Integer = 10\nDEFINE {{vector_retrieval_response_time}}: Integer = 500\nDEFINE {{graph_database_response_time}}: Integer = 1\nDEFINE {{code_analysis_response_time}}: Integer = 2\nDEFINE {{total_response_time_limit}}: Integer = 3\nDEFINE {{error_log_retention_days}}: Integer = 90\nDEFINE {{access_log_retention_days}}: Integer = 30\nDEFINE {{debug_log_retention_days}}: Integer = 7\nDEFINE {{query_rate_duration_minutes}}: Integer = 10\nDEFINE {{response_time_duration_minutes}}: Integer = 5\nDEFINE {{current_requests}}: Integer\nDEFINE {{query_rate}}: Integer\nDEFINE {{95th_percentile_response_time}}: Integer\n{{query_type}} = user_input\nIF {{query_type}} == \"simple_fact\"\n    {{vector_results}} = CALL vector_retrieval()\n    IF {{vector_results}}.similarity > {{similarity_threshold}}\n        RETURN {{vector_results}}.top_n[{{top_n_vector_results}}]\n    ELSE\n        {{reordered_results}} = CALL reorder_results({{vector_results}})\n        RETURN {{reordered_results}}.top_n[{{reordered_top_n_results}}]\n    ENDIF\nELIF {{query_type}} == \"complex_reasoning\"\n    {{intent_decomposed}} = CALL decompose_intent(user_input)\n    {{graph_results}} = CALL graph_database_retrieval({{intent_decomposed}}, {{graph_exploration_steps}})\n    IF {{graph_results}}.found\n        RETURN {{graph_results}}.entities_and_relationships\n    ELSE\n        {{full_search_results}} = CALL full_search()\n        RETURN {{full_search_results}}\n    ENDIF\nELIF {{query_type}} == \"code_related\"\n    {{code_lines}} = user_input.lines\n    IF {{code_lines}} > {{max_code_lines_static_analysis}}\n        {{analysis_results}} = CALL static_analysis(user_input)\n    ELSE\n        {{analysis_results}} = CALL semantic_analysis(user_input)\n    ENDIF\n    RETURN {{analysis_results}}\nELSE\n    RETURN \"Unsupported query type\"\nENDIF\nIF user_feedback == \"regenerate\"\n    {{stronger_model_results}} = CALL stronger_reasoning_model(user_input)\n    RETURN {{stronger_model_results}}\nENDIF\nIF user_feedback == \"unsatisfied\"\n    {{unsatisfied_count}} += 1\n    IF {{unsatisfied_count}} >= 3\n        CALL escalate_to_human_review()\n    ENDIF\nENDIF\n{{medical_documents}} = {{medical_documents_count}}\n{{technical_documents}} = {{technical_documents_count}}\n{{legal_documents}} = {{legal_documents_count}}\nIF {{current_requests}} > {{max_concurrent_requests}}\n    CALL queue_request()\nENDIF\n{{filtered_content}} = CALL filter_sensitive_content(user_input)\nIF {{filtered_content}}.contains_sensitive_content\n    CALL log_violation(user_input)\n    RETURN \"Service denied due to sensitive content\"\nENDIF\nIF {{query_type}} == \"financial\"\n    {{confirmation}} = CALL confirm_user_identity(user_input)\n    IF NOT {{confirmation}}.confirmed\n        RETURN \"Identity confirmation required\"\n    ENDIF\nENDIF\nIF {{vector_retrieval_response_time}} > {{total_response_time_limit}}\n    CALL degrade_service()\nENDIF\nCALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})\nIF {{query_rate}} < 10 FOR {{query_rate_duration_minutes}} MINUTES\n    CALL trigger_alert()\nENDIF\nIF {{95th_percentile_response_time}} > 3 FOR {{response_time_duration_minutes}} MINUTES\n    CALL trigger_scaling()\nENDIF",
          "total_errors": 0,
          "error_analysis": {
            "p0_count": 0,
            "p1_count": 0,
            "p2_count": 0,
            "total": 0
          }
        }
      ],
      "final_decision": "success",
      "error_summary": {},
      "auto_fix_applied": true
    },
    "prompt30_success": true,
    "prompt40_id": "7098af06",
    "prompt40_modules": [
      {
        "name": "step_1_compute_similarity_threshold",
        "inputs": [
          "_95th_percentile_response_time",
          "current_requests",
          "query_rate"
        ],
        "outputs": [
          "access_log_retention_days",
          "admin_user_priority",
          "cache_expiration_time",
          "code_analysis_response_time",
          "debug_log_retention_days",
          "error_log_retention_days",
          "graph_database_response_time",
          "graph_exploration_steps",
          "legal_documents_count",
          "max_code_lines_static_analysis",
          "max_concurrent_requests",
          "medical_documents_count",
          "query_rate_duration_minutes",
          "query_type",
          "reordered_top_n_results",
          "response_time_duration_minutes",
          "similarity_threshold",
          "technical_documents_count",
          "top_n_vector_results",
          "total_response_time_limit",
          "vector_dimension",
          "vector_retrieval_response_time"
        ],
        "is_async": false
      },
      {
        "name": "step_2_vector_retrieval",
        "inputs": [
          "graph_exploration_steps",
          "max_code_lines_static_analysis",
          "query_type",
          "reordered_top_n_results",
          "similarity_threshold",
          "top_n_vector_results"
        ],
        "outputs": [
          "__analysis_results__",
          "__full_search_results__",
          "__graph_results___entities_and_relationships",
          "__reordered_results___top_n___reordered_top_n_results___",
          "__vector_results___top_n___top_n_vector_results___",
          "analysis_results",
          "code_lines",
          "full_search_results",
          "graph_results",
          "intent_decomposed",
          "reordered_results",
          "vector_results"
        ],
        "is_async": true
      },
      {
        "name": "step_3_stronger_reasoning_model",
        "inputs": [],
        "outputs": [
          "__stronger_model_results__",
          "stronger_model_results"
        ],
        "is_async": true
      },
      {
        "name": "step_4_escalate_to_human_review",
        "inputs": [],
        "outputs": [
          "unsatisfied_count"
        ],
        "is_async": true
      },
      {
        "name": "step_5_compute_medical_documents",
        "inputs": [
          "legal_documents_count",
          "medical_documents_count",
          "technical_documents_count"
        ],
        "outputs": [
          "legal_documents",
          "medical_documents",
          "technical_documents"
        ],
        "is_async": false
      },
      {
        "name": "step_6_queue_request",
        "inputs": [
          "current_requests",
          "max_concurrent_requests"
        ],
        "outputs": [],
        "is_async": true
      },
      {
        "name": "step_7_filter_sensitive_content",
        "inputs": [],
        "outputs": [
          "filtered_content"
        ],
        "is_async": true
      },
      {
        "name": "step_8_log_violation",
        "inputs": [
          "filtered_content"
        ],
        "outputs": [],
        "is_async": true
      },
      {
        "name": "step_9_confirm_user_identity",
        "inputs": [
          "query_type"
        ],
        "outputs": [
          "confirmation"
        ],
        "is_async": true
      },
      {
        "name": "step_10_degrade_service",
        "inputs": [
          "total_response_time_limit",
          "vector_retrieval_response_time"
        ],
        "outputs": [],
        "is_async": true
      },
      {
        "name": "step_11_upload_logs",
        "inputs": [
          "access_log_retention_days",
          "debug_log_retention_days",
          "error_log_retention_days"
        ],
        "outputs": [],
        "is_async": true
      },
      {
        "name": "step_12_trigger_alert",
        "inputs": [
          "query_rate",
          "query_rate_duration_minutes"
        ],
        "outputs": [],
        "is_async": true
      },
      {
        "name": "step_13_trigger_scaling",
        "inputs": [
          "_95th_percentile_response_time",
          "response_time_duration_minutes"
        ],
        "outputs": [],
        "is_async": true
      }
    ],
    "prompt40_module_count": 13,
    "prompt40_main_code": "async def main_workflow(input_params: dict):\n    \"\"\"\n    主工作流 - 自动生成\n    \n    Args:\n        input_params: 包含 ['95th_percentile_response_time', 'current_requests', 'query_rate'] 的字典\n    \n    Returns:\n        执行结果上下文\n    \"\"\"\n    # 初始化上下文\n    ctx = input_params.copy()\n\n    # Module 1: step_1_compute_similarity_threshold\n    ctx[\"access_log_retention_days\"], ctx[\"admin_user_priority\"], ctx[\"cache_expiration_time\"], ctx[\"code_analysis_response_time\"], ctx[\"debug_log_retention_days\"], ctx[\"error_log_retention_days\"], ctx[\"graph_database_response_time\"], ctx[\"graph_exploration_steps\"], ctx[\"legal_documents_count\"], ctx[\"max_code_lines_static_analysis\"], ctx[\"max_concurrent_requests\"], ctx[\"medical_documents_count\"], ctx[\"query_rate_duration_minutes\"], ctx[\"query_type\"], ctx[\"reordered_top_n_results\"], ctx[\"response_time_duration_minutes\"], ctx[\"similarity_threshold\"], ctx[\"technical_documents_count\"], ctx[\"top_n_vector_results\"], ctx[\"total_response_time_limit\"], ctx[\"vector_dimension\"], ctx[\"vector_retrieval_response_time\"] = step_1_compute_similarity_threshold(ctx.get(\"_95th_percentile_response_time\"), ctx.get(\"current_requests\"), ctx.get(\"query_rate\"))\n\n    # Module 2: step_2_vector_retrieval\n    ctx[\"__analysis_results__\"], ctx[\"__full_search_results__\"], ctx[\"__graph_results___entities_and_relationships\"], ctx[\"__reordered_results___top_n___reordered_top_n_results___\"], ctx[\"__vector_results___top_n___top_n_vector_results___\"], ctx[\"analysis_results\"], ctx[\"code_lines\"], ctx[\"full_search_results\"], ctx[\"graph_results\"], ctx[\"intent_decomposed\"], ctx[\"reordered_results\"], ctx[\"vector_results\"] = await step_2_vector_retrieval(ctx.get(\"graph_exploration_steps\"), ctx.get(\"max_code_lines_static_analysis\"), ctx.get(\"query_type\"), ctx.get(\"reordered_top_n_results\"), ctx.get(\"similarity_threshold\"), ctx.get(\"top_n_vector_results\"))\n\n    # Module 3: step_3_stronger_reasoning_model\n    ctx[\"__stronger_model_results__\"], ctx[\"stronger_model_results\"] = await step_3_stronger_reasoning_model()\n\n    # Module 4: step_4_escalate_to_human_review\n    ctx[\"unsatisfied_count\"] = await step_4_escalate_to_human_review()\n\n    # Module 5: step_5_compute_medical_documents\n    ctx[\"legal_documents\"], ctx[\"medical_documents\"], ctx[\"technical_documents\"] = step_5_compute_medical_documents(ctx.get(\"legal_documents_count\"), ctx.get(\"medical_documents_count\"), ctx.get(\"technical_documents_count\"))\n\n    # Module 6: step_6_queue_request\n    await step_6_queue_request(ctx.get(\"current_requests\"), ctx.get(\"max_concurrent_requests\"))\n\n    # Module 7: step_7_filter_sensitive_content\n    ctx[\"filtered_content\"] = await step_7_filter_sensitive_content()\n\n    # Module 8: step_8_log_violation\n    await step_8_log_violation(ctx.get(\"filtered_content\"))\n\n    # Module 9: step_9_confirm_user_identity\n    ctx[\"confirmation\"] = await step_9_confirm_user_identity(ctx.get(\"query_type\"))\n\n    # Module 10: step_10_degrade_service\n    await step_10_degrade_service(ctx.get(\"total_response_time_limit\"), ctx.get(\"vector_retrieval_response_time\"))\n\n    # Module 11: step_11_upload_logs\n    await step_11_upload_logs(ctx.get(\"access_log_retention_days\"), ctx.get(\"debug_log_retention_days\"), ctx.get(\"error_log_retention_days\"))\n\n    # Module 12: step_12_trigger_alert\n    await step_12_trigger_alert(ctx.get(\"query_rate\"), ctx.get(\"query_rate_duration_minutes\"))\n\n    # Module 13: step_13_trigger_scaling\n    await step_13_trigger_scaling(ctx.get(\"_95th_percentile_response_time\"), ctx.get(\"response_time_duration_minutes\"))\n\n    return ctx",
    "prompt40_time_ms": 10,
    "prompt40_step1_parsing": {
      "total_blocks": 90,
      "block_types": {
        "ASSIGN": 39,
        "IF": 14,
        "CALL": 17,
        "ELSE": 4,
        "ENDIF": 14,
        "ELIF": 2
      },
      "blocks": [
        {
          "id": "OP_0",
          "type": "ASSIGN",
          "line_number": 1,
          "is_async": false,
          "inputs": [
            "similarity_threshold"
          ],
          "outputs": [
            "similarity_threshold"
          ],
          "code_lines": [
            "DEFINE {{similarity_threshold}}: String = 0.85"
          ]
        },
        {
          "id": "OP_1",
          "type": "ASSIGN",
          "line_number": 2,
          "is_async": false,
          "inputs": [
            "top_n_vector_results"
          ],
          "outputs": [
            "top_n_vector_results"
          ],
          "code_lines": [
            "DEFINE {{top_n_vector_results}}: Integer = 3"
          ]
        },
        {
          "id": "OP_2",
          "type": "ASSIGN",
          "line_number": 3,
          "is_async": false,
          "inputs": [
            "reordered_top_n_results"
          ],
          "outputs": [
            "reordered_top_n_results"
          ],
          "code_lines": [
            "DEFINE {{reordered_top_n_results}}: Integer = 5"
          ]
        },
        {
          "id": "OP_3",
          "type": "ASSIGN",
          "line_number": 4,
          "is_async": false,
          "inputs": [
            "graph_exploration_steps"
          ],
          "outputs": [
            "graph_exploration_steps"
          ],
          "code_lines": [
            "DEFINE {{graph_exploration_steps}}: Integer = 2"
          ]
        },
        {
          "id": "OP_4",
          "type": "ASSIGN",
          "line_number": 5,
          "is_async": false,
          "inputs": [
            "cache_expiration_time"
          ],
          "outputs": [
            "cache_expiration_time"
          ],
          "code_lines": [
            "DEFINE {{cache_expiration_time}}: Integer = 30"
          ]
        },
        {
          "id": "OP_5",
          "type": "ASSIGN",
          "line_number": 6,
          "is_async": false,
          "inputs": [
            "max_code_lines_static_analysis"
          ],
          "outputs": [
            "max_code_lines_static_analysis"
          ],
          "code_lines": [
            "DEFINE {{max_code_lines_static_analysis}}: Integer = 500"
          ]
        },
        {
          "id": "OP_6",
          "type": "ASSIGN",
          "line_number": 7,
          "is_async": false,
          "inputs": [
            "medical_documents_count"
          ],
          "outputs": [
            "medical_documents_count"
          ],
          "code_lines": [
            "DEFINE {{medical_documents_count}}: Integer = 2000"
          ]
        },
        {
          "id": "OP_7",
          "type": "ASSIGN",
          "line_number": 8,
          "is_async": false,
          "inputs": [
            "technical_documents_count"
          ],
          "outputs": [
            "technical_documents_count"
          ],
          "code_lines": [
            "DEFINE {{technical_documents_count}}: Integer = 3000"
          ]
        },
        {
          "id": "OP_8",
          "type": "ASSIGN",
          "line_number": 9,
          "is_async": false,
          "inputs": [
            "legal_documents_count"
          ],
          "outputs": [
            "legal_documents_count"
          ],
          "code_lines": [
            "DEFINE {{legal_documents_count}}: Integer = 1500"
          ]
        },
        {
          "id": "OP_9",
          "type": "ASSIGN",
          "line_number": 10,
          "is_async": false,
          "inputs": [
            "vector_dimension"
          ],
          "outputs": [
            "vector_dimension"
          ],
          "code_lines": [
            "DEFINE {{vector_dimension}}: Integer = 1536"
          ]
        },
        {
          "id": "OP_10",
          "type": "ASSIGN",
          "line_number": 11,
          "is_async": false,
          "inputs": [
            "max_concurrent_requests"
          ],
          "outputs": [
            "max_concurrent_requests"
          ],
          "code_lines": [
            "DEFINE {{max_concurrent_requests}}: Integer = 50"
          ]
        },
        {
          "id": "OP_11",
          "type": "ASSIGN",
          "line_number": 12,
          "is_async": false,
          "inputs": [
            "admin_user_priority"
          ],
          "outputs": [
            "admin_user_priority"
          ],
          "code_lines": [
            "DEFINE {{admin_user_priority}}: Integer = 10"
          ]
        },
        {
          "id": "OP_12",
          "type": "ASSIGN",
          "line_number": 13,
          "is_async": false,
          "inputs": [
            "vector_retrieval_response_time"
          ],
          "outputs": [
            "vector_retrieval_response_time"
          ],
          "code_lines": [
            "DEFINE {{vector_retrieval_response_time}}: Integer = 500"
          ]
        },
        {
          "id": "OP_13",
          "type": "ASSIGN",
          "line_number": 14,
          "is_async": false,
          "inputs": [
            "graph_database_response_time"
          ],
          "outputs": [
            "graph_database_response_time"
          ],
          "code_lines": [
            "DEFINE {{graph_database_response_time}}: Integer = 1"
          ]
        },
        {
          "id": "OP_14",
          "type": "ASSIGN",
          "line_number": 15,
          "is_async": false,
          "inputs": [
            "code_analysis_response_time"
          ],
          "outputs": [
            "code_analysis_response_time"
          ],
          "code_lines": [
            "DEFINE {{code_analysis_response_time}}: Integer = 2"
          ]
        },
        {
          "id": "OP_15",
          "type": "ASSIGN",
          "line_number": 16,
          "is_async": false,
          "inputs": [
            "total_response_time_limit"
          ],
          "outputs": [
            "total_response_time_limit"
          ],
          "code_lines": [
            "DEFINE {{total_response_time_limit}}: Integer = 3"
          ]
        },
        {
          "id": "OP_16",
          "type": "ASSIGN",
          "line_number": 17,
          "is_async": false,
          "inputs": [
            "error_log_retention_days"
          ],
          "outputs": [
            "error_log_retention_days"
          ],
          "code_lines": [
            "DEFINE {{error_log_retention_days}}: Integer = 90"
          ]
        },
        {
          "id": "OP_17",
          "type": "ASSIGN",
          "line_number": 18,
          "is_async": false,
          "inputs": [
            "access_log_retention_days"
          ],
          "outputs": [
            "access_log_retention_days"
          ],
          "code_lines": [
            "DEFINE {{access_log_retention_days}}: Integer = 30"
          ]
        },
        {
          "id": "OP_18",
          "type": "ASSIGN",
          "line_number": 19,
          "is_async": false,
          "inputs": [
            "debug_log_retention_days"
          ],
          "outputs": [
            "debug_log_retention_days"
          ],
          "code_lines": [
            "DEFINE {{debug_log_retention_days}}: Integer = 7"
          ]
        },
        {
          "id": "OP_19",
          "type": "ASSIGN",
          "line_number": 20,
          "is_async": false,
          "inputs": [
            "query_rate_duration_minutes"
          ],
          "outputs": [
            "query_rate_duration_minutes"
          ],
          "code_lines": [
            "DEFINE {{query_rate_duration_minutes}}: Integer = 10"
          ]
        },
        {
          "id": "OP_20",
          "type": "ASSIGN",
          "line_number": 21,
          "is_async": false,
          "inputs": [
            "response_time_duration_minutes"
          ],
          "outputs": [
            "response_time_duration_minutes"
          ],
          "code_lines": [
            "DEFINE {{response_time_duration_minutes}}: Integer = 5"
          ]
        },
        {
          "id": "OP_21",
          "type": "ASSIGN",
          "line_number": 22,
          "is_async": false,
          "inputs": [
            "current_requests"
          ],
          "outputs": [],
          "code_lines": [
            "DEFINE {{current_requests}}: Integer"
          ]
        },
        {
          "id": "OP_22",
          "type": "ASSIGN",
          "line_number": 23,
          "is_async": false,
          "inputs": [
            "query_rate"
          ],
          "outputs": [],
          "code_lines": [
            "DEFINE {{query_rate}}: Integer"
          ]
        },
        {
          "id": "OP_23",
          "type": "ASSIGN",
          "line_number": 24,
          "is_async": false,
          "inputs": [
            "95th_percentile_response_time"
          ],
          "outputs": [],
          "code_lines": [
            "DEFINE {{95th_percentile_response_time}}: Integer"
          ]
        },
        {
          "id": "OP_24",
          "type": "ASSIGN",
          "line_number": 25,
          "is_async": false,
          "inputs": [],
          "outputs": [
            "query_type"
          ],
          "code_lines": [
            "{{query_type}} = user_input"
          ]
        },
        {
          "id": "CTRL_25",
          "type": "IF",
          "line_number": 26,
          "is_async": false,
          "inputs": [
            "query_type"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{query_type}} == \"simple_fact\""
          ]
        },
        {
          "id": "OP_26",
          "type": "CALL",
          "line_number": 27,
          "is_async": true,
          "inputs": [],
          "outputs": [
            "vector_results"
          ],
          "code_lines": [
            "{{vector_results}} = CALL vector_retrieval()"
          ]
        },
        {
          "id": "CTRL_27",
          "type": "IF",
          "line_number": 28,
          "is_async": false,
          "inputs": [
            "vector_results",
            "similarity_threshold"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{vector_results}}.similarity > {{similarity_threshold}}"
          ]
        },
        {
          "id": "OP_28",
          "type": "ASSIGN",
          "line_number": 29,
          "is_async": false,
          "inputs": [
            "vector_results",
            "top_n_vector_results"
          ],
          "outputs": [
            "{{vector_results}}.top_n[{{top_n_vector_results}}]"
          ],
          "code_lines": [
            "RETURN {{vector_results}}.top_n[{{top_n_vector_results}}]"
          ]
        },
        {
          "id": "CTRL_29",
          "type": "ELSE",
          "line_number": 30,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ELSE"
          ]
        },
        {
          "id": "OP_30",
          "type": "CALL",
          "line_number": 31,
          "is_async": true,
          "inputs": [
            "vector_results"
          ],
          "outputs": [
            "reordered_results"
          ],
          "code_lines": [
            "{{reordered_results}} = CALL reorder_results({{vector_results}})"
          ]
        },
        {
          "id": "OP_31",
          "type": "ASSIGN",
          "line_number": 32,
          "is_async": false,
          "inputs": [
            "reordered_top_n_results",
            "reordered_results"
          ],
          "outputs": [
            "{{reordered_results}}.top_n[{{reordered_top_n_results}}]"
          ],
          "code_lines": [
            "RETURN {{reordered_results}}.top_n[{{reordered_top_n_results}}]"
          ]
        },
        {
          "id": "CTRL_32",
          "type": "ENDIF",
          "line_number": 33,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_33",
          "type": "ELIF",
          "line_number": 34,
          "is_async": false,
          "inputs": [
            "query_type"
          ],
          "outputs": [],
          "code_lines": [
            "ELIF {{query_type}} == \"complex_reasoning\""
          ]
        },
        {
          "id": "OP_34",
          "type": "CALL",
          "line_number": 35,
          "is_async": true,
          "inputs": [],
          "outputs": [
            "intent_decomposed"
          ],
          "code_lines": [
            "{{intent_decomposed}} = CALL decompose_intent(user_input)"
          ]
        },
        {
          "id": "OP_35",
          "type": "CALL",
          "line_number": 36,
          "is_async": true,
          "inputs": [
            "intent_decomposed",
            "graph_exploration_steps"
          ],
          "outputs": [
            "graph_results"
          ],
          "code_lines": [
            "{{graph_results}} = CALL graph_database_retrieval({{intent_decomposed}}, {{graph_exploration_steps}})"
          ]
        },
        {
          "id": "CTRL_36",
          "type": "IF",
          "line_number": 37,
          "is_async": false,
          "inputs": [
            "graph_results"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{graph_results}}.found"
          ]
        },
        {
          "id": "OP_37",
          "type": "ASSIGN",
          "line_number": 38,
          "is_async": false,
          "inputs": [
            "graph_results"
          ],
          "outputs": [
            "{{graph_results}}.entities_and_relationships"
          ],
          "code_lines": [
            "RETURN {{graph_results}}.entities_and_relationships"
          ]
        },
        {
          "id": "CTRL_38",
          "type": "ELSE",
          "line_number": 39,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ELSE"
          ]
        },
        {
          "id": "OP_39",
          "type": "CALL",
          "line_number": 40,
          "is_async": true,
          "inputs": [],
          "outputs": [
            "full_search_results"
          ],
          "code_lines": [
            "{{full_search_results}} = CALL full_search()"
          ]
        },
        {
          "id": "OP_40",
          "type": "ASSIGN",
          "line_number": 41,
          "is_async": false,
          "inputs": [
            "full_search_results"
          ],
          "outputs": [
            "{{full_search_results}}"
          ],
          "code_lines": [
            "RETURN {{full_search_results}}"
          ]
        },
        {
          "id": "CTRL_41",
          "type": "ENDIF",
          "line_number": 42,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_42",
          "type": "ELIF",
          "line_number": 43,
          "is_async": false,
          "inputs": [
            "query_type"
          ],
          "outputs": [],
          "code_lines": [
            "ELIF {{query_type}} == \"code_related\""
          ]
        },
        {
          "id": "OP_43",
          "type": "ASSIGN",
          "line_number": 44,
          "is_async": false,
          "inputs": [],
          "outputs": [
            "code_lines"
          ],
          "code_lines": [
            "{{code_lines}} = user_input.lines"
          ]
        },
        {
          "id": "CTRL_44",
          "type": "IF",
          "line_number": 45,
          "is_async": false,
          "inputs": [
            "max_code_lines_static_analysis",
            "code_lines"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{code_lines}} > {{max_code_lines_static_analysis}}"
          ]
        },
        {
          "id": "OP_45",
          "type": "CALL",
          "line_number": 46,
          "is_async": true,
          "inputs": [],
          "outputs": [
            "analysis_results"
          ],
          "code_lines": [
            "{{analysis_results}} = CALL static_analysis(user_input)"
          ]
        },
        {
          "id": "CTRL_46",
          "type": "ELSE",
          "line_number": 47,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ELSE"
          ]
        },
        {
          "id": "OP_47",
          "type": "CALL",
          "line_number": 48,
          "is_async": true,
          "inputs": [],
          "outputs": [
            "analysis_results"
          ],
          "code_lines": [
            "{{analysis_results}} = CALL semantic_analysis(user_input)"
          ]
        },
        {
          "id": "CTRL_48",
          "type": "ENDIF",
          "line_number": 49,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "OP_49",
          "type": "ASSIGN",
          "line_number": 50,
          "is_async": false,
          "inputs": [
            "analysis_results"
          ],
          "outputs": [
            "{{analysis_results}}"
          ],
          "code_lines": [
            "RETURN {{analysis_results}}"
          ]
        },
        {
          "id": "CTRL_50",
          "type": "ELSE",
          "line_number": 51,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ELSE"
          ]
        },
        {
          "id": "OP_51",
          "type": "ASSIGN",
          "line_number": 52,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "RETURN \"Unsupported query type\""
          ]
        },
        {
          "id": "CTRL_52",
          "type": "ENDIF",
          "line_number": 53,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_53",
          "type": "IF",
          "line_number": 54,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "IF user_feedback == \"regenerate\""
          ]
        },
        {
          "id": "OP_54",
          "type": "CALL",
          "line_number": 55,
          "is_async": true,
          "inputs": [],
          "outputs": [
            "stronger_model_results"
          ],
          "code_lines": [
            "{{stronger_model_results}} = CALL stronger_reasoning_model(user_input)"
          ]
        },
        {
          "id": "OP_55",
          "type": "ASSIGN",
          "line_number": 56,
          "is_async": false,
          "inputs": [
            "stronger_model_results"
          ],
          "outputs": [
            "{{stronger_model_results}}"
          ],
          "code_lines": [
            "RETURN {{stronger_model_results}}"
          ]
        },
        {
          "id": "CTRL_56",
          "type": "ENDIF",
          "line_number": 57,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_57",
          "type": "IF",
          "line_number": 58,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "IF user_feedback == \"unsatisfied\""
          ]
        },
        {
          "id": "OP_58",
          "type": "ASSIGN",
          "line_number": 59,
          "is_async": false,
          "inputs": [],
          "outputs": [
            "unsatisfied_count"
          ],
          "code_lines": [
            "{{unsatisfied_count}} += 1"
          ]
        },
        {
          "id": "CTRL_59",
          "type": "IF",
          "line_number": 60,
          "is_async": false,
          "inputs": [
            "unsatisfied_count"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{unsatisfied_count}} >= 3"
          ]
        },
        {
          "id": "OP_60",
          "type": "CALL",
          "line_number": 61,
          "is_async": true,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "CALL escalate_to_human_review()"
          ]
        },
        {
          "id": "CTRL_61",
          "type": "ENDIF",
          "line_number": 62,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_62",
          "type": "ENDIF",
          "line_number": 63,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "OP_63",
          "type": "ASSIGN",
          "line_number": 64,
          "is_async": false,
          "inputs": [
            "medical_documents_count"
          ],
          "outputs": [
            "medical_documents"
          ],
          "code_lines": [
            "{{medical_documents}} = {{medical_documents_count}}"
          ]
        },
        {
          "id": "OP_64",
          "type": "ASSIGN",
          "line_number": 65,
          "is_async": false,
          "inputs": [
            "technical_documents_count"
          ],
          "outputs": [
            "technical_documents"
          ],
          "code_lines": [
            "{{technical_documents}} = {{technical_documents_count}}"
          ]
        },
        {
          "id": "OP_65",
          "type": "ASSIGN",
          "line_number": 66,
          "is_async": false,
          "inputs": [
            "legal_documents_count"
          ],
          "outputs": [
            "legal_documents"
          ],
          "code_lines": [
            "{{legal_documents}} = {{legal_documents_count}}"
          ]
        },
        {
          "id": "CTRL_66",
          "type": "IF",
          "line_number": 67,
          "is_async": false,
          "inputs": [
            "current_requests",
            "max_concurrent_requests"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{current_requests}} > {{max_concurrent_requests}}"
          ]
        },
        {
          "id": "OP_67",
          "type": "CALL",
          "line_number": 68,
          "is_async": true,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "CALL queue_request()"
          ]
        },
        {
          "id": "CTRL_68",
          "type": "ENDIF",
          "line_number": 69,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "OP_69",
          "type": "CALL",
          "line_number": 70,
          "is_async": true,
          "inputs": [],
          "outputs": [
            "filtered_content"
          ],
          "code_lines": [
            "{{filtered_content}} = CALL filter_sensitive_content(user_input)"
          ]
        },
        {
          "id": "CTRL_70",
          "type": "IF",
          "line_number": 71,
          "is_async": false,
          "inputs": [
            "filtered_content"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{filtered_content}}.contains_sensitive_content"
          ]
        },
        {
          "id": "OP_71",
          "type": "CALL",
          "line_number": 72,
          "is_async": true,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "CALL log_violation(user_input)"
          ]
        },
        {
          "id": "OP_72",
          "type": "ASSIGN",
          "line_number": 73,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "RETURN \"Service denied due to sensitive content\""
          ]
        },
        {
          "id": "CTRL_73",
          "type": "ENDIF",
          "line_number": 74,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_74",
          "type": "IF",
          "line_number": 75,
          "is_async": false,
          "inputs": [
            "query_type"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{query_type}} == \"financial\""
          ]
        },
        {
          "id": "OP_75",
          "type": "CALL",
          "line_number": 76,
          "is_async": true,
          "inputs": [],
          "outputs": [
            "confirmation"
          ],
          "code_lines": [
            "{{confirmation}} = CALL confirm_user_identity(user_input)"
          ]
        },
        {
          "id": "CTRL_76",
          "type": "IF",
          "line_number": 77,
          "is_async": false,
          "inputs": [
            "confirmation"
          ],
          "outputs": [],
          "code_lines": [
            "IF NOT {{confirmation}}.confirmed"
          ]
        },
        {
          "id": "OP_77",
          "type": "ASSIGN",
          "line_number": 78,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "RETURN \"Identity confirmation required\""
          ]
        },
        {
          "id": "CTRL_78",
          "type": "ENDIF",
          "line_number": 79,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_79",
          "type": "ENDIF",
          "line_number": 80,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_80",
          "type": "IF",
          "line_number": 81,
          "is_async": false,
          "inputs": [
            "total_response_time_limit",
            "vector_retrieval_response_time"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{vector_retrieval_response_time}} > {{total_response_time_limit}}"
          ]
        },
        {
          "id": "OP_81",
          "type": "CALL",
          "line_number": 82,
          "is_async": true,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "CALL degrade_service()"
          ]
        },
        {
          "id": "CTRL_82",
          "type": "ENDIF",
          "line_number": 83,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "OP_83",
          "type": "CALL",
          "line_number": 84,
          "is_async": true,
          "inputs": [
            "error_log_retention_days",
            "access_log_retention_days",
            "debug_log_retention_days"
          ],
          "outputs": [],
          "code_lines": [
            "CALL upload_logs({{error_log_retention_days}}, {{access_log_retention_days}}, {{debug_log_retention_days}})"
          ]
        },
        {
          "id": "CTRL_84",
          "type": "IF",
          "line_number": 85,
          "is_async": false,
          "inputs": [
            "query_rate_duration_minutes",
            "query_rate"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{query_rate}} < 10 FOR {{query_rate_duration_minutes}} MINUTES"
          ]
        },
        {
          "id": "OP_85",
          "type": "CALL",
          "line_number": 86,
          "is_async": true,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "CALL trigger_alert()"
          ]
        },
        {
          "id": "CTRL_86",
          "type": "ENDIF",
          "line_number": 87,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        },
        {
          "id": "CTRL_87",
          "type": "IF",
          "line_number": 88,
          "is_async": false,
          "inputs": [
            "response_time_duration_minutes",
            "95th_percentile_response_time"
          ],
          "outputs": [],
          "code_lines": [
            "IF {{95th_percentile_response_time}} > 3 FOR {{response_time_duration_minutes}} MINUTES"
          ]
        },
        {
          "id": "OP_88",
          "type": "CALL",
          "line_number": 89,
          "is_async": true,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "CALL trigger_scaling()"
          ]
        },
        {
          "id": "CTRL_89",
          "type": "ENDIF",
          "line_number": 90,
          "is_async": false,
          "inputs": [],
          "outputs": [],
          "code_lines": [
            "ENDIF"
          ]
        }
      ]
    },
    "prompt40_step2_dependency": {
      "has_cycles": false,
      "dead_code_count": 18,
      "dead_code_blocks": [
        "OP_4",
        "OP_9",
        "OP_11",
        "OP_13",
        "OP_14",
        "OP_21",
        "OP_22",
        "OP_23",
        "OP_45",
        "OP_51",
        "OP_60",
        "OP_67",
        "OP_71",
        "OP_72",
        "OP_77",
        "OP_81",
        "OP_85",
        "OP_88"
      ],
      "topological_order": [
        "OP_0",
        "OP_1",
        "OP_2",
        "OP_3",
        "OP_4",
        "OP_5",
        "OP_6",
        "OP_7",
        "OP_8",
        "OP_9",
        "OP_10",
        "OP_11",
        "OP_12",
        "OP_13",
        "OP_14",
        "OP_15",
        "OP_16",
        "OP_17",
        "OP_18",
        "OP_19",
        "OP_20",
        "OP_21",
        "OP_22",
        "OP_23",
        "OP_24",
        "OP_26",
        "CTRL_29",
        "CTRL_32",
        "OP_34",
        "CTRL_38",
        "OP_39",
        "CTRL_41",
        "OP_43",
        "OP_45",
        "CTRL_46",
        "OP_47",
        "CTRL_48",
        "CTRL_50",
        "OP_51",
        "CTRL_52",
        "CTRL_53",
        "OP_54",
        "CTRL_56",
        "CTRL_57",
        "OP_58",
        "OP_60",
        "CTRL_61",
        "CTRL_62",
        "OP_67",
        "CTRL_68",
        "OP_69",
        "OP_71",
        "OP_72",
        "CTRL_73",
        "OP_75",
        "OP_77",
        "CTRL_78",
        "CTRL_79",
        "OP_81",
        "CTRL_82",
        "OP_85",
        "CTRL_86",
        "OP_88",
        "CTRL_89",
        "OP_63",
        "OP_64",
        "OP_65",
        "CTRL_66",
        "CTRL_80",
        "OP_83",
        "CTRL_84",
        "CTRL_87",
        "CTRL_25",
        "CTRL_33",
        "CTRL_42",
        "CTRL_74",
        "CTRL_27",
        "OP_28",
        "OP_30",
        "OP_35",
        "OP_40",
        "CTRL_44",
        "OP_49",
        "OP_55",
        "CTRL_59",
        "CTRL_70",
        "CTRL_76",
        "OP_31",
        "CTRL_36",
        "OP_37"
      ],
      "edge_count": 34,
      "node_count": 90
    },
    "prompt40_step3_clustering": {
      "strategy": "hybrid",
      "total_clusters": 13,
      "clusters": [
        {
          "cluster_id": 1,
          "block_count": 25,
          "blocks": [
            "OP_0",
            "OP_1",
            "OP_2",
            "OP_3",
            "OP_4",
            "OP_5",
            "OP_6",
            "OP_7",
            "OP_8",
            "OP_9",
            "OP_10",
            "OP_11",
            "OP_12",
            "OP_13",
            "OP_14",
            "OP_15",
            "OP_16",
            "OP_17",
            "OP_18",
            "OP_19",
            "OP_20",
            "OP_21",
            "OP_22",
            "OP_23",
            "OP_24"
          ]
        },
        {
          "cluster_id": 2,
          "block_count": 28,
          "blocks": [
            "CTRL_25",
            "OP_26",
            "CTRL_27",
            "OP_28",
            "CTRL_29",
            "OP_30",
            "OP_31",
            "CTRL_32",
            "CTRL_33",
            "OP_34",
            "OP_35",
            "CTRL_36",
            "OP_37",
            "CTRL_38",
            "OP_39",
            "OP_40",
            "CTRL_41",
            "CTRL_42",
            "OP_43",
            "CTRL_44",
            "OP_45",
            "CTRL_46",
            "OP_47",
            "CTRL_48",
            "OP_49",
            "CTRL_50",
            "OP_51",
            "CTRL_52"
          ]
        },
        {
          "cluster_id": 3,
          "block_count": 4,
          "blocks": [
            "CTRL_53",
            "OP_54",
            "OP_55",
            "CTRL_56"
          ]
        },
        {
          "cluster_id": 4,
          "block_count": 6,
          "blocks": [
            "CTRL_57",
            "OP_58",
            "CTRL_59",
            "OP_60",
            "CTRL_61",
            "CTRL_62"
          ]
        },
        {
          "cluster_id": 5,
          "block_count": 3,
          "blocks": [
            "OP_63",
            "OP_64",
            "OP_65"
          ]
        },
        {
          "cluster_id": 6,
          "block_count": 3,
          "blocks": [
            "CTRL_66",
            "OP_67",
            "CTRL_68"
          ]
        },
        {
          "cluster_id": 7,
          "block_count": 1,
          "blocks": [
            "OP_69"
          ]
        },
        {
          "cluster_id": 8,
          "block_count": 4,
          "blocks": [
            "CTRL_70",
            "OP_71",
            "OP_72",
            "CTRL_73"
          ]
        },
        {
          "cluster_id": 9,
          "block_count": 6,
          "blocks": [
            "CTRL_74",
            "OP_75",
            "CTRL_76",
            "OP_77",
            "CTRL_78",
            "CTRL_79"
          ]
        },
        {
          "cluster_id": 10,
          "block_count": 3,
          "blocks": [
            "CTRL_80",
            "OP_81",
            "CTRL_82"
          ]
        },
        {
          "cluster_id": 11,
          "block_count": 1,
          "blocks": [
            "OP_83"
          ]
        },
        {
          "cluster_id": 12,
          "block_count": 3,
          "blocks": [
            "CTRL_84",
            "OP_85",
            "CTRL_86"
          ]
        },
        {
          "cluster_id": 13,
          "block_count": 3,
          "blocks": [
            "CTRL_87",
            "OP_88",
            "CTRL_89"
          ]
        }
      ]
    },
    "prompt40_step4_generation": {
      "total_modules": 13,
      "async_modules": 11,
      "sync_modules": 2,
      "modules": [
        {
          "name": "step_1_compute_similarity_threshold",
          "inputs": [
            "_95th_percentile_response_time",
            "current_requests",
            "query_rate"
          ],
          "outputs": [
            "access_log_retention_days",
            "admin_user_priority",
            "cache_expiration_time",
            "code_analysis_response_time",
            "debug_log_retention_days",
            "error_log_retention_days",
            "graph_database_response_time",
            "graph_exploration_steps",
            "legal_documents_count",
            "max_code_lines_static_analysis",
            "max_concurrent_requests",
            "medical_documents_count",
            "query_rate_duration_minutes",
            "query_type",
            "reordered_top_n_results",
            "response_time_duration_minutes",
            "similarity_threshold",
            "technical_documents_count",
            "top_n_vector_results",
            "total_response_time_limit",
            "vector_dimension",
            "vector_retrieval_response_time"
          ],
          "is_async": false,
          "body_code": "def step_1_compute_similarity_threshold(_95th_percentile_response_time, current_requests, query_rate):\n    \"\"\"Auto-generated module\"\"\"\n    query_type = user_input\n    return access_log_retention_days, admin_user_priority, cache_expiration_time, code_analysis_response_time, debug_log_retention_days, error_log_retention_days, graph_database_response_time, graph_exploration_steps, legal_documents_count, max_code_lines_static_analysis, max_concurrent_requests, medical_documents_count, query_rate_duration_minutes, query_type, reordered_top_n_results, response_time_duration_minutes, similarity_threshold, technical_documents_count, top_n_vector_results, total_response_time_limit, vector_dimension, vector_retrieval_response_time",
          "original_block_count": 25
        },
        {
          "name": "step_2_vector_retrieval",
          "inputs": [
            "graph_exploration_steps",
            "max_code_lines_static_analysis",
            "query_type",
            "reordered_top_n_results",
            "similarity_threshold",
            "top_n_vector_results"
          ],
          "outputs": [
            "__analysis_results__",
            "__full_search_results__",
            "__graph_results___entities_and_relationships",
            "__reordered_results___top_n___reordered_top_n_results___",
            "__vector_results___top_n___top_n_vector_results___",
            "analysis_results",
            "code_lines",
            "full_search_results",
            "graph_results",
            "intent_decomposed",
            "reordered_results",
            "vector_results"
          ],
          "is_async": true,
          "body_code": "async def step_2_vector_retrieval(graph_exploration_steps, max_code_lines_static_analysis, query_type, reordered_top_n_results, similarity_threshold, top_n_vector_results):\n    \"\"\"Auto-generated module\"\"\"\n    if query_type == \"simple_fact\":\n        vector_results = await invoke_function('vector_retrieval')\n        if vector_results.similarity > similarity_threshold:\n            return vector_results.top_n[top_n_vector_results]\n        else:\n            reordered_results = await invoke_function('reorder_results', vector_results=vector_results)\n            return reordered_results.top_n[reordered_top_n_results]\n    elif query_type == \"complex_reasoning\":\n        intent_decomposed = await invoke_function('decompose_intent', user_input=user_input)\n        graph_results = await invoke_function('graph_database_retrieval', intent_decomposed=intent_decomposed, graph_exploration_steps=graph_exploration_steps)\n        if graph_results.found:\n            return graph_results.entities_and_relationships\n        else:\n            full_search_results = await invoke_function('full_search')\n            return full_search_results\n    elif query_type == \"code_related\":\n        code_lines = user_input.lines\n        if code_lines > max_code_lines_static_analysis:\n            analysis_results = await invoke_function('static_analysis', user_input=user_input)\n        else:\n            analysis_results = await invoke_function('semantic_analysis', user_input=user_input)\n        return analysis_results\n    else:\n        return \"Unsupported query type\"",
          "original_block_count": 28
        },
        {
          "name": "step_3_stronger_reasoning_model",
          "inputs": [],
          "outputs": [
            "__stronger_model_results__",
            "stronger_model_results"
          ],
          "is_async": true,
          "body_code": "async def step_3_stronger_reasoning_model():\n    \"\"\"Auto-generated module\"\"\"\n    if user_feedback == \"regenerate\":\n        stronger_model_results = await invoke_function('stronger_reasoning_model', user_input=user_input)\n        return stronger_model_results",
          "original_block_count": 4
        },
        {
          "name": "step_4_escalate_to_human_review",
          "inputs": [],
          "outputs": [
            "unsatisfied_count"
          ],
          "is_async": true,
          "body_code": "async def step_4_escalate_to_human_review():\n    \"\"\"Auto-generated module\"\"\"\n    if user_feedback == \"unsatisfied\":\n        unsatisfied_count += 1\n        if unsatisfied_count >= 3:\n            await invoke_function('escalate_to_human_review')\n    return unsatisfied_count",
          "original_block_count": 6
        },
        {
          "name": "step_5_compute_medical_documents",
          "inputs": [
            "legal_documents_count",
            "medical_documents_count",
            "technical_documents_count"
          ],
          "outputs": [
            "legal_documents",
            "medical_documents",
            "technical_documents"
          ],
          "is_async": false,
          "body_code": "def step_5_compute_medical_documents(legal_documents_count, medical_documents_count, technical_documents_count):\n    \"\"\"Auto-generated module\"\"\"\n    medical_documents = medical_documents_count\n    technical_documents = technical_documents_count\n    legal_documents = legal_documents_count\n    return legal_documents, medical_documents, technical_documents",
          "original_block_count": 3
        },
        {
          "name": "step_6_queue_request",
          "inputs": [
            "current_requests",
            "max_concurrent_requests"
          ],
          "outputs": [],
          "is_async": true,
          "body_code": "async def step_6_queue_request(current_requests, max_concurrent_requests):\n    \"\"\"Auto-generated module\"\"\"\n    if current_requests > max_concurrent_requests:\n        await invoke_function('queue_request')\n    return None",
          "original_block_count": 3
        },
        {
          "name": "step_7_filter_sensitive_content",
          "inputs": [],
          "outputs": [
            "filtered_content"
          ],
          "is_async": true,
          "body_code": "async def step_7_filter_sensitive_content():\n    \"\"\"Auto-generated module\"\"\"\n    filtered_content = await invoke_function('filter_sensitive_content', user_input=user_input)\n    return filtered_content",
          "original_block_count": 1
        },
        {
          "name": "step_8_log_violation",
          "inputs": [
            "filtered_content"
          ],
          "outputs": [],
          "is_async": true,
          "body_code": "async def step_8_log_violation(filtered_content):\n    \"\"\"Auto-generated module\"\"\"\n    if filtered_content.contains_sensitive_content:\n        await invoke_function('log_violation', user_input=user_input)\n        return \"Service denied due to sensitive content\"",
          "original_block_count": 4
        },
        {
          "name": "step_9_confirm_user_identity",
          "inputs": [
            "query_type"
          ],
          "outputs": [
            "confirmation"
          ],
          "is_async": true,
          "body_code": "async def step_9_confirm_user_identity(query_type):\n    \"\"\"Auto-generated module\"\"\"\n    if query_type == \"financial\":\n        confirmation = await invoke_function('confirm_user_identity', user_input=user_input)\n        if  not  confirmation.confirmed:\n            return \"Identity confirmation required\"",
          "original_block_count": 6
        },
        {
          "name": "step_10_degrade_service",
          "inputs": [
            "total_response_time_limit",
            "vector_retrieval_response_time"
          ],
          "outputs": [],
          "is_async": true,
          "body_code": "async def step_10_degrade_service(total_response_time_limit, vector_retrieval_response_time):\n    \"\"\"Auto-generated module\"\"\"\n    if vector_retrieval_response_time > total_response_time_limit:\n        await invoke_function('degrade_service')\n    return None",
          "original_block_count": 3
        },
        {
          "name": "step_11_upload_logs",
          "inputs": [
            "access_log_retention_days",
            "debug_log_retention_days",
            "error_log_retention_days"
          ],
          "outputs": [],
          "is_async": true,
          "body_code": "async def step_11_upload_logs(access_log_retention_days, debug_log_retention_days, error_log_retention_days):\n    \"\"\"Auto-generated module\"\"\"\n    await invoke_function('upload_logs', error_log_retention_days=error_log_retention_days, access_log_retention_days=access_log_retention_days, debug_log_retention_days=debug_log_retention_days)\n    return None",
          "original_block_count": 1
        },
        {
          "name": "step_12_trigger_alert",
          "inputs": [
            "query_rate",
            "query_rate_duration_minutes"
          ],
          "outputs": [],
          "is_async": true,
          "body_code": "async def step_12_trigger_alert(query_rate, query_rate_duration_minutes):\n    \"\"\"Auto-generated module\"\"\"\n    if query_rate < 10:\n        await invoke_function('trigger_alert')\n    return None",
          "original_block_count": 3
        },
        {
          "name": "step_13_trigger_scaling",
          "inputs": [
            "_95th_percentile_response_time",
            "response_time_duration_minutes"
          ],
          "outputs": [],
          "is_async": true,
          "body_code": "async def step_13_trigger_scaling(_95th_percentile_response_time, response_time_duration_minutes):\n    \"\"\"Auto-generated module\"\"\"\n    if _95th_percentile_response_time > 3:\n        await invoke_function('trigger_scaling')\n    return None",
          "original_block_count": 3
        }
      ]
    },
    "prompt40_step5_orchestration": {
      "main_inputs": [
        "95th_percentile_response_time",
        "current_requests",
        "query_rate"
      ],
      "input_count": 3,
      "main_code": "async def main_workflow(input_params: dict):\n    \"\"\"\n    主工作流 - 自动生成\n    \n    Args:\n        input_params: 包含 ['95th_percentile_response_time', 'current_requests', 'query_rate'] 的字典\n    \n    Returns:\n        执行结果上下文\n    \"\"\"\n    # 初始化上下文\n    ctx = input_params.copy()\n\n    # Module 1: step_1_compute_similarity_threshold\n    ctx[\"access_log_retention_days\"], ctx[\"admin_user_priority\"], ctx[\"cache_expiration_time\"], ctx[\"code_analysis_response_time\"], ctx[\"debug_log_retention_days\"], ctx[\"error_log_retention_days\"], ctx[\"graph_database_response_time\"], ctx[\"graph_exploration_steps\"], ctx[\"legal_documents_count\"], ctx[\"max_code_lines_static_analysis\"], ctx[\"max_concurrent_requests\"], ctx[\"medical_documents_count\"], ctx[\"query_rate_duration_minutes\"], ctx[\"query_type\"], ctx[\"reordered_top_n_results\"], ctx[\"response_time_duration_minutes\"], ctx[\"similarity_threshold\"], ctx[\"technical_documents_count\"], ctx[\"top_n_vector_results\"], ctx[\"total_response_time_limit\"], ctx[\"vector_dimension\"], ctx[\"vector_retrieval_response_time\"] = step_1_compute_similarity_threshold(ctx.get(\"_95th_percentile_response_time\"), ctx.get(\"current_requests\"), ctx.get(\"query_rate\"))\n\n    # Module 2: step_2_vector_retrieval\n    ctx[\"__analysis_results__\"], ctx[\"__full_search_results__\"], ctx[\"__graph_results___entities_and_relationships\"], ctx[\"__reordered_results___top_n___reordered_top_n_results___\"], ctx[\"__vector_results___top_n___top_n_vector_results___\"], ctx[\"analysis_results\"], ctx[\"code_lines\"], ctx[\"full_search_results\"], ctx[\"graph_results\"], ctx[\"intent_decomposed\"], ctx[\"reordered_results\"], ctx[\"vector_results\"] = await step_2_vector_retrieval(ctx.get(\"graph_exploration_steps\"), ctx.get(\"max_code_lines_static_analysis\"), ctx.get(\"query_type\"), ctx.get(\"reordered_top_n_results\"), ctx.get(\"similarity_threshold\"), ctx.get(\"top_n_vector_results\"))\n\n    # Module 3: step_3_stronger_reasoning_model\n    ctx[\"__stronger_model_results__\"], ctx[\"stronger_model_results\"] = await step_3_stronger_reasoning_model()\n\n    # Module 4: step_4_escalate_to_human_review\n    ctx[\"unsatisfied_count\"] = await step_4_escalate_to_human_review()\n\n    # Module 5: step_5_compute_medical_documents\n    ctx[\"legal_documents\"], ctx[\"medical_documents\"], ctx[\"technical_documents\"] = step_5_compute_medical_documents(ctx.get(\"legal_documents_count\"), ctx.get(\"medical_documents_count\"), ctx.get(\"technical_documents_count\"))\n\n    # Module 6: step_6_queue_request\n    await step_6_queue_request(ctx.get(\"current_requests\"), ctx.get(\"max_concurrent_requests\"))\n\n    # Module 7: step_7_filter_sensitive_content\n    ctx[\"filtered_content\"] = await step_7_filter_sensitive_content()\n\n    # Module 8: step_8_log_violation\n    await step_8_log_violation(ctx.get(\"filtered_content\"))\n\n    # Module 9: step_9_confirm_user_identity\n    ctx[\"confirmation\"] = await step_9_confirm_user_identity(ctx.get(\"query_type\"))\n\n    # Module 10: step_10_degrade_service\n    await step_10_degrade_service(ctx.get(\"total_response_time_limit\"), ctx.get(\"vector_retrieval_response_time\"))\n\n    # Module 11: step_11_upload_logs\n    await step_11_upload_logs(ctx.get(\"access_log_retention_days\"), ctx.get(\"debug_log_retention_days\"), ctx.get(\"error_log_retention_days\"))\n\n    # Module 12: step_12_trigger_alert\n    await step_12_trigger_alert(ctx.get(\"query_rate\"), ctx.get(\"query_rate_duration_minutes\"))\n\n    # Module 13: step_13_trigger_scaling\n    await step_13_trigger_scaling(ctx.get(\"_95th_percentile_response_time\"), ctx.get(\"response_time_duration_minutes\"))\n\n    return ctx"
    },
    "overall_status": "success",
    "total_time_ms": 35415,
    "error_message": null
  }
}